function Runtime(){}function BrowserRuntime(e){function t(t,n){var o,r,a;void 0!==n?a=t:n=t,e?(r=e.ownerDocument,a&&(o=r.createElement("span"),o.className=a,o.appendChild(r.createTextNode(a)),e.appendChild(o),e.appendChild(r.createTextNode(" "))),o=r.createElement("span"),0<n.length&&"<"===n[0]?o.innerHTML=n:o.appendChild(r.createTextNode(n)),e.appendChild(o),e.appendChild(r.createElement("br"))):console&&console.log(n),"alert"===a&&alert(n)}function n(e,t,n){function a(){var a;4===i.readyState&&(0!==i.status||i.responseText?200===i.status||0===i.status?(a="binary"===t?null!==i.responseBody&&"undefined"!==String(typeof VBArray)?new VBArray(i.responseBody).toArray():o.byteArrayFromString(i.responseText,"binary"):i.responseText,r[e]=a,n(null,a)):n(i.responseText||i.statusText):n("File "+e+" is empty."))}if(r.hasOwnProperty(e))n(null,r[e]);else{var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=a,i.overrideMimeType&&i.overrideMimeType("binary"!==t?"text/plain; charset="+t:"text/plain; charset=x-user-defined");try{i.send(null)}catch(s){n(s.message)}}}var o=this,r={},a=window.ArrayBuffer&&window.Uint8Array;a&&(Uint8Array.prototype.slice=function(e,t){void 0===t&&(void 0===e&&(e=0),t=this.length);var n,o,r=this.subarray(e,t);for(t-=e,n=new Uint8Array(new ArrayBuffer(t)),o=0;t>o;o+=1)n[o]=r[o];return n}),this.ByteArray=a?function(e){return new Uint8Array(new ArrayBuffer(e))}:function(e){var t=[];return t.length=e,t},this.concatByteArrays=a?function(e,t){var n,o=e.length,r=t.length,a=new this.ByteArray(o+r);for(n=0;o>n;n+=1)a[n]=e[n];for(n=0;r>n;n+=1)a[n+o]=t[n];return a}:function(e,t){return e.concat(t)},this.byteArrayFromArray=function(e){return e.slice()},this.byteArrayFromString=function(e,t){var n;if("utf8"===t){n=e.length;var r,a,i,s=0;for(a=0;n>a;a+=1)i=e.charCodeAt(a),s+=1+(i>128)+(i>2048);for(r=new o.ByteArray(s),a=s=0;n>a;a+=1)i=e.charCodeAt(a),128>i?(r[s]=i,s+=1):2048>i?(r[s]=192|i>>>6,r[s+1]=128|63&i,s+=2):(r[s]=224|i>>>12&15,r[s+1]=128|i>>>6&63,r[s+2]=128|63&i,s+=3)}else for("binary"!==t&&o.log("unknown encoding: "+t),n=e.length,r=new o.ByteArray(n),a=0;n>a;a+=1)r[a]=255&e.charCodeAt(a);return n=r},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=n,this.read=function(e,t,n,a){function i(){var i;4===s.readyState&&(0!==s.status||s.responseText?200===s.status||0===s.status?(s.response?(i=s.response,i=new Uint8Array(i)):i=null!==s.responseBody&&"undefined"!==String(typeof VBArray)?new VBArray(s.responseBody).toArray():o.byteArrayFromString(s.responseText,"binary"),r[e]=i,a(null,i.slice(t,t+n))):a(s.responseText||s.statusText):a("File "+e+" is empty."))}if(r.hasOwnProperty(e))a(null,r[e].slice(t,t+n));else{var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=i,s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.responseType="arraybuffer";try{s.send(null)}catch(l){a(l.message)}}},this.readFileSync=function(e,t){var n,o=new XMLHttpRequest;o.open("GET",e,!1),o.overrideMimeType&&o.overrideMimeType("binary"!==t?"text/plain; charset="+t:"text/plain; charset=x-user-defined");try{o.send(null),(200===o.status||0===o.status)&&(n=o.responseText)}catch(r){}return n},this.writeFile=function(e,t,n){r[e]=t;var a=new XMLHttpRequest;a.open("PUT",e,!0),a.onreadystatechange=function(){4===a.readyState&&n(0!==a.status||a.responseText?200<=a.status&&300>a.status||0===a.status?null:"Status "+String(a.status)+": "+a.responseText||a.statusText:"File "+e+" is empty.")},t=t.buffer&&!a.sendAsBinary?t.buffer:o.byteArrayToString(t,"binary");try{a.sendAsBinary?a.sendAsBinary(t):a.send(t)}catch(i){o.log("HUH? "+i+" "+t),n(i.message)}},this.deleteFile=function(e,t){delete r[e];var n=new XMLHttpRequest;n.open("DELETE",e,!0),n.onreadystatechange=function(){4===n.readyState&&t(200>n.status&&300<=n.status?n.responseText:null)},n.send(null)},this.loadXML=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.overrideMimeType&&n.overrideMimeType("text/xml"),n.onreadystatechange=function(){4===n.readyState&&(0!==n.status||n.responseText?200===n.status||0===n.status?t(null,n.responseXML):t(n.responseText):t("File "+e+" is empty."))};try{n.send(null)}catch(o){t(o.message)}},this.isFile=function(e,t){o.getFileSize(e,function(e){t(-1!==e)})},this.getFileSize=function(e,t){var o=new XMLHttpRequest;o.open("HEAD",e,!0),o.onreadystatechange=function(){if(4===o.readyState){var r=o.getResponseHeader("Content-Length");r?t(parseInt(r,10)):n(e,"binary",function(e,n){t(e?-1:n.length)})}},o.send(null)},this.log=t,this.assert=function(e,n,o){if(!e)throw t("alert","ASSERTION FAILED:\n"+n),o&&o(),n},this.setTimeout=function(e,t){return setTimeout(function(){e()},t)},this.clearTimeout=function(e){clearTimeout(e)},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(){},this.type=function(){return"BrowserRuntime"},this.getDOMImplementation=function(){return window.document.implementation},this.parseXML=function(e){return(new DOMParser).parseFromString(e,"text/xml")},this.exit=function(e){t("Calling exit with code "+String(e)+", but exit() is not implemented.")},this.getWindow=function(){return window}}function NodeJSRuntime(){function e(e,t,n){e=a.resolve(i,e),"binary"!==t?r.readFile(e,t,n):r.readFile(e,null,n)}var t,n,o=this,r=require("fs"),a=require("path"),i="";this.ByteArray=function(e){return new Buffer(e)},this.byteArrayFromArray=function(e){var t,n=new Buffer(e.length),o=e.length;for(t=0;o>t;t+=1)n[t]=e[t];return n},this.concatByteArrays=function(e,t){var n=new Buffer(e.length+t.length);return e.copy(n,0,0),t.copy(n,e.length,0),n},this.byteArrayFromString=function(e,t){return new Buffer(e,t)},this.byteArrayToString=function(e,t){return e.toString(t)},this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.readFile=e,this.loadXML=function(t,n){e(t,"utf-8",function(e,t){return e?n(e):void n(null,o.parseXML(t))})},this.writeFile=function(e,t,n){e=a.resolve(i,e),r.writeFile(e,t,"binary",function(e){n(e||null)})},this.deleteFile=function(e,t){e=a.resolve(i,e),r.unlink(e,t)},this.read=function(e,t,n,o){e=a.resolve(i,e),r.open(e,"r+",666,function(e,a){if(e)o(e);else{var i=new Buffer(n);r.read(a,i,0,n,t,function(e){r.close(a),o(e,i)})}})},this.readFileSync=function(e,t){return t?"binary"===t?r.readFileSync(e,null):r.readFileSync(e,t):""},this.isFile=function(e,t){e=a.resolve(i,e),r.stat(e,function(e,n){t(!e&&n.isFile())})},this.getFileSize=function(e,t){e=a.resolve(i,e),r.stat(e,function(e,n){t(e?-1:n.size)})},this.log=function(e,t){var n;void 0!==t?n=e:t=e,"alert"===n&&process.stderr.write("\n!!!!! ALERT !!!!!\n"),process.stderr.write(t+"\n"),"alert"===n&&process.stderr.write("!!!!! ALERT !!!!!\n")},this.assert=function(e,t,n){e||(process.stderr.write("ASSERTION FAILED: "+t),n&&n())},this.setTimeout=function(e,t){return setTimeout(function(){e()},t)},this.clearTimeout=function(e){clearTimeout(e)},this.libraryPaths=function(){return[__dirname]},this.setCurrentDirectory=function(e){i=e},this.currentDirectory=function(){return i},this.type=function(){return"NodeJSRuntime"},this.getDOMImplementation=function(){return n},this.parseXML=function(e){return t.parseFromString(e,"text/xml")},this.exit=process.exit,this.getWindow=function(){return null},t=new(require("xmldom").DOMParser),n=o.parseXML("<a/>").implementation}function RhinoRuntime(){function e(e,t){var n;void 0!==t?n=e:t=e,"alert"===n&&print("\n!!!!! ALERT !!!!!"),print(t),"alert"===n&&print("!!!!! ALERT !!!!!")}var t,n,o=this,r=Packages.javax.xml.parsers.DocumentBuilderFactory.newInstance(),a="";r.setValidating(!1),r.setNamespaceAware(!0),r.setExpandEntityReferences(!1),r.setSchema(null),n=Packages.org.xml.sax.EntityResolver({resolveEntity:function(e,t){var n=new Packages.java.io.FileReader(t);return new Packages.org.xml.sax.InputSource(n)}}),t=r.newDocumentBuilder(),t.setEntityResolver(n),this.ByteArray=function(e){return[e]},this.byteArrayFromArray=function(e){return e},this.byteArrayFromString=function(e,t){var n,o=[],r=e.length;for(n=0;r>n;n+=1)o[n]=255&e.charCodeAt(n);return o},this.byteArrayToString=Runtime.byteArrayToString,this.getVariable=Runtime.getVariable,this.fromJson=Runtime.fromJson,this.toJson=Runtime.toJson,this.concatByteArrays=function(e,t){return e.concat(t)},this.loadXML=function(e,n){var o,r=new Packages.java.io.File(e);try{o=t.parse(r)}catch(a){return print(a),void n(a)}n(null,o)},this.readFile=function(e,t,n){a&&(e=a+"/"+e);var r=new Packages.java.io.File(e),i="binary"===t?"latin1":t;r.isFile()?(e=readFile(e,i),"binary"===t&&(e=o.byteArrayFromString(e,"binary")),n(null,e)):n(e+" is not a file.")},this.writeFile=function(e,t,n){a&&(e=a+"/"+e),e=new Packages.java.io.FileOutputStream(e);var o,r=t.length;for(o=0;r>o;o+=1)e.write(t[o]);e.close(),n(null)},this.deleteFile=function(e,t){a&&(e=a+"/"+e),t(new Packages.java.io.File(e)["delete"]()?null:"Could not delete "+e)},this.read=function(e,t,n,o){a&&(e=a+"/"+e);var r;r=e;var i="binary";new Packages.java.io.File(r).isFile()?("binary"===i&&(i="latin1"),r=readFile(r,i)):r=null,r?o(null,this.byteArrayFromString(r.substring(t,t+n),"binary")):o("Cannot read "+e)},this.readFileSync=function(e,t){return t?readFile(e,t):""},this.isFile=function(e,t){a&&(e=a+"/"+e);var n=new Packages.java.io.File(e);t(n.isFile())},this.getFileSize=function(e,t){a&&(e=a+"/"+e);var n=new Packages.java.io.File(e);t(n.length())},this.log=e,this.assert=function(t,n,o){t||(e("alert","ASSERTION FAILED: "+n),o&&o())},this.setTimeout=function(e){return e(),0},this.clearTimeout=function(){},this.libraryPaths=function(){return["lib"]},this.setCurrentDirectory=function(e){a=e},this.currentDirectory=function(){return a},this.type=function(){return"RhinoRuntime"},this.getDOMImplementation=function(){return t.getDOMImplementation()},this.parseXML=function(e){return t.parse(e)},this.exit=quit,this.getWindow=function(){return null}}var core={},gui={},xmldom={},odf={},ops={};Runtime.ByteArray=function(e){},Runtime.prototype.getVariable=function(e){},Runtime.prototype.toJson=function(e){},Runtime.prototype.fromJson=function(e){},Runtime.ByteArray.prototype.slice=function(e,t){},Runtime.ByteArray.prototype.length=0,Runtime.prototype.byteArrayFromArray=function(e){},Runtime.prototype.byteArrayFromString=function(e,t){},Runtime.prototype.byteArrayToString=function(e,t){},Runtime.prototype.concatByteArrays=function(e,t){},Runtime.prototype.read=function(e,t,n,o){},Runtime.prototype.readFile=function(e,t,n){},Runtime.prototype.readFileSync=function(e,t){},Runtime.prototype.loadXML=function(e,t){},Runtime.prototype.writeFile=function(e,t,n){},Runtime.prototype.isFile=function(e,t){},Runtime.prototype.getFileSize=function(e,t){},Runtime.prototype.deleteFile=function(e,t){},Runtime.prototype.log=function(e,t){},Runtime.prototype.setTimeout=function(e,t){},Runtime.prototype.clearTimeout=function(e){},Runtime.prototype.libraryPaths=function(){},Runtime.prototype.type=function(){},Runtime.prototype.getDOMImplementation=function(){},Runtime.prototype.parseXML=function(e){},Runtime.prototype.getWindow=function(){},Runtime.prototype.assert=function(e,t,n){};var IS_COMPILED_CODE=!0;Runtime.byteArrayToString=function(e,t){function n(e){var t,n="",o=e.length;for(t=0;o>t;t+=1)n+=String.fromCharCode(255&e[t]);return n}function o(e){var t,n,o,r,a,i="",s=e.length;for(t=0;s>t;t+=1)n=e[t],128>n?i+=String.fromCharCode(n):(t+=1,o=e[t],n>=194&&224>n?i+=String.fromCharCode((31&n)<<6|63&o):(t+=1,r=e[t],n>=224&&240>n?i+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&r):(t+=1,a=e[t],n>=240&&245>n&&(n=(7&n)<<18|(63&o)<<12|(63&r)<<6|63&a,n-=65536,i+=String.fromCharCode((n>>10)+55296,(1023&n)+56320)))));return i}var r;return"utf8"===t?r=o(e):("binary"!==t&&this.log("Unsupported encoding: "+t),r=n(e)),r},Runtime.getVariable=function(f){try{return eval(f)}catch(h){}},Runtime.toJson=function(e){return JSON.stringify(e)},Runtime.fromJson=function(e){return JSON.parse(e)},Runtime.getFunctionName=function(e){return void 0===e.name?(e=/function\s+(\w+)/.exec(e))&&e[1]:e.name};var runtime=function(){return"undefined"!==String(typeof window)?new BrowserRuntime(window.document.getElementById("logoutput")):"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime}();!function(){function f(c){var b=c[0],f;for(f=eval("if (typeof "+b+" === 'undefined') {eval('"+b+" = {};');}"+b),b=1;b<c.length-1;b+=1)f=f.hasOwnProperty(c[b])?f[c[b]]:f[c[b]]={};return f[c[c.length-1]]}var h={},c={};runtime.loadClass=function(g){function b(a){a=a.replace(/\./g,"/")+".js";var d=runtime.libraryPaths(),b,l,r;for(runtime.currentDirectory&&d.push(runtime.currentDirectory()),b=0;b<d.length;b+=1){if(l=d[b],!c.hasOwnProperty(l))try{r=runtime.readFileSync(d[b]+"/manifest.js","utf8"),c[l]=r&&r.length?eval(r):null}catch(k){c[l]=null,runtime.log("Cannot load manifest for "+l+".")}if(r=null,(l=c[l])&&l.indexOf&&-1!==l.indexOf(a))return d[b]+"/"+a}return null}function p(a){var d,c;if(c=b(a),!c)throw a+" is not listed in any manifest.js.";try{d=runtime.readFileSync(c,"utf8")}catch(l){throw runtime.log("Error loading "+a+" "+l),l}if(void 0===d)throw"Cannot load class "+a;d=d+("\n//# sourceURL="+c)+("\n//@ sourceURL="+c);try{d=eval(a+" = eval(code);")}catch(r){throw runtime.log("Error loading "+a+" "+r),r}return d}if(!IS_COMPILED_CODE&&!h.hasOwnProperty(g)){var a=g.split("."),n;if(n=f(a),!n&&(n=p(g),!n||Runtime.getFunctionName(n)!==a[a.length-1]))throw runtime.log("Loaded code is not for "+a[a.length-1]),"Loaded code is not for "+a[a.length-1];h[g]=!0}}}(),function(f){function h(c){if(c.length){var g=c[0];runtime.readFile(g,"utf8",function(b,f){function a(){var d;(d=eval(e))&&runtime.exit(d)}var h="",e=f;-1!==g.indexOf("/")&&(h=g.substring(0,g.indexOf("/"))),runtime.setCurrentDirectory(h),b||null===e?(runtime.log(b),runtime.exit(1)):a.apply(null,c)})}}f=f?Array.prototype.slice.call(f):[],h("NodeJSRuntime"===runtime.type()?process.argv.slice(2):"RhinoRuntime"===runtime.type()?f:f.slice(1))}("undefined"!==String(typeof arguments)&&arguments),core.Base64=function(){function e(e){var t,n=[],o=e.length;for(t=0;o>t;t+=1)n[t]=255&e.charCodeAt(t);return n}function t(e){var t,n,o="",r=e.length-2;for(n=0;r>n;n+=3)t=e[n]<<16|e[n+1]<<8|e[n+2],o+=b[t>>>18],o+=b[t>>>12&63],o+=b[t>>>6&63],o+=b[63&t];return n===r+1?(t=e[n]<<4,o+=b[t>>>6],o+=b[63&t],o+="=="):n===r&&(t=e[n]<<10|e[n+1]<<2,o+=b[t>>>12],o+=b[t>>>6&63],o+=b[63&t],o+="="),o}function n(e){e=e.replace(/[^A-Za-z0-9+\/]+/g,"");var t,n,o=[],r=e.length%4,a=e.length;for(t=0;a>t;t+=4)n=(x[e.charAt(t)]||0)<<18|(x[e.charAt(t+1)]||0)<<12|(x[e.charAt(t+2)]||0)<<6|(x[e.charAt(t+3)]||0),o.push(n>>16,n>>8&255,255&n);return o.length-=[0,0,2,1][r],o}function o(e){var t,n,o=[],r=e.length;for(t=0;r>t;t+=1)n=e[t],128>n?o.push(n):2048>n?o.push(192|n>>>6,128|63&n):o.push(224|n>>>12&15,128|n>>>6&63,128|63&n);return o}function r(e){var t,n,o,r,a=[],i=e.length;for(t=0;i>t;t+=1)n=e[t],128>n?a.push(n):(t+=1,o=e[t],224>n?a.push((31&n)<<6|63&o):(t+=1,r=e[t],a.push((15&n)<<12|(63&o)<<6|63&r)));return a}function a(n){return t(e(n))}function i(e){return String.fromCharCode.apply(String,n(e))}function s(t){return r(e(t))}function l(e){e=r(e);for(var t="",n=0;n<e.length;)t+=String.fromCharCode.apply(String,e.slice(n,n+45e3)),n+=45e3;return t}function u(e,t,n){var o,r,a,i="";for(a=t;n>a;a+=1)t=255&e.charCodeAt(a),128>t?i+=String.fromCharCode(t):(a+=1,o=255&e.charCodeAt(a),224>t?i+=String.fromCharCode((31&t)<<6|63&o):(a+=1,r=255&e.charCodeAt(a),i+=String.fromCharCode((15&t)<<12|(63&o)<<6|63&r)));return i}function c(e,t){function n(){var i=a+o;i>e.length&&(i=e.length),r+=u(e,a,i),a=i,i=a===e.length,t(r,i)&&!i&&runtime.setTimeout(n,0)}var o=1e5,r="",a=0;e.length<o?t(u(e,0,e.length),!0):("string"!=typeof e&&(e=e.slice()),n())}function d(t){return o(e(t))}function m(e){return String.fromCharCode.apply(String,o(e))}function f(t){return String.fromCharCode.apply(String,o(e(t)))}var p,g,h,y,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=function(e){var t,n,o={};for(t=0,n=e.length;n>t;t+=1)o[e.charAt(t)]=t;return o}(b),v=runtime.getWindow();return v&&v.btoa?(h=function(e){return v.btoa(e)},p=function(e){return h(f(e))}):(h=a,p=function(e){return t(d(e))}),v&&v.atob?(y=function(e){return v.atob(e)},g=function(e){return e=y(e),u(e,0,e.length)}):(y=i,g=function(e){return l(n(e))}),function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=t,this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=n,this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=o,this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=r,this.convertUTF8StringToBase64=a,this.convertBase64ToUTF8String=i,this.convertUTF8StringToUTF16Array=s,this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=l,this.convertUTF8StringToUTF16String=c,this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=d,this.convertUTF16ArrayToUTF8String=m,this.convertUTF16StringToUTF8String=f,this.convertUTF16StringToBase64=p,this.convertBase64ToUTF16String=g,this.fromBase64=i,this.toBase64=a,this.atob=y,this.btoa=h,this.utob=f,this.btou=c,this.encode=p,this.encodeURI=function(e){return p(e).replace(/[+\/]/g,function(e){return"+"===e?"-":"_"}).replace(/\\=+$/,"")},this.decode=function(e){return g(e.replace(/[\-_]/g,function(e){return"-"===e?"+":"/"}))}}}(),core.RawDeflate=function(){function e(){this.dl=this.fc=0}function t(){this.extra_bits=this.static_tree=this.dyn_tree=null,this.max_code=this.max_length=this.elems=this.extra_base=0}function n(e,t,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=o}function o(){this.next=null,this.len=0,this.ptr=[],this.ptr.length=ie,this.off=0}var r,a,i,s,l,u,c,d,m,f,p,g,h,y,b,x,v,N,C,S,w,E,T,O,D,A,R,P,I,F,k,U,M,B,L,_,X,W,H,z,V,j,q,J,G,K,Z,$,Y,Q,ee,te,ne,oe,re,ae,ie=8192,se=null,le=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ue=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],de=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];ae=[new n(0,0,0,0),new n(4,4,8,4),new n(4,5,16,8),new n(4,6,32,32),new n(4,4,16,16),new n(8,16,32,32),new n(8,16,128,128),new n(8,32,128,256),new n(32,128,258,1024),new n(32,258,258,4096)];var me=function(e){if(se[u+l++]=e,u+l===ie){var t;if(0!==l){for(null!==r?(e=r,r=r.next):e=new o,e.next=null,e.len=e.off=0,null===a?a=i=e:i=i.next=e,e.len=l-u,t=0;t<e.len;t++)e.ptr[t]=se[u+t];l=u=0}}},fe=function(e){e&=65535,ie-2>u+l?(se[u+l++]=255&e,se[u+l++]=e>>>8):(me(255&e),me(e>>>8))},pe=function(){b=8191&(b<<5^255&d[w+3-1]),x=p[32768+b],p[32767&w]=x,p[32768+b]=w},ge=function(e,t){h>16-t?(g|=e<<h,fe(g),g=e>>16-h,h+=t-16):(g|=e<<h,h+=t)},he=function(e,t){ge(t[e].fc,t[e].dl)},ye=function(e,t,n){return e[t].fc<e[n].fc||e[t].fc===e[n].fc&&V[t]<=V[n]},be=function(e,t,n){var o;for(o=0;n>o&&re<oe.length;o++)e[t+o]=255&oe.charCodeAt(re++);return o},xe=function(){var e,t,n=65536-O-w;if(-1===n)n--;else if(w>=65274){for(e=0;32768>e;e++)d[e]=d[e+32768];for(E-=32768,w-=32768,y-=32768,e=0;8192>e;e++)t=p[32768+e],p[32768+e]=t>=32768?t-32768:0;for(e=0;32768>e;e++)t=p[e],p[e]=t>=32768?t-32768:0;n+=32768}T||(e=be(d,w+O,n),0>=e?T=!0:O+=e)},ve=function(e){var t,n=D,o=w,r=S,a=w>32506?w-32506:0,i=w+258,s=d[o+r-1],l=d[o+r];S>=P&&(n>>=2);do if(t=e,d[t+r]===l&&d[t+r-1]===s&&d[t]===d[o]&&d[++t]===d[o+1]){o+=2,t++;do++o;while(d[o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&d[++o]===d[++t]&&i>o);if(t=258-(i-o),o=i-258,t>r){if(E=e,r=t,t>=258)break;s=d[o+r-1],l=d[o+r]}e=p[32767&e]}while(e>a&&0!==--n);return r},Ne=function(e,t){if(f[Z++]=t,0===e?I[t].fc++:(e--,I[j[t]+256+1].fc++,F[255&(256>e?q[e]:q[256+(e>>7)])].fc++,m[$++]=e,Q|=ee),ee<<=1,0===(7&Z)&&(K[Y++]=Q,Q=0,ee=1),R>2&&0===(4095&Z)){var n,o=8*Z,r=w-y;for(n=0;30>n;n++)o+=F[n].fc*(5+ue[n]);if(o>>=3,$<parseInt(Z/2,10)&&o<parseInt(r/2,10))return!0}return 8191===Z||8192===$},Ce=function(e,t){for(var n=W[t],o=t<<1;H>=o&&(H>o&&ye(e,W[o+1],W[o])&&o++,!ye(e,n,W[o]));)W[t]=W[o],t=o,o<<=1;W[t]=n},Se=function(e,t){var n=0;do n|=1&e,e>>=1,n<<=1;while(0<--t);return n>>1},we=function(e,t){var n=[];n.length=16;var o,r=0;for(o=1;15>=o;o++)r=r+X[o-1]<<1,n[o]=r;for(r=0;t>=r;r++)o=e[r].dl,0!==o&&(e[r].fc=Se(n[o]++,o))},Ee=function(e){var t,n=e.dyn_tree,o=e.static_tree,r=e.elems,a=-1,i=r;for(H=0,z=573,t=0;r>t;t++)0!==n[t].fc?(W[++H]=a=t,V[t]=0):n[t].dl=0;for(;2>H;)t=W[++H]=2>a?++a:0,n[t].fc=1,V[t]=0,te--,null!==o&&(ne-=o[t].dl);for(e.max_code=a,t=H>>1;t>=1;t--)Ce(n,t);do t=W[1],W[1]=W[H--],Ce(n,1),o=W[1],W[--z]=t,W[--z]=o,n[i].fc=n[t].fc+n[o].fc,V[i]=V[t]>V[o]+1?V[t]:V[o]+1,n[t].dl=n[o].dl=i,W[1]=i++,Ce(n,1);while(H>=2);W[--z]=W[1],i=e.dyn_tree,t=e.extra_bits;var s,l,u,c,r=e.extra_base,o=e.max_code,d=e.max_length,m=e.static_tree,f=0;for(l=0;15>=l;l++)X[l]=0;for(i[W[z]].dl=0,e=z+1;573>e;e++)s=W[e],l=i[i[s].dl].dl+1,l>d&&(l=d,f++),i[s].dl=l,s>o||(X[l]++,u=0,s>=r&&(u=t[s-r]),c=i[s].fc,te+=c*(l+u),null!==m&&(ne+=c*(m[s].dl+u)));if(0!==f){do{for(l=d-1;0===X[l];)l--;X[l]--,X[l+1]+=2,X[d]--,f-=2}while(f>0);for(l=d;0!==l;l--)for(s=X[l];0!==s;)t=W[--e],t>o||(i[t].dl!==l&&(te+=(l-i[t].dl)*i[t].fc,i[t].fc=l),s--)}we(n,a)},Te=function(e,t){var n,o,r=-1,a=e[0].dl,i=0,s=7,l=4;for(0===a&&(s=138,l=3),e[t+1].dl=65535,n=0;t>=n;n++)o=a,a=e[n+1].dl,++i<s&&o===a||(l>i?M[o].fc+=i:0!==o?(o!==r&&M[o].fc++,M[16].fc++):10>=i?M[17].fc++:M[18].fc++,i=0,r=o,0===a?(s=138,l=3):o===a?(s=6,l=3):(s=7,l=4))},Oe=function(){h>8?fe(g):h>0&&me(g),h=g=0},De=function(e,t){var n,o,r,a=0,i=0,s=0,l=0;if(0!==Z)do 0===(7&a)&&(l=K[s++]),n=255&f[a++],0===(1&l)?he(n,e):(o=j[n],he(o+256+1,e),r=le[o],0!==r&&(n-=J[o],ge(n,r)),n=m[i++],o=255&(256>n?q[n]:q[256+(n>>7)]),he(o,t),r=ue[o],0!==r&&(n-=G[o],ge(n,r))),l>>=1;while(Z>a);he(256,e)},Ae=function(e,t){var n,o,r=-1,a=e[0].dl,i=0,s=7,l=4;for(0===a&&(s=138,l=3),n=0;t>=n;n++)if(o=a,a=e[n+1].dl,!(++i<s&&o===a)){if(l>i){do he(o,M);while(0!==--i)}else 0!==o?(o!==r&&(he(o,M),i--),he(16,M),ge(i-3,2)):10>=i?(he(17,M),ge(i-3,3)):(he(18,M),ge(i-11,7));i=0,r=o,0===a?(s=138,l=3):o===a?(s=6,l=3):(s=7,l=4)}},Re=function(){var e;for(e=0;286>e;e++)I[e].fc=0;for(e=0;30>e;e++)F[e].fc=0;for(e=0;19>e;e++)M[e].fc=0;I[256].fc=1,Q=Z=$=Y=te=ne=0,ee=1},Pe=function(e){var t,n,o,r;for(r=w-y,K[Y]=Q,Ee(B),Ee(L),Te(I,B.max_code),Te(F,L.max_code),Ee(_),o=18;o>=3&&0===M[de[o]].dl;o--);if(te+=3*(o+1)+14,t=te+3+7>>3,n=ne+3+7>>3,t>=n&&(t=n),t>=r+4&&y>=0)for(ge(0+e,3),Oe(),fe(r),fe(~r),o=0;r>o;o++)me(d[y+o]);else if(n===t)ge(2+e,3),De(k,U);else{for(ge(4+e,3),r=B.max_code+1,t=L.max_code+1,o+=1,ge(r-257,5),ge(t-1,5),ge(o-4,4),n=0;o>n;n++)ge(M[de[n]].dl,3);Ae(I,r-1),Ae(F,t-1),De(I,F)}Re(),0!==e&&Oe()},Ie=function(e,t,n){var o,i,s;for(o=0;null!==a&&n>o;){for(i=n-o,i>a.len&&(i=a.len),s=0;i>s;s++)e[t+o+s]=a.ptr[a.off+s];a.off+=i,a.len-=i,o+=i,0===a.len&&(i=a,a=a.next,i.next=r,r=i)}if(o===n)return o;if(l>u){for(i=n-o,i>l-u&&(i=l-u),s=0;i>s;s++)e[t+o+s]=se[u+s];u+=i,o+=i,l===u&&(l=u=0)}return o},Fe=function(e,t,n){var o;if(!s){if(!T){h=g=0;var r,i;if(0===U[0].dl){for(B.dyn_tree=I,B.static_tree=k,B.extra_bits=le,B.extra_base=257,B.elems=286,B.max_length=15,B.max_code=0,L.dyn_tree=F,L.static_tree=U,L.extra_bits=ue,L.extra_base=0,L.elems=30,L.max_length=15,L.max_code=0,_.dyn_tree=M,_.static_tree=null,_.extra_bits=ce,_.extra_base=0,_.elems=19,_.max_length=7,i=r=_.max_code=0;28>i;i++)for(J[i]=r,o=0;o<1<<le[i];o++)j[r++]=i;for(j[r-1]=i,i=r=0;16>i;i++)for(G[i]=r,o=0;o<1<<ue[i];o++)q[r++]=i;for(r>>=7;30>i;i++)for(G[i]=r<<7,o=0;o<1<<ue[i]-7;o++)q[256+r++]=i;for(o=0;15>=o;o++)X[o]=0;for(o=0;143>=o;)k[o++].dl=8,X[8]++;for(;255>=o;)k[o++].dl=9,X[9]++;for(;279>=o;)k[o++].dl=7,X[7]++;for(;287>=o;)k[o++].dl=8,X[8]++;for(we(k,287),o=0;30>o;o++)U[o].dl=5,U[o].fc=Se(o,5);Re()}for(o=0;8192>o;o++)p[32768+o]=0;if(A=ae[R].max_lazy,P=ae[R].good_length,D=ae[R].max_chain,y=w=0,O=be(d,0,65536),0>=O)T=!0,O=0;else{for(T=!1;262>O&&!T;)xe();for(o=b=0;2>o;o++)b=8191&(b<<5^255&d[o])}a=null,u=l=0,3>=R?(S=2,C=0):(C=2,N=0),c=!1}if(s=!0,0===O)return c=!0,0}if(o=Ie(e,t,n),o===n)return n;if(c)return o;if(3>=R)for(;0!==O&&null===a;){if(pe(),0!==x&&32506>=w-x&&(C=ve(x),C>O&&(C=O)),C>=3)if(i=Ne(w-E,C-3),O-=C,A>=C){C--;do w++,pe();while(0!==--C);w++}else w+=C,C=0,b=255&d[w],b=8191&(b<<5^255&d[w+1]);else i=Ne(0,255&d[w]),O--,w++;for(i&&(Pe(0),y=w);262>O&&!T;)xe()}else for(;0!==O&&null===a;){if(pe(),S=C,v=E,C=2,0!==x&&A>S&&32506>=w-x&&(C=ve(x),C>O&&(C=O),3===C&&w-E>4096&&C--),S>=3&&S>=C){i=Ne(w-1-v,S-3),O-=S-1,S-=2;do w++,pe();while(0!==--S);N=0,C=2,w++,i&&(Pe(0),y=w)}else 0!==N?Ne(0,255&d[w-1])&&(Pe(0),y=w):N=1,w++,O--;for(;262>O&&!T;)xe()}return 0===O&&(0!==N&&Ne(0,255&d[w-1]),Pe(1),c=!0),o+Ie(e,o+t,n-o)};this.deflate=function(n,o){var l,u;if(oe=n,re=0,"undefined"===String(typeof o)&&(o=6),(l=o)?1>l?l=1:l>9&&(l=9):l=6,R=l,T=s=!1,null===se){for(r=a=i=null,se=[],se.length=ie,d=[],d.length=65536,m=[],m.length=8192,f=[],f.length=32832,p=[],p.length=65536,I=[],I.length=573,l=0;573>l;l++)I[l]=new e;for(F=[],F.length=61,l=0;61>l;l++)F[l]=new e;for(k=[],k.length=288,l=0;288>l;l++)k[l]=new e;for(U=[],U.length=30,l=0;30>l;l++)U[l]=new e;for(M=[],M.length=39,l=0;39>l;l++)M[l]=new e;B=new t,L=new t,_=new t,X=[],X.length=16,W=[],W.length=573,V=[],V.length=573,j=[],j.length=256,q=[],q.length=512,J=[],J.length=29,G=[],G.length=30,K=[],K.length=1024}var c=Array(1024),g=[],h=[];for(l=Fe(c,0,c.length);l>0;){for(h.length=l,u=0;l>u;u++)h[u]=String.fromCharCode(c[u]);g[g.length]=h.join(""),l=Fe(c,0,c.length)}return oe=null,g.join("")}},core.ByteArray=function(e){this.pos=0,this.data=e,this.readUInt32LE=function(){this.pos+=4;var e=this.data,t=this.pos;return e[--t]<<24|e[--t]<<16|e[--t]<<8|e[--t]},this.readUInt16LE=function(){this.pos+=2;var e=this.data,t=this.pos;return e[--t]<<8|e[--t]}},core.ByteArrayWriter=function(e){var t=this,n=new runtime.ByteArray(0);this.appendByteArrayWriter=function(e){n=runtime.concatByteArrays(n,e.getByteArray())},this.appendByteArray=function(e){n=runtime.concatByteArrays(n,e)},this.appendArray=function(e){n=runtime.concatByteArrays(n,runtime.byteArrayFromArray(e))},this.appendUInt16LE=function(e){t.appendArray([255&e,e>>8&255])},this.appendUInt32LE=function(e){t.appendArray([255&e,e>>8&255,e>>16&255,e>>24&255])},this.appendString=function(t){n=runtime.concatByteArrays(n,runtime.byteArrayFromString(t,e))},this.getLength=function(){return n.length},this.getByteArray=function(){return n}},core.RawInflate=function(){var e,t,n,o,r,a,i,s,l,u,c,d,m,f,p,g,h,y=null,b=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=function(){this.list=this.next=null},E=function(){this.n=this.b=this.e=0,this.t=null},T=function(e,t,n,o,r,a){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var i,s,l,u,c,d,m,f,p,g,h=Array(this.BMAX+1),y=Array(this.BMAX+1),b=new E,x=Array(this.BMAX);u=Array(this.N_MAX);var v,N,C,S,T=Array(this.BMAX+1);for(S=this.root=null,c=0;c<h.length;c++)h[c]=0;for(c=0;c<y.length;c++)y[c]=0;for(c=0;c<x.length;c++)x[c]=null;for(c=0;c<u.length;c++)u[c]=0;for(c=0;c<T.length;c++)T[c]=0;i=t>256?e[256]:this.BMAX,f=e,p=0,c=t;do h[f[p]]++,p++;while(0<--c);if(h[0]==t)this.root=null,this.status=this.m=0;else{for(d=1;d<=this.BMAX&&0==h[d];d++);for(m=d,d>a&&(a=d),c=this.BMAX;0!=c&&0==h[c];c--);for(l=c,a>c&&(a=c),N=1<<d;c>d;d++,N<<=1)if(0>(N-=h[d]))return this.status=2,void(this.m=a);if(0>(N-=h[c]))this.status=2,this.m=a;else{for(h[c]+=N,T[1]=d=0,f=h,p=1,g=2;0<--c;)T[g++]=d+=f[p++];f=e,c=p=0;do 0!=(d=f[p++])&&(u[T[d]++]=c);while(++c<t);for(t=T[l],T[0]=c=0,f=u,p=0,u=-1,v=y[0]=0,g=null,C=0;l>=m;m++)for(e=h[m];0<e--;){for(;m>v+y[1+u];){if(v+=y[1+u],u++,C=(C=l-v)>a?a:C,(s=1<<(d=m-v))>e+1)for(s-=e+1,g=m;++d<C&&!((s<<=1)<=h[++g]);)s-=h[g];for(v+d>i&&i>v&&(d=i-v),C=1<<d,y[1+u]=d,g=Array(C),s=0;C>s;s++)g[s]=new E;S=null==S?this.root=new w:S.next=new w,S.next=null,S.list=g,x[u]=g,u>0&&(T[u]=c,b.b=y[u],b.e=16+d,b.t=g,d=(c&(1<<v)-1)>>v-y[u],x[u-1][d].e=b.e,x[u-1][d].b=b.b,x[u-1][d].n=b.n,x[u-1][d].t=b.t)}for(b.b=m-v,p>=t?b.e=99:f[p]<n?(b.e=256>f[p]?16:15,b.n=f[p++]):(b.e=r[f[p]-n],b.n=o[f[p++]-n]),s=1<<m-v,d=c>>v;C>d;d+=s)g[d].e=b.e,g[d].b=b.b,g[d].n=b.n,g[d].t=b.t;for(d=1<<m-1;0!=(c&d);d>>=1)c^=d;for(c^=d;(c&(1<<v)-1)!=T[u];)v-=y[u],u--}this.m=y[1],this.status=0!=N&&1!=l?1:0}}},O=function(e){for(;e>a;){var t,n=r;t=p.length==g?-1:p[g++],r=n|t<<a,a+=8}},D=function(e){return r&b[e]},A=function(e){r>>=e,a-=e},R=function(n,o,r){var a,s,p;if(0==r)return 0;for(p=0;;){for(O(m),s=c.list[D(m)],a=s.e;a>16;){if(99==a)return-1;A(s.b),a-=16,O(a),s=s.t[D(a)],a=s.e}if(A(s.b),16==a)t&=32767,n[o+p++]=e[t++]=s.n;else{if(15==a)break;for(O(a),l=s.n+D(a),A(a),O(f),s=d.list[D(f)],a=s.e;a>16;){if(99==a)return-1;A(s.b),a-=16,O(a),s=s.t[D(a)],a=s.e}for(A(s.b),O(a),u=t-s.n-D(a),A(a);l>0&&r>p;)l--,u&=32767,t&=32767,n[o+p++]=e[t++]=e[u++]}if(p==r)return r}return i=-1,p},P=function(e,t,n){var o,r,a,i,s,l,u,p=Array(316);for(o=0;o<p.length;o++)p[o]=0;if(O(5),l=257+D(5),A(5),O(5),u=1+D(5),A(5),O(4),o=4+D(4),A(4),l>286||u>30)return-1;for(r=0;o>r;r++)O(3),p[S[r]]=D(3),A(3);for(;19>r;r++)p[S[r]]=0;if(m=7,r=new T(p,19,19,null,null,m),0!=r.status)return-1;for(c=r.root,m=r.m,i=l+u,o=a=0;i>o;)if(O(m),s=c.list[D(m)],r=s.b,A(r),r=s.n,16>r)p[o++]=a=r;else if(16==r){if(O(2),r=3+D(2),A(2),o+r>i)return-1;for(;0<r--;)p[o++]=a}else{if(17==r?(O(3),r=3+D(3),A(3)):(O(7),r=11+D(7),A(7)),o+r>i)return-1;for(;0<r--;)p[o++]=0;a=0}if(m=9,r=new T(p,l,257,x,v,m),0==m&&(r.status=1),0!=r.status)return-1;for(c=r.root,m=r.m,o=0;u>o;o++)p[o]=p[o+l];return f=6,r=new T(p,u,0,N,C,f),d=r.root,f=r.m,0==f&&l>257||0!=r.status?-1:R(e,t,n)};this.inflate=function(b,S){null==e&&(e=Array(65536)),a=r=t=0,i=-1,s=!1,l=u=0,c=null,p=b,g=0;var w=new runtime.ByteArray(S);e:{var E,I;for(E=0;S>E&&(!s||-1!=i);){if(l>0){if(0!=i)for(;l>0&&S>E;)l--,u&=32767,t&=32767,w[0+E++]=e[t++]=e[u++];else{for(;l>0&&S>E;)l--,t&=32767,O(8),w[0+E++]=e[t++]=D(8),A(8);0==l&&(i=-1)}if(E==S)break}if(-1==i){if(s)break;O(1),0!=D(1)&&(s=!0),A(1),O(2),i=D(2),A(2),c=null,l=0}switch(i){case 0:I=w;var F=0+E,k=S-E,U=void 0,U=7&a;if(A(U),O(16),U=D(16),A(16),O(16),U!=(65535&~r))I=-1;else{for(A(16),l=U,U=0;l>0&&k>U;)l--,t&=32767,O(8),I[F+U++]=e[t++]=D(8),A(8);0==l&&(i=-1),I=U}break;case 1:if(null!=c)I=R(w,0+E,S-E);else t:{if(I=w,F=0+E,k=S-E,null==y){for(var M=void 0,U=Array(288),M=void 0,M=0;144>M;M++)U[M]=8;for(;256>M;M++)U[M]=9;for(;280>M;M++)U[M]=7;for(;288>M;M++)U[M]=8;if(o=7,M=new T(U,288,257,x,v,o),0!=M.status){alert("HufBuild error: "+M.status),I=-1;break t}for(y=M.root,o=M.m,M=0;30>M;M++)U[M]=5;if(h=5,M=new T(U,30,0,N,C,h),1<M.status){y=null,alert("HufBuild error: "+M.status),I=-1;break t}n=M.root,h=M.m}c=y,d=n,m=o,f=h,I=R(I,F,k)}break;case 2:I=null!=c?R(w,0+E,S-E):P(w,0+E,S-E);break;default:I=-1}if(-1==I)break e;E+=I}}return p=null,w}},core.LoopWatchDog=function(e,t){var n=Date.now(),o=0;this.check=function(){var r;if(e&&(r=Date.now(),r-n>e))throw runtime.log("alert","watchdog timeout"),"timeout!";if(t>0&&(o+=1,o>t))throw runtime.log("alert","watchdog loop overflow"),"loop overflow"}},core.Utils=function(){this.hashString=function(e){var t,n,o=0;for(t=0,n=e.length;n>t;t+=1)o=(o<<5)-o+e.charCodeAt(t),o|=0;return o}},core.DomUtils=function(){function e(e,t){if(e.nodeType===Node.TEXT_NODE)if(0===e.length)e.parentNode.removeChild(e);else if(t.nodeType===Node.TEXT_NODE)return t.insertData(0,e.data),e.parentNode.removeChild(e),t;return e}function t(e,t){return e===t||Boolean(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)}this.splitBoundaries=function(e){var t,n=[];if(e.startContainer.nodeType===Node.TEXT_NODE||e.endContainer.nodeType===Node.TEXT_NODE){
t=e.endContainer;var o=e.endOffset;if(o<t.childNodes.length)for(t=t.childNodes[o],o=0;t.firstChild;)t=t.firstChild;else for(;t.lastChild;)t=t.lastChild,o=t.nodeType===Node.TEXT_NODE?t.textContent.length:t.childNodes.length;e.setEnd(t,o),0!==e.endOffset&&e.endContainer.nodeType===Node.TEXT_NODE&&e.endOffset!==e.endContainer.length&&(n.push(e.endContainer.splitText(e.endOffset)),n.push(e.endContainer)),0!==e.startOffset&&e.startContainer.nodeType===Node.TEXT_NODE&&e.startOffset!==e.startContainer.length&&(t=e.startContainer.splitText(e.startOffset),n.push(e.startContainer),n.push(t),e.setStart(t,0))}return n},this.containsRange=function(e,t){return 0>=e.compareBoundaryPoints(e.START_TO_START,t)&&0<=e.compareBoundaryPoints(e.END_TO_END,t)},this.rangesIntersect=function(e,t){return 0>=e.compareBoundaryPoints(e.END_TO_START,t)&&0<=e.compareBoundaryPoints(e.START_TO_END,t)},this.getNodesInRange=function(e,t){var n,o=[],r=e.startContainer.ownerDocument.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ALL,t,!1);for(n=r.currentNode=e.startContainer;n;){if(t(n)===NodeFilter.FILTER_ACCEPT)o.push(n);else if(t(n)===NodeFilter.FILTER_REJECT)break;n=n.parentNode}for(o.reverse(),n=r.nextNode();n;)o.push(n),n=r.nextNode();return o},this.normalizeTextNodes=function(t){t&&t.nextSibling&&(t=e(t,t.nextSibling)),t&&t.previousSibling&&e(t.previousSibling,t)},this.rangeContainsNode=function(e,t){var n=t.ownerDocument.createRange(),o=t.nodeType===Node.TEXT_NODE?t.length:t.childNodes.length;return n.setStart(e.startContainer,e.startOffset),n.setEnd(e.endContainer,e.endOffset),o=0===n.comparePoint(t,0)&&0===n.comparePoint(t,o),n.detach(),o},this.mergeIntoParent=function(e){for(var t=e.parentNode;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t},this.getElementsByTagNameNS=function(e,t,n){return Array.prototype.slice.call(e.getElementsByTagNameNS(t,n))},this.rangeIntersectsNode=function(e,t){var n=t.nodeType===Node.TEXT_NODE?t.length:t.childNodes.length;return 0>=e.comparePoint(t,0)&&0<=e.comparePoint(t,n)},this.containsNode=function(e,t){return e===t||e.contains(t)},function(e){var n=runtime.getWindow();null!==n&&(n=n.navigator.appVersion.toLowerCase(),n=-1===n.indexOf("chrome")&&(-1!==n.indexOf("applewebkit")||-1!==n.indexOf("safari")))&&(e.containsNode=t)}(this)},runtime.loadClass("core.DomUtils"),core.Cursor=function(e,t){function n(e){e.parentNode&&(u.push(e.previousSibling),u.push(e.nextSibling),e.parentNode.removeChild(e))}function o(e,t,n){if(t.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(t),"putCursorIntoTextNode: invalid container");var o=t.parentNode;runtime.assert(Boolean(o),"putCursorIntoTextNode: container without parent"),runtime.assert(n>=0&&n<=t.length,"putCursorIntoTextNode: offset is out of bounds"),0===n?o.insertBefore(e,t):(n!==t.length&&t.splitText(n),o.insertBefore(e,t.nextSibling))}else if(t.nodeType===Node.ELEMENT_NODE){for(runtime.assert(Boolean(t),"putCursorIntoContainer: invalid container"),o=t.firstChild;null!==o&&n>0;)o=o.nextSibling,n-=1;t.insertBefore(e,o)}u.push(e.previousSibling),u.push(e.nextSibling)}var r,a,i,s=e.createElementNS("urn:webodf:names:cursor","cursor"),l=e.createElementNS("urn:webodf:names:cursor","anchor"),u=[],c=new core.DomUtils;this.getNode=function(){return s},this.getAnchorNode=function(){return l.parentNode?l:s},this.getSelectedRange=function(){return i?(a.setStartBefore(s),a.collapse(!0)):(a.setStartAfter(r?l:s),a.setEndBefore(r?s:l)),a},this.setSelectedRange=function(e,t){a&&a!==e&&a.detach(),a=e,r=!1!==t,(i=e.collapsed)?(n(l),n(s),o(s,e.startContainer,e.startOffset)):(n(l),n(s),o(r?s:l,e.endContainer,e.endOffset),o(r?l:s,e.startContainer,e.startOffset)),u.forEach(c.normalizeTextNodes),u.length=0},this.remove=function(){n(s),u.forEach(c.normalizeTextNodes),u.length=0},s.setAttributeNS("urn:webodf:names:cursor","memberId",t),l.setAttributeNS("urn:webodf:names:cursor","memberId",t)},core.EventNotifier=function(e){var t={};this.emit=function(e,n){var o,r;for(runtime.assert(t.hasOwnProperty(e),'unknown event fired "'+e+'"'),r=t[e],o=0;o<r.length;o+=1)r[o](n)},this.subscribe=function(e,n){runtime.assert(t.hasOwnProperty(e),'tried to subscribe to unknown event "'+e+'"'),t[e].push(n),runtime.log('event "'+e+'" subscribed.')},this.unsubscribe=function(e,n){var o;runtime.assert(t.hasOwnProperty(e),'tried to unsubscribe from unknown event "'+e+'"'),o=t[e].indexOf(n),runtime.assert(-1!==o,'tried to unsubscribe unknown callback from event "'+e+'"'),-1!==o&&t[e].splice(o,1),runtime.log('event "'+e+'" unsubscribed.')},function(){var n;for(n=0;n<e.length;n+=1)t[e[n]]=[]}()},core.UnitTest=function(){},core.UnitTest.prototype.setUp=function(){},core.UnitTest.prototype.tearDown=function(){},core.UnitTest.prototype.description=function(){},core.UnitTest.prototype.tests=function(){},core.UnitTest.prototype.asyncTests=function(){},core.UnitTest.provideTestAreaDiv=function(){var e=runtime.getWindow().document,t=e.getElementById("testarea");return runtime.assert(!t,'Unclean test environment, found a div with id "testarea".'),t=e.createElement("div"),t.setAttribute("id","testarea"),e.body.appendChild(t),t},core.UnitTest.cleanupTestAreaDiv=function(){var e=runtime.getWindow().document,t=e.getElementById("testarea");runtime.assert(!!t&&t.parentNode===e.body,'Test environment broken, found no div with id "testarea" below body.'),e.body.removeChild(t)},core.UnitTestRunner=function(){function f(e){a+=1,runtime.log("fail",e)}function h(e,t){var n;try{if(e.length!==t.length)return f("array of length "+e.length+" should be "+t.length+" long"),!1;for(n=0;n<e.length;n+=1)if(e[n]!==t[n])return f(e[n]+" should be "+t[n]+" at array index "+n),!1}catch(o){return!1}return!0}function c(e,t,n){var o,r,a,i=e.attributes,s=i.length;for(o=0;s>o;o+=1)if(r=i.item(o),"xmlns"!==r.prefix){if(a=t.getAttributeNS(r.namespaceURI,r.localName),!t.hasAttributeNS(r.namespaceURI,r.localName))return f("Attribute "+r.localName+" with value "+r.value+" was not present"),!1;if(a!==r.value)return f("Attribute "+r.localName+" was "+a+" should be "+r.value),!1}return n?!0:c(t,e,!0)}function g(e,t){if(e.nodeType!==t.nodeType)return f(e.nodeType+" should be "+t.nodeType),!1;if(e.nodeType===Node.TEXT_NODE)return e.data===t.data;if(runtime.assert(e.nodeType===Node.ELEMENT_NODE,"Only textnodes and elements supported."),e.namespaceURI!==t.namespaceURI||e.localName!==t.localName)return f(e.namespaceURI+" should be "+t.namespaceURI),!1;if(!c(e,t,!1))return!1;for(var n=e.firstChild,o=t.firstChild;n;){if(!o||!g(n,o))return!1;n=n.nextSibling,o=o.nextSibling}return o?!1:!0}function b(e,t){return 0===t?e===t&&1/e===1/t:e===t?!0:"number"==typeof t&&isNaN(t)?"number"==typeof e&&isNaN(e):Object.prototype.toString.call(t)===Object.prototype.toString.call([])?h(e,t):"object"==typeof t&&"object"==typeof e?t.constructor===Element||t.constructor===Node?g(t,e):n(t,e):!1}function p(a,d,c){"string"==typeof d&&"string"==typeof c||runtime.log("WARN: shouldBe() expects string arguments");var l,r;try{r=eval(d)}catch(k){l=k}a=eval(c),l?f(d+" should be "+a+". Threw exception "+l):b(r,a)?runtime.log("pass",d+" is "+c):String(typeof r)===String(typeof a)?(c=0===r&&0>1/r?"-0":String(r),f(d+" should be "+a+". Was "+c+".")):f(d+" should be "+a+" (of type "+typeof a+"). Was "+r+" (of type "+typeof r+").")}var a=0,n;n=function(e,t){var n=Object.keys(e),o=Object.keys(t);return n.sort(),o.sort(),h(n,o)&&Object.keys(e).every(function(n){var o=e[n],r=t[n];return b(o,r)?!0:(f(o+" should be "+r+" for key "+n),!1)})},this.areNodesEqual=g,this.shouldBeNull=function(e,t){p(e,t,"null")},this.shouldBeNonNull=function(a,d){var b,c;try{c=eval(d)}catch(r){b=r}b?f(d+" should be non-null. Threw exception "+b):null!==c?runtime.log("pass",d+" is non-null."):f(d+" should be non-null. Was "+c)},this.shouldBe=p,this.countFailedTests=function(){return a}},core.UnitTester=function(){function e(e,t){return"<span style='color:blue;cursor:pointer' onclick='"+t+"'>"+e+"</span>"}var t=0,n={};this.runTests=function(o,r,a){function i(e){if(0===e.length)n[d]=p,t+=m.countFailedTests(),r();else{l=e[0];var o=Runtime.getFunctionName(l);runtime.log("Running "+o),c=m.countFailedTests(),f.setUp(),l(function(){f.tearDown(),p[o]=c===m.countFailedTests(),i(e.slice(1))})}}var s,l,u,c,d=Runtime.getFunctionName(o),m=new core.UnitTestRunner,f=new o(m),p={},g="BrowserRuntime"===runtime.type();if(n.hasOwnProperty(d))runtime.log("Test "+d+" has already run.");else{for(runtime.log(g?"<span>Running "+e(d,'runSuite("'+d+'");')+": "+f.description()+"</span>":"Running "+d+": "+f.description),u=f.tests(),s=0;s<u.length;s+=1)l=u[s],o=Runtime.getFunctionName(l)||l.testName,a.length&&-1===a.indexOf(o)||(runtime.log(g?"<span>Running "+e(o,'runTest("'+d+'","'+o+'")')+"</span>":"Running "+o),c=m.countFailedTests(),f.setUp(),l(),f.tearDown(),p[o]=c===m.countFailedTests());i(f.asyncTests())}},this.countFailedTests=function(){return t},this.results=function(){return n}},core.PositionIterator=function(e,t,n,o){function r(){this.acceptNode=function(e){return e.nodeType===Node.TEXT_NODE&&0===e.length?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}function a(e){this.acceptNode=function(t){return t.nodeType===Node.TEXT_NODE&&0===t.length?NodeFilter.FILTER_REJECT:e.acceptNode(t)}}function i(){var e=s.currentNode.nodeType;l=e===Node.TEXT_NODE?s.currentNode.length-1:e===Node.ELEMENT_NODE?1:0}var s,l,u,c=this;this.nextPosition=function(){if(s.currentNode===e)return!1;if(0===l&&s.currentNode.nodeType===Node.ELEMENT_NODE)null===s.firstChild()&&(l=1);else if(s.currentNode.nodeType===Node.TEXT_NODE&&l+1<s.currentNode.length)l+=1;else if(null!==s.nextSibling())l=0;else{if(!s.parentNode())return!1;l=1}return!0},this.previousPosition=function(){var t=!0;if(0===l)if(null===s.previousSibling()){if(!s.parentNode()||s.currentNode===e)return s.firstChild(),!1;l=0}else i();else s.currentNode.nodeType===Node.TEXT_NODE?l-=1:null!==s.lastChild()?i():s.currentNode===e?t=!1:l=0;return t},this.container=function(){var e=s.currentNode,t=e.nodeType;return 0===l&&t!==Node.TEXT_NODE?e.parentNode:e},this.rightNode=function(){var e=s.currentNode,t=e.nodeType;if(t===Node.TEXT_NODE&&l===e.length)for(e=e.nextSibling;e&&1!==u(e);)e=e.nextSibling;else t===Node.ELEMENT_NODE&&1===l&&(e=null);return e},this.leftNode=function(){var e=s.currentNode;if(0===l)for(e=e.previousSibling;e&&1!==u(e);)e=e.previousSibling;else if(e.nodeType===Node.ELEMENT_NODE)for(e=e.lastChild;e&&1!==u(e);)e=e.previousSibling;return e},this.getCurrentNode=function(){return s.currentNode},this.domOffset=function(){if(s.currentNode.nodeType===Node.TEXT_NODE)return l;var e,t=0,n=s.currentNode;for(e=1===l?s.lastChild():s.previousSibling();e;)t+=1,e=s.previousSibling();return s.currentNode=n,t},this.unfilteredDomOffset=function(){if(s.currentNode.nodeType===Node.TEXT_NODE)return l;for(var e=0,t=s.currentNode,t=1===l?t.lastChild:t.previousSibling;t;)e+=1,t=t.previousSibling;return e},this.getPreviousSibling=function(){var e=s.currentNode,t=s.previousSibling();return s.currentNode=e,t},this.getNextSibling=function(){var e=s.currentNode,t=s.nextSibling();return s.currentNode=e,t},this.setUnfilteredPosition=function(e,t){var n;return runtime.assert(null!==e&&void 0!==e,"PositionIterator.setUnfilteredPosition called without container"),s.currentNode=e,e.nodeType===Node.TEXT_NODE?(l=t,runtime.assert(t<=e.length,"Error in setPosition: "+t+" > "+e.length),runtime.assert(t>=0,"Error in setPosition: "+t+" < 0"),t===e.length&&(l=void 0,s.nextSibling()?l=0:s.parentNode()&&(l=1),runtime.assert(void 0!==l,"Error in setPosition: position not valid.")),!0):(n=u(e),t<e.childNodes.length&&n!==NodeFilter.FILTER_REJECT?(s.currentNode=e.childNodes[t],n=u(s.currentNode),l=0):l=0===t?0:1,n===NodeFilter.FILTER_REJECT&&(l=1),n!==NodeFilter.FILTER_ACCEPT?c.nextPosition():(runtime.assert(u(s.currentNode)===NodeFilter.FILTER_ACCEPT,"PositionIterater.setUnfilteredPosition call resulted in an non-visible node being set"),!0))},this.moveToEnd=function(){s.currentNode=e,l=1},this.moveToEndOfNode=function(e){e.nodeType===Node.TEXT_NODE?c.setUnfilteredPosition(e,e.length):(s.currentNode=e,l=1)},this.getNodeFilter=function(){return u},u=(n?new a(n):new r).acceptNode,u.acceptNode=u,s=e.ownerDocument.createTreeWalker(e,t||4294967295,u,o),l=0,null===s.firstChild()&&(l=1)},runtime.loadClass("core.PositionIterator"),core.PositionFilter=function(){},core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3},core.PositionFilter.prototype.acceptPosition=function(e){},function(){return core.PositionFilter}(),runtime.loadClass("core.PositionFilter"),core.PositionFilterChain=function(){var e={},t=core.PositionFilter.FilterResult.FILTER_ACCEPT,n=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(o){for(var r in e)if(e.hasOwnProperty(r)&&e[r].acceptPosition(o)===n)return n;return t},this.addFilter=function(t,n){e[t]=n},this.removeFilter=function(t){delete e[t]}},core.Async=function(){this.forEach=function(e,t,n){function o(e){i!==a&&(e?(i=a,n(e)):(i+=1,i===a&&n(null)))}var r,a=e.length,i=0;for(r=0;a>r;r+=1)t(e[r],o)}},runtime.loadClass("core.RawInflate"),runtime.loadClass("core.ByteArray"),runtime.loadClass("core.ByteArrayWriter"),runtime.loadClass("core.Base64"),core.Zip=function(e,t){function n(e){var t,n,o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],r=e.length,a=0,a=0;for(t=-1,n=0;r>n;n+=1)a=255&(t^e[n]),a=o[a],t=t>>>8^a;return-1^t}function o(e){return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&15,e>>5&63,(31&e)<<1)}function r(e){var t=e.getFullYear();return 1980>t?0:t-1980<<25|e.getMonth()+1<<21|e.getDate()<<16|e.getHours()<<11|e.getMinutes()<<5|e.getSeconds()>>1}function a(e,t){var n,r,a,i,s,l,u,c=this;this.load=function(t){if(void 0!==c.data)t(null,c.data);else{var n=s+34+r+a+256;n+u>p&&(n=p-u),runtime.read(e,u,n,function(n,o){if(n||null===o)t(n,o);else e:{var r,a=o,u=new core.ByteArray(a),d=u.readUInt32LE();if(67324752!==d)t("File entry signature is wrong."+d.toString()+" "+a.length.toString(),null);else{if(u.pos+=22,d=u.readUInt16LE(),r=u.readUInt16LE(),u.pos+=d+r,i){if(a=a.slice(u.pos,u.pos+s),s!==a.length){t("The amount of compressed bytes read was "+a.length.toString()+" instead of "+s.toString()+" for "+c.filename+" in "+e+".",null);break e}a=h(a,l)}else a=a.slice(u.pos,u.pos+l);l!==a.length?t("The amount of bytes read was "+a.length.toString()+" instead of "+l.toString()+" for "+c.filename+" in "+e+".",null):(c.data=a,t(null,a))}}})}},this.set=function(e,t,n,o){c.filename=e,c.data=t,c.compressed=n,c.date=o},this.error=null,t&&(n=t.readUInt32LE(),33639248!==n?this.error="Central directory entry has wrong signature at position "+(t.pos-4).toString()+' for file "'+e+'": '+t.data.length.toString():(t.pos+=6,i=t.readUInt16LE(),this.date=o(t.readUInt32LE()),t.readUInt32LE(),s=t.readUInt32LE(),l=t.readUInt32LE(),r=t.readUInt16LE(),a=t.readUInt16LE(),n=t.readUInt16LE(),t.pos+=8,u=t.readUInt32LE(),this.filename=runtime.byteArrayToString(t.data.slice(t.pos,t.pos+r),"utf8"),t.pos+=r+a+n))}function i(t,n){if(22!==t.length)n("Central directory length should be 22.",y);else{var o,r=new core.ByteArray(t);o=r.readUInt32LE(),101010256!==o?n("Central directory signature is wrong: "+o.toString(),y):(o=r.readUInt16LE(),0!==o?n("Zip files with non-zero disk numbers are not supported.",y):(o=r.readUInt16LE(),0!==o?n("Zip files with non-zero disk numbers are not supported.",y):(o=r.readUInt16LE(),g=r.readUInt16LE(),o!==g?n("Number of entries is inconsistent.",y):(o=r.readUInt32LE(),r=r.readUInt16LE(),r=p-22-o,runtime.read(e,r,p-r,function(t,o){if(t||null===o)n(t,y);else e:{var r,i,s=new core.ByteArray(o);for(f=[],r=0;g>r;r+=1){if(i=new a(e,s),i.error){n(i.error,y);break e}f[f.length]=i}n(null,y)}})))))}}function s(e,t){var n,o,r=null;for(o=0;o<f.length;o+=1)if(n=f[o],n.filename===e){r=n;break}r?r.data?t(null,r.data):r.load(t):t(e+" not found.",null)}function l(e){var t=new core.ByteArrayWriter("utf8"),o=0;return t.appendArray([80,75,3,4,20,0,0,0,0,0]),e.data&&(o=e.data.length),t.appendUInt32LE(r(e.date)),t.appendUInt32LE(n(e.data)),t.appendUInt32LE(o),t.appendUInt32LE(o),t.appendUInt16LE(e.filename.length),t.appendUInt16LE(0),t.appendString(e.filename),e.data&&t.appendByteArray(e.data),t}function u(e,t){var o=new core.ByteArrayWriter("utf8"),a=0;return o.appendArray([80,75,1,2,20,0,20,0,0,0,0,0]),e.data&&(a=e.data.length),o.appendUInt32LE(r(e.date)),o.appendUInt32LE(n(e.data)),o.appendUInt32LE(a),o.appendUInt32LE(a),o.appendUInt16LE(e.filename.length),o.appendArray([0,0,0,0,0,0,0,0,0,0,0,0]),o.appendUInt32LE(t),o.appendString(e.filename),o}function c(e,t){if(e===f.length)t(null);else{var n=f[e];void 0!==n.data?c(e+1,t):n.load(function(n){n?t(n):c(e+1,t)})}}function d(e,t){c(0,function(n){if(n)t(n);else{n=new core.ByteArrayWriter("utf8");var o,r,a,i=[0];for(o=0;o<f.length;o+=1)n.appendByteArrayWriter(l(f[o])),i.push(n.getLength());for(a=n.getLength(),o=0;o<f.length;o+=1)r=f[o],n.appendByteArrayWriter(u(r,i[o]));o=n.getLength()-a,n.appendArray([80,75,5,6,0,0,0,0]),n.appendUInt16LE(f.length),n.appendUInt16LE(f.length),n.appendUInt32LE(o),n.appendUInt32LE(a),n.appendArray([0,0]),e(n.getByteArray())}})}function m(e,t){d(function(n){runtime.writeFile(e,n,t)},t)}var f,p,g,h=(new core.RawInflate).inflate,y=this,b=new core.Base64;this.load=s,this.save=function(t,n,o,r){var i,s;for(i=0;i<f.length;i+=1)if(s=f[i],s.filename===t)return void s.set(t,n,o,r);s=new a(e),s.set(t,n,o,r),f.push(s)},this.write=function(t){m(e,t)},this.writeAs=m,this.createByteArray=d,this.loadContentXmlAsFragments=function(e,t){y.loadAsString(e,function(e,n){return e?t.rootElementReady(e):void t.rootElementReady(null,n,!0)})},this.loadAsString=function(e,t){s(e,function(e,n){if(e||null===n)return t(e,null);var o=runtime.byteArrayToString(n,"utf8");t(null,o)})},this.loadAsDOM=function(e,t){y.loadAsString(e,function(e,n){if(e||null===n)t(e,null);else{var o=(new DOMParser).parseFromString(n,"text/xml");t(null,o)}})},this.loadAsDataURL=function(e,t,n){s(e,function(e,o){if(e)return n(e,null);var r,a=0;for(t||(t=80===o[1]&&78===o[2]&&71===o[3]?"image/png":255===o[0]&&216===o[1]&&255===o[2]?"image/jpeg":71===o[0]&&73===o[1]&&70===o[2]?"image/gif":""),r="data:"+t+";base64,";a<o.length;)r+=b.convertUTF8ArrayToBase64(o.slice(a,Math.min(a+45e3,o.length))),a+=45e3;n(null,r)})},this.getEntries=function(){return f.slice()},p=-1,null===t?f=[]:runtime.getFileSize(e,function(n){p=n,0>p?t("File '"+e+"' cannot be read.",y):runtime.read(e,p-22,22,function(e,n){e||null===t||null===n?t(e,y):i(n,t)})})},core.CSSUnits=function(){var e={"in":1,cm:2.54,mm:25.4,pt:72,pc:12};this.convert=function(t,n,o){return t*e[o]/e[n]},this.convertMeasure=function(e,t){var n,o;return e&&t?(n=parseFloat(e),o=e.replace(n.toString(),""),n=this.convert(n,o,t)):n="",n.toString()},this.getUnits=function(e){return e.substr(e.length-2,e.length)}},xmldom.LSSerializerFilter=function(){},"function"!=typeof Object.create&&(Object.create=function(e){var t=function(){};return t.prototype=e,new t}),xmldom.LSSerializer=function(){function e(e){var t=e||{},n=function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}(e),o=[t],r=[n],a=0;this.push=function(){a+=1,t=o[a]=Object.create(t),n=r[a]=Object.create(n)},this.pop=function(){o[a]=void 0,r[a]=void 0,a-=1,t=o[a],n=r[a]},this.getLocalNamespaceDefinitions=function(){return n},this.getQName=function(e){var o,r=e.namespaceURI,a=0;if(!r)return e.localName;if(o=n[r])return o+":"+e.localName;do{if(o||!e.prefix?(o="ns"+a,a+=1):o=e.prefix,t[o]===r)break;if(!t[o]){t[o]=r,n[r]=o;break}o=null}while(null===o);return o+":"+e.localName}}function t(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function n(e,r){var a,i="",s=o.filter?o.filter.acceptNode(r):NodeFilter.FILTER_ACCEPT;if(s===NodeFilter.FILTER_ACCEPT&&r.nodeType===Node.ELEMENT_NODE){e.push(),a=e.getQName(r);var l,u,c,d,m,f=r.attributes,p="";for(l="<"+a,u=f.length,c=0;u>c;c+=1)d=f.item(c),"http://www.w3.org/2000/xmlns/"!==d.namespaceURI&&(m=o.filter?o.filter.acceptNode(d):NodeFilter.FILTER_ACCEPT,m===NodeFilter.FILTER_ACCEPT&&(m=e.getQName(d),d="string"==typeof d.value?t(d.value):d.value,p+=" "+(m+'="'+d+'"')));u=e.getLocalNamespaceDefinitions();for(c in u)u.hasOwnProperty(c)&&((f=u[c])?"xmlns"!==f&&(l+=" xmlns:"+u[c]+'="'+c+'"'):l+=' xmlns="'+c+'"');i+=l+(p+">")}if(s===NodeFilter.FILTER_ACCEPT||s===NodeFilter.FILTER_SKIP){for(s=r.firstChild;s;)i+=n(e,s),s=s.nextSibling;r.nodeValue&&(i+=t(r.nodeValue))}return a&&(i+="</"+a+">",e.pop()),i}var o=this;this.filter=null,this.writeToString=function(t,o){if(!t)return"";var r=new e(o);return n(r,t)}},xmldom.RelaxNGParser=function(){function e(e,t){this.message=function(){return t&&(e+=1===t.nodeType?" Element ":" Node ",e+=t.nodeName,t.nodeValue&&(e+=" with value '"+t.nodeValue+"'"),e+="."),e}}function t(e){if(2>=e.e.length)return e;var n={name:e.name,e:e.e.slice(0,2)};return t({name:e.name,e:[n].concat(e.e.slice(2))})}function n(e){e=e.split(":",2);var t,n="";1===e.length?e=["",e[0]]:n=e[0];for(t in l)l[t]===n&&(e[0]=t);return e}function o(e,t){for(var r,a,i=0,s=e.name;e.e&&i<e.e.length;)if(r=e.e[i],"ref"===r.name){if(a=t[r.a.name],!a)throw r.a.name+" was not defined.";r=e.e.slice(i+1),e.e=e.e.slice(0,i),e.e=e.e.concat(a.e),e.e=e.e.concat(r)}else i+=1,o(r,t);if(r=e.e,"choice"!==s||r&&r[1]&&"empty"!==r[1].name||(r&&r[0]&&"empty"!==r[0].name?(r[1]=r[0],r[0]={name:"empty"}):(delete e.e,e.name="empty")),("group"===s||"interleave"===s)&&("empty"===r[0].name?"empty"===r[1].name?(delete e.e,e.name="empty"):(s=e.name=r[1].name,e.names=r[1].names,r=e.e=r[1].e):"empty"===r[1].name&&(s=e.name=r[0].name,e.names=r[0].names,r=e.e=r[0].e)),"oneOrMore"===s&&"empty"===r[0].name&&(delete e.e,e.name="empty"),"attribute"===s){a=e.names?e.names.length:0;for(var l,u=[],c=[],i=0;a>i;i+=1)l=n(e.names[i]),c[i]=l[0],u[i]=l[1];e.localnames=u,e.namespaces=c}"interleave"===s&&("interleave"===r[0].name?e.e="interleave"===r[1].name?r[0].e.concat(r[1].e):[r[1]].concat(r[0].e):"interleave"===r[1].name&&(e.e=[r[0]].concat(r[1].e)))}function r(e,t){for(var n,o=0;e.e&&o<e.e.length;)n=e.e[o],"elementref"===n.name?(n.id=n.id||0,e.e[o]=t[n.id]):"element"!==n.name&&r(n,t),o+=1}var a,i,s=this,l={"http://www.w3.org/XML/1998/namespace":"xml"};i=function(e,o,r){var a,s,u=[],c=e.localName,d=[];a=e.attributes;var m,f,p=c,g=d,h={};for(m=0;m<a.length;m+=1)if(f=a.item(m),f.namespaceURI)"http://www.w3.org/2000/xmlns/"===f.namespaceURI&&(l[f.value]=f.localName);else{if("name"!==f.localName||"element"!==p&&"attribute"!==p||g.push(f.value),"name"===f.localName||"combine"===f.localName||"type"===f.localName){var y,b=f;y=f.value,y=y.replace(/^\s\s*/,"");for(var x=/\s/,v=y.length-1;x.test(y.charAt(v));)v-=1;y=y.slice(0,v+1),b.value=y}h[f.localName]=f.value}for(a=h,a.combine=a.combine||void 0,e=e.firstChild,p=u,g=d,h="";e;)e.nodeType===Node.ELEMENT_NODE&&"http://relaxng.org/ns/structure/1.0"===e.namespaceURI?(m=i(e,o,p))&&("name"===m.name?g.push(l[m.a.ns]+":"+m.text):"choice"===m.name&&m.names&&m.names.length&&(g=g.concat(m.names),delete m.names),p.push(m)):e.nodeType===Node.TEXT_NODE&&(h+=e.nodeValue),e=e.nextSibling;if(e=h,"value"!==c&&"param"!==c&&(e=/^\s*([\s\S]*\S)?\s*$/.exec(e)[1]),"value"===c&&void 0===a.type&&(a.type="token",a.datatypeLibrary=""),"attribute"!==c&&"element"!==c||void 0===a.name||(s=n(a.name),u=[{name:"name",text:s[1],a:{ns:s[0]}}].concat(u),delete a.name),"name"===c||"nsName"===c||"value"===c?void 0===a.ns&&(a.ns=""):delete a.ns,"name"===c&&(s=n(e),a.ns=s[0],e=s[1]),1<u.length&&("define"===c||"oneOrMore"===c||"zeroOrMore"===c||"optional"===c||"list"===c||"mixed"===c)&&(u=[{name:"group",e:t({name:"group",e:u}).e}]),2<u.length&&"element"===c&&(u=[u[0]].concat({name:"group",e:t({name:"group",e:u.slice(1)}).e})),1===u.length&&"attribute"===c&&u.push({name:"text",text:e}),1!==u.length||"choice"!==c&&"group"!==c&&"interleave"!==c?2<u.length&&("choice"===c||"group"===c||"interleave"===c)&&(u=t({name:c,e:u}).e):(c=u[0].name,d=u[0].names,a=u[0].a,e=u[0].text,u=u[0].e),"mixed"===c&&(c="interleave",u=[u[0],{name:"text"}]),"optional"===c&&(c="choice",u=[u[0],{name:"empty"}]),"zeroOrMore"===c&&(c="choice",u=[{name:"oneOrMore",e:[u[0]]},{name:"empty"}]),"define"===c&&a.combine){e:{for(p=a.combine,g=a.name,h=u,m=0;r&&m<r.length;m+=1)if(f=r[m],"define"===f.name&&f.a&&f.a.name===g){f.e=[{name:p,e:f.e.concat(h)}],r=f;break e}r=null}if(r)return}r={name:c},u&&0<u.length&&(r.e=u);for(s in a)if(a.hasOwnProperty(s)){r.a=a;break}return void 0!==e&&(r.text=e),d&&0<d.length&&(r.names=d),"element"===c&&(r.id=o.length,o.push(r),r={name:"elementref",id:r.id}),r},this.parseRelaxNGDOM=function(t,n){var u,c,d=[],m=i(t&&t.documentElement,d,void 0),f={};for(u=0;u<m.e.length;u+=1)c=m.e[u],"define"===c.name?f[c.a.name]=c:"start"===c.name&&(a=c);if(!a)return[new e("No Relax NG start element was found.")];o(a,f);for(u in f)f.hasOwnProperty(u)&&o(f[u],f);for(u=0;u<d.length;u+=1)o(d[u],f);for(n&&(s.rootPattern=n(a.e[0],d)),r(a,d),u=0;u<d.length;u+=1)r(d[u],d);return s.start=a,s.elements=d,s.nsmap=l,null}},runtime.loadClass("xmldom.RelaxNGParser"),xmldom.RelaxNG=function(){function e(e){return function(){var t;return function(){return void 0===t&&(t=e()),t}}()}function t(e,t){return function(){var n={},o=0;return function(r){var a,i=r.hash||r.toString();return a=n[i],void 0!==a?a:(n[i]=a=t(r),a.hash=e+o.toString(),o+=1,a)}}()}function n(e){return function(){var t={};return function(n){var o,r;if(r=t[n.localName],void 0===r)t[n.localName]=r={};else if(o=r[n.namespaceURI],void 0!==o)return o;return r[n.namespaceURI]=o=e(n)}}()}function o(e,t,n){return function(){var o={},r=0;return function(a,i){var s,l,u=t&&t(a,i);if(void 0!==u)return u;if(u=a.hash||a.toString(),s=i.hash||i.toString(),l=o[u],void 0===l)o[u]=l={};else if(u=l[s],void 0!==u)return u;return l[s]=u=n(a,i),u.hash=e+r.toString(),r+=1,u}}()}function r(e,t){"choice"===t.p1.type?r(e,t.p1):e[t.p1.hash]=t.p1,"choice"===t.p2.type?r(e,t.p2):e[t.p2.hash]=t.p2}function a(e,t){return{type:"element",nc:e,nullable:!1,textDeriv:function(){return S},startTagOpenDeriv:function(n){return e.contains(n)?m(t,w):S},attDeriv:function(){return S},startTagCloseDeriv:function(){return this}}}function i(){return{type:"list",nullable:!1,hash:"list",textDeriv:function(){return w}}}function s(e,t,n,o){if(t===S)return S;if(o>=n.length)return t;0===o&&(o=0);for(var r=n.item(o);r.namespaceURI===C;){if(o+=1,o>=n.length)return t;r=n.item(o)}return r=s(e,t.attDeriv(e,n.item(o)),n,o+1)}function l(e,t,n){n.e[0].a?(e.push(n.e[0].text),t.push(n.e[0].a.ns)):l(e,t,n.e[0]),n.e[1].a?(e.push(n.e[1].text),t.push(n.e[1].a.ns)):l(e,t,n.e[1])}var u,c,d,m,f,p,g,h,y,b,x,v,N,C="http://www.w3.org/2000/xmlns/",S={type:"notAllowed",nullable:!1,hash:"notAllowed",textDeriv:function(){return S},startTagOpenDeriv:function(){return S},attDeriv:function(){return S},startTagCloseDeriv:function(){return S},endTagDeriv:function(){return S}},w={type:"empty",nullable:!0,hash:"empty",textDeriv:function(){return S},startTagOpenDeriv:function(){return S},attDeriv:function(){return S},startTagCloseDeriv:function(){return w},endTagDeriv:function(){return S}},E={type:"text",nullable:!0,hash:"text",textDeriv:function(){return E},startTagOpenDeriv:function(){return S},attDeriv:function(){return S},startTagCloseDeriv:function(){return E},endTagDeriv:function(){return S}};u=o("choice",function(e,t){return e===S?t:t===S||e===t?e:void 0},function(t,o){var a,i={};r(i,{p1:t,p2:o}),o=t=void 0;for(a in i)i.hasOwnProperty(a)&&(void 0===t?t=i[a]:o=void 0===o?i[a]:u(o,i[a]));return function(t,o){return{type:"choice",p1:t,p2:o,nullable:t.nullable||o.nullable,textDeriv:function(e,n){return u(t.textDeriv(e,n),o.textDeriv(e,n))},startTagOpenDeriv:n(function(e){return u(t.startTagOpenDeriv(e),o.startTagOpenDeriv(e))}),attDeriv:function(e,n){return u(t.attDeriv(e,n),o.attDeriv(e,n))},startTagCloseDeriv:e(function(){return u(t.startTagCloseDeriv(),o.startTagCloseDeriv())}),endTagDeriv:e(function(){return u(t.endTagDeriv(),o.endTagDeriv())})}}(t,o)}),c=function(e,t,n){return function(){var o={},r=0;return function(a,i){var s,l,u=t&&t(a,i);if(void 0!==u)return u;if(u=a.hash||a.toString(),s=i.hash||i.toString(),s>u&&(l=u,u=s,s=l,l=a,a=i,i=l),l=o[u],void 0===l)o[u]=l={};else if(u=l[s],void 0!==u)return u;return l[s]=u=n(a,i),u.hash=e+r.toString(),r+=1,u}}()}("interleave",function(e,t){return e===S||t===S?S:e===w?t:t===w?e:void 0},function(t,o){return{type:"interleave",p1:t,p2:o,nullable:t.nullable&&o.nullable,textDeriv:function(e,n){return u(c(t.textDeriv(e,n),o),c(t,o.textDeriv(e,n)))},startTagOpenDeriv:n(function(e){return u(x(function(e){return c(e,o)},t.startTagOpenDeriv(e)),x(function(e){return c(t,e)},o.startTagOpenDeriv(e)))}),attDeriv:function(e,n){return u(c(t.attDeriv(e,n),o),c(t,o.attDeriv(e,n)))},startTagCloseDeriv:e(function(){return c(t.startTagCloseDeriv(),o.startTagCloseDeriv())})}}),d=o("group",function(e,t){return e===S||t===S?S:e===w?t:t===w?e:void 0},function(t,n){return{type:"group",p1:t,p2:n,nullable:t.nullable&&n.nullable,textDeriv:function(e,o){var r=d(t.textDeriv(e,o),n);return t.nullable?u(r,n.textDeriv(e,o)):r},startTagOpenDeriv:function(e){var o=x(function(e){return d(e,n)},t.startTagOpenDeriv(e));return t.nullable?u(o,n.startTagOpenDeriv(e)):o;

},attDeriv:function(e,o){return u(d(t.attDeriv(e,o),n),d(t,n.attDeriv(e,o)))},startTagCloseDeriv:e(function(){return d(t.startTagCloseDeriv(),n.startTagCloseDeriv())})}}),m=o("after",function(e,t){return e===S||t===S?S:void 0},function(t,o){return{type:"after",p1:t,p2:o,nullable:!1,textDeriv:function(e,n){return m(t.textDeriv(e,n),o)},startTagOpenDeriv:n(function(e){return x(function(e){return m(e,o)},t.startTagOpenDeriv(e))}),attDeriv:function(e,n){return m(t.attDeriv(e,n),o)},startTagCloseDeriv:e(function(){return m(t.startTagCloseDeriv(),o)}),endTagDeriv:e(function(){return t.nullable?o:S})}}),f=t("oneormore",function(t){return t===S?S:{type:"oneOrMore",p:t,nullable:t.nullable,textDeriv:function(e,n){return d(t.textDeriv(e,n),u(this,w))},startTagOpenDeriv:function(e){var n=this;return x(function(e){return d(e,u(n,w))},t.startTagOpenDeriv(e))},attDeriv:function(e,n){return d(t.attDeriv(e,n),u(this,w))},startTagCloseDeriv:e(function(){return f(t.startTagCloseDeriv())})}}),g=o("attribute",void 0,function(e,t){return{type:"attribute",nullable:!1,nc:e,p:t,attDeriv:function(n,o){return e.contains(o)&&(t.nullable&&/^\s+$/.test(o.nodeValue)||t.textDeriv(n,o.nodeValue).nullable)?w:S},startTagCloseDeriv:function(){return S}}}),p=t("value",function(e){return{type:"value",nullable:!1,value:e,textDeriv:function(t,n){return n===e?w:S},attDeriv:function(){return S},startTagCloseDeriv:function(){return this}}}),y=t("data",function(e){return{type:"data",nullable:!1,dataType:e,textDeriv:function(){return w},attDeriv:function(){return S},startTagCloseDeriv:function(){return this}}}),x=function T(e,t){return"after"===t.type?m(t.p1,e(t.p2)):"choice"===t.type?u(T(e,t.p1),T(e,t.p2)):t},v=function(e,t,n){var o=n.currentNode;t=t.startTagOpenDeriv(o),t=s(e,t,o.attributes,0);var r=t=t.startTagCloseDeriv(),o=n.currentNode;t=n.firstChild();for(var a,i=[];t;)t.nodeType===Node.ELEMENT_NODE?i.push(t):t.nodeType!==Node.TEXT_NODE||/^\s*$/.test(t.nodeValue)||i.push(t.nodeValue),t=n.nextSibling();for(0===i.length&&(i=[""]),a=r,r=0;a!==S&&r<i.length;r+=1)t=i[r],"string"==typeof t?a=/^\s*$/.test(t)?u(a,a.textDeriv(e,t)):a.textDeriv(e,t):(n.currentNode=t,a=v(e,a,n));return n.currentNode=o,t=a.endTagDeriv()},h=function(e){var t,n,o;if("name"===e.name)t=e.text,n=e.a.ns,e={name:t,ns:n,hash:"{"+n+"}"+t,contains:function(e){return e.namespaceURI===n&&e.localName===t}};else if("choice"===e.name){for(t=[],n=[],l(t,n,e),e="",o=0;o<t.length;o+=1)e+="{"+n[o]+"}"+t[o]+",";e={hash:e,contains:function(e){var o;for(o=0;o<t.length;o+=1)if(t[o]===e.localName&&n[o]===e.namespaceURI)return!0;return!1}}}else e={hash:"anyName",contains:function(){return!0}};return e},b=function O(e,t){var n,o;if("elementref"===e.name){if(n=e.id||0,e=t[n],void 0!==e.name){var r=e;n=t[r.id]={hash:"element"+r.id.toString()},r=a(h(r.e[0]),b(r.e[1],t));for(o in r)r.hasOwnProperty(o)&&(n[o]=r[o]);return n}return e}switch(e.name){case"empty":return w;case"notAllowed":return S;case"text":return E;case"choice":return u(O(e.e[0],t),O(e.e[1],t));case"interleave":for(n=O(e.e[0],t),o=1;o<e.e.length;o+=1)n=c(n,O(e.e[o],t));return n;case"group":return d(O(e.e[0],t),O(e.e[1],t));case"oneOrMore":return f(O(e.e[0],t));case"attribute":return g(h(e.e[0]),O(e.e[1],t));case"value":return p(e.text);case"data":return n=e.a&&e.a.type,void 0===n&&(n=""),y(n);case"list":return i()}throw"No support for "+e.name},this.makePattern=function(e,t){var n,o={};for(n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);return n=b(e,o)},this.validate=function(e,t){var n;e.currentNode=e.root,n=v(null,N,e),n.nullable?t(null):(runtime.log("Error in Relax NG validation: "+n),t(["Error in Relax NG validation: "+n]))},this.init=function(e){N=e}},runtime.loadClass("xmldom.RelaxNGParser"),xmldom.RelaxNG2=function(){function e(e,t){this.message=function(){return t&&(e+=t.nodeType===Node.ELEMENT_NODE?" Element ":" Node ",e+=t.nodeName,t.nodeValue&&(e+=" with value '"+t.nodeValue+"'"),e+="."),e}}function t(e,t,n,o){return"empty"===e.name?null:r(e,t,n,o)}function n(n,o){if(2!==n.e.length)throw"Element with wrong # of elements: "+n.e.length;for(var r=o.currentNode,i=r?r.nodeType:0,s=null;i>Node.ELEMENT_NODE;){if(i!==Node.COMMENT_NODE&&(i!==Node.TEXT_NODE||!/^\s+$/.test(o.currentNode.nodeValue)))return[new e("Not allowed node of type "+i+".")];i=(r=o.nextSibling())?r.nodeType:0}if(!r)return[new e("Missing element "+n.names)];if(n.names&&-1===n.names.indexOf(a[r.namespaceURI]+":"+r.localName))return[new e("Found "+r.nodeName+" instead of "+n.names+".",r)];if(o.firstChild()){for(s=t(n.e[1],o,r);o.nextSibling();)if(i=o.currentNode.nodeType,!(o.currentNode&&o.currentNode.nodeType===Node.TEXT_NODE&&/^\s+$/.test(o.currentNode.nodeValue)||i===Node.COMMENT_NODE))return[new e("Spurious content.",o.currentNode)];if(o.parentNode()!==r)return[new e("Implementation error.")]}else s=t(n.e[1],o,r);return o.nextSibling(),s}var o,r,a;r=function(o,a,i,s){var l=o.name,u=null;if("text"===l)e:{for(var c=(o=a.currentNode)?o.nodeType:0;o!==i&&3!==c;){if(1===c){u=[new e("Element not allowed here.",o)];break e}c=(o=a.nextSibling())?o.nodeType:0}a.nextSibling(),u=null}else if("data"===l)u=null;else if("value"===l)s!==o.text&&(u=[new e("Wrong value, should be '"+o.text+"', not '"+s+"'",i)]);else if("list"===l)u=null;else if("attribute"===l)e:{if(2!==o.e.length)throw"Attribute with wrong # of elements: "+o.e.length;for(l=o.localnames.length,u=0;l>u;u+=1){if(s=i.getAttributeNS(o.namespaces[u],o.localnames[u]),""!==s||i.hasAttributeNS(o.namespaces[u],o.localnames[u])||(s=void 0),void 0!==c&&void 0!==s){u=[new e("Attribute defined too often.",i)];break e}c=s}u=void 0===c?[new e("Attribute not found: "+o.names,i)]:t(o.e[1],a,i,c)}else if("element"===l)u=n(o,a);else if("oneOrMore"===l){s=0;do c=a.currentNode,l=r(o.e[0],a,i),s+=1;while(!l&&c!==a.currentNode);s>1?(a.currentNode=c,u=null):u=l}else if("choice"===l){if(2!==o.e.length)throw"Choice with wrong # of options: "+o.e.length;c=a.currentNode,"empty"===o.e[0].name?((l=r(o.e[1],a,i,s))&&(a.currentNode=c),u=null):((l=t(o.e[0],a,i,s))&&(a.currentNode=c,l=r(o.e[1],a,i,s)),u=l)}else if("group"===l){if(2!==o.e.length)throw"Group with wrong # of members: "+o.e.length;u=r(o.e[0],a,i)||r(o.e[1],a,i)}else{if("interleave"!==l)throw l+" not allowed in nonEmptyPattern.";e:{c=o.e.length,s=[c];for(var d,m,f,p,g=c;g>0;){for(d=0,m=a.currentNode,u=0;c>u;u+=1)f=a.currentNode,!0!==s[u]&&s[u]!==f&&(p=o.e[u],(l=r(p,a,i))?(a.currentNode=f,void 0===s[u]&&(s[u]=!1)):f===a.currentNode||"oneOrMore"===p.name||"choice"===p.name&&("oneOrMore"===p.e[0].name||"oneOrMore"===p.e[1].name)?(d+=1,s[u]=f):(d+=1,s[u]=!0));if(m===a.currentNode&&d===g){u=null;break e}if(0===d){for(u=0;c>u;u+=1)if(!1===s[u]){u=[new e("Interleave does not match.",i)];break e}u=null;break e}for(u=g=0;c>u;u+=1)!0!==s[u]&&(g+=1)}u=null}}return u},this.validate=function(e,n){e.currentNode=e.root;var r=t(o.e[0],e,e.root);n(r)},this.init=function(e,t){o=e,a=t}},xmldom.XPathIterator=function(){},xmldom.XPath=function(){function e(e,t,n){return-1!==e&&(t>e||-1===t)&&(n>e||-1===n)}function t(t){for(var n,o=[],r=0,a=t.length;a>r;){var i=t,s=a,l=o,u="",d=[],m=i.indexOf("[",r),f=i.indexOf("/",r),p=i.indexOf("=",r);if(e(f,m,p)?(u=i.substring(r,f),r=f+1):e(m,f,p)?(u=i.substring(r,m),r=c(i,m,d)):e(p,f,m)?(u=i.substring(r,p),r=p):(u=i.substring(r,s),r=s),l.push({location:u,predicates:d}),a>r&&"="===t[r]){if(n=t.substring(r+1,a),2<n.length&&("'"===n[0]||'"'===n[0]))n=n.slice(1,n.length-1);else try{n=parseInt(n,10)}catch(g){}r=a}}return{steps:o,value:n}}function n(){var e,t=!1;this.setNode=function(t){e=t},this.reset=function(){t=!1},this.next=function(){var n=t?null:e;return t=!0,n}}function o(e,t,n){this.reset=function(){e.reset()},this.next=function(){for(var o=e.next();o&&!(o=o.getAttributeNodeNS(t,n));)o=e.next();return o}}function r(e,t){var n=e.next(),o=null;this.reset=function(){e.reset(),n=e.next(),o=null},this.next=function(){for(;n;){if(o)if(t&&o.firstChild)o=o.firstChild;else{for(;!o.nextSibling&&o!==n;)o=o.parentNode;o===n?n=e.next():o=o.nextSibling}else do(o=n.firstChild)||(n=e.next());while(n&&!o);if(o&&o.nodeType===Node.ELEMENT_NODE)return o}return null}}function a(e,t){this.reset=function(){e.reset()},this.next=function(){for(var n=e.next();n&&!t(n);)n=e.next();return n}}function i(e,t,n){t=t.split(":",2);var o=n(t[0]),r=t[1];return new a(e,function(e){return e.localName===r&&e.namespaceURI===o})}function s(e,t,o){var r=new n,i=u(r,t,o),s=t.value;return void 0===s?new a(e,function(e){return r.setNode(e),i.reset(),i.next()}):new a(e,function(e){return r.setNode(e),i.reset(),(e=i.next())&&e.nodeValue===s})}function l(e,o,r){var a=e.ownerDocument,i=[],s=null;if(a&&a.evaluate)for(r=a.evaluate(o,e,r,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),s=r.iterateNext();null!==s;)s.nodeType===Node.ELEMENT_NODE&&i.push(s),s=r.iterateNext();else{for(i=new n,i.setNode(e),e=t(o),i=u(i,e,r),e=[],r=i.next();r;)e.push(r),r=i.next();i=e}return i}var u,c;return c=function(e,n,o){for(var r=n,a=e.length,i=0;a>r;)"]"===e[r]?(i-=1,0>=i&&o.push(t(e.substring(n,r)))):"["===e[r]&&(0>=i&&(n=r+1),i+=1),r+=1;return r},xmldom.XPathIterator.prototype.next=function(){},xmldom.XPathIterator.prototype.reset=function(){},u=function(e,t,n){var a,l,u,c;for(a=0;a<t.steps.length;a+=1)for(u=t.steps[a],l=u.location,""===l?e=new r(e,!1):"@"===l[0]?(c=l.slice(1).split(":",2),e=new o(e,n(c[0]),c[1])):"."!==l&&(e=new r(e,!1),-1!==l.indexOf(":")&&(e=i(e,l,n))),l=0;l<u.predicates.length;l+=1)c=u.predicates[l],e=s(e,c,n);return e},xmldom.XPath=function(){this.getODFElementsWithXPath=l},xmldom.XPath}(),gui.AnnotationViewManager=function(e,t,n){function o(e){var t=e.node,n=e.end;e=l.createRange(),n&&(e.setStart(t,t.childNodes.length),e.setEnd(n,0),n=u.getTextNodes(e,!1),n.forEach(function(e){var n=l.createElement("span");n.className="annotationHighlight",n.setAttribute("annotation",t.getAttributeNS(odf.Namespaces.officens,"name")),e.parentNode.insertBefore(n,e),n.appendChild(e)})),e.detach()}function r(t){var o=e.getSizer();t?(n.style.display="inline-block",o.style.paddingRight=c.getComputedStyle(n).width):(n.style.display="none",o.style.paddingRight=0),e.refreshSize()}function a(){s.sort(function(e,t){return e.node.compareDocumentPosition(t.node)===Node.DOCUMENT_POSITION_FOLLOWING?-1:1})}function i(){var t;for(t=0;t<s.length;t+=1){var o=s[t],r=o.node.parentNode,a=r.nextSibling,i=a.nextSibling,u=r.parentNode,d=0,m=s[s.indexOf(o)-1],f=void 0,o=o.node.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0],d=void 0,d=e.getZoomLevel();r.style.left=(n.getBoundingClientRect().left-u.getBoundingClientRect().left)/d+"px",r.style.width=n.getBoundingClientRect().width/d+"px",a.style.width=parseFloat(r.style.left)-30+"px",m&&(f=m.node.parentNode.getBoundingClientRect(),r.style.top=20>=(u.getBoundingClientRect().top-f.bottom)/d?Math.abs(u.getBoundingClientRect().top-f.bottom)/d+20+"px":"0px"),i.style.left=a.getBoundingClientRect().width/d+"px";var a=i.style,u=i.getBoundingClientRect().left/d,m=i.getBoundingClientRect().top/d,f=r.getBoundingClientRect().left/d,p=r.getBoundingClientRect().top/d,g=0,h=0,g=f-u,g=g*g,h=p-m,h=h*h,u=Math.sqrt(g+h);a.width=u+"px",d=Math.asin((r.getBoundingClientRect().top-i.getBoundingClientRect().top)/(d*parseFloat(i.style.width))),i.style.transform="rotate("+d+"rad)",i.style.MozTransform="rotate("+d+"rad)",i.style.WebkitTransform="rotate("+d+"rad)",i.style.msTransform="rotate("+d+"rad)",o&&(d=c.getComputedStyle(o,":before").content)&&"none"!==d&&(d=d.substring(1,d.length-1),o.firstChild?o.firstChild.nodeValue=d:o.appendChild(l.createTextNode(d)))}}var s=[],l=t.ownerDocument,u=new odf.OdfUtils,c=runtime.getWindow();runtime.assert(Boolean(c),"Expected to be run in an environment which has a global window, like a browser."),this.rerenderAnnotations=i,this.addAnnotation=function(e){r(!0),s.push({node:e.node,end:e.end}),a();var t=l.createElement("div"),n=l.createElement("div"),u=l.createElement("div"),c=l.createElement("div"),d=l.createElement("div"),m=e.node;t.className="annotationWrapper",m.parentNode.insertBefore(t,m),n.className="annotationNote",n.appendChild(m),d.className="annotationRemoveButton",n.appendChild(d),u.className="annotationConnector horizontal",c.className="annotationConnector angular",t.appendChild(n),t.appendChild(u),t.appendChild(c),e.end&&o(e),i()},this.forgetAnnotations=function(){for(;s.length;){var e=s[0],t=s.indexOf(e),n=e.node,o=n.parentNode.parentNode;for("div"===o.localName&&(o.parentNode.insertBefore(n,o),o.parentNode.removeChild(o)),e=e.node.getAttributeNS(odf.Namespaces.officens,"name"),e=l.querySelectorAll('span.annotationHighlight[annotation="'+e+'"]'),o=n=void 0,n=0;n<e.length;n+=1){for(o=e[n];o.firstChild;)o.parentNode.insertBefore(o.firstChild,o);o.parentNode.removeChild(o)}-1!==t&&s.splice(t,1),0===s.length&&r(!1)}}},odf.OdfNodeFilter=function(){this.acceptNode=function(e){return"http://www.w3.org/1999/xhtml"===e.namespaceURI?NodeFilter.FILTER_SKIP:e.namespaceURI&&e.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},odf.Namespaces=function(){function e(e){return n[e]||null}var t,n={draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",dc:"http://purl.org/dc/elements/1.1/",webodf:"urn:webodf"};return e.lookupNamespaceURI=e,t=function(){},t.forEachPrefix=function(e){for(var t in n)n.hasOwnProperty(t)&&e(t,n[t])},t.resolvePrefix=e,t.namespaceMap=n,t.drawns="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",t.fons="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",t.officens="urn:oasis:names:tc:opendocument:xmlns:office:1.0",t.presentationns="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",t.stylens="urn:oasis:names:tc:opendocument:xmlns:style:1.0",t.svgns="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",t.tablens="urn:oasis:names:tc:opendocument:xmlns:table:1.0",t.textns="urn:oasis:names:tc:opendocument:xmlns:text:1.0",t.dr3dns="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",t.numberns="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",t.xlinkns="http://www.w3.org/1999/xlink",t.xmlns="http://www.w3.org/XML/1998/namespace",t.dcns="http://purl.org/dc/elements/1.1/",t.webodfns="urn:webodf",t}(),runtime.loadClass("xmldom.XPath"),odf.StyleInfo=function(){function e(t,n){for(var o,r=u[t.localName],a=r&&r[t.namespaceURI],i=a?a.length:0,r=0;i>r;r+=1)(o=t.getAttributeNS(a[r].ns,a[r].localname))&&t.setAttributeNS(a[r].ns,d[a[r].ns]+a[r].localname,n+o);for(r=t.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&(a=r,e(a,n)),r=r.nextSibling}function t(e,n){for(var o,r=u[e.localName],a=r&&r[e.namespaceURI],i=a?a.length:0,r=0;i>r;r+=1)(o=e.getAttributeNS(a[r].ns,a[r].localname))&&(o=o.replace(n,""),e.setAttributeNS(a[r].ns,d[a[r].ns]+a[r].localname,o));for(r=e.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&(a=r,t(a,n)),r=r.nextSibling}function n(e,t){var n,o,r,a=u[e.localName],i=(a=a&&a[e.namespaceURI])?a.length:0;for(r=0;i>r;r+=1)(n=e.getAttributeNS(a[r].ns,a[r].localname))&&(t=t||{},o=a[r].keyname,o=t[o]=t[o]||{},o[n]=1);return t}function o(e,t){var r,a;for(n(e,t),r=e.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&(a=r,o(a,t)),r=r.nextSibling}function r(e,t,n){this.key=e,this.name=t,this.family=n,this.requires={}}function a(e,t,n){var o=e+'"'+t,a=n[o];return a||(a=n[o]=new r(o,e,t)),a}function i(e,t,n){var o,r=u[e.localName],s=(r=r&&r[e.namespaceURI])?r.length:0,l=e.getAttributeNS(c,"name"),d=e.getAttributeNS(c,"family");if(l&&d&&(t=a(l,d,n)),t)for(l=0;s>l;l+=1)(d=e.getAttributeNS(r[l].ns,r[l].localname))&&(o=r[l].keyname,d=a(d,o,n),t.requires[d.key]=d);for(l=e.firstChild;l;)l.nodeType===Node.ELEMENT_NODE&&(e=l,i(e,t,n)),l=l.nextSibling;return n}function s(e,t){var n=t[e.family];n||(n=t[e.family]={}),n[e.name]=1,Object.keys(e.requires).forEach(function(n){s(e.requires[n],t)})}function l(e,t){var n=i(e,null,{});Object.keys(n).forEach(function(e){e=n[e];var o=t[e.family];o&&o.hasOwnProperty(e.name)&&s(e,t)})}var u,c="urn:oasis:names:tc:opendocument:xmlns:style:1.0",d={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:","urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},m={text:[{ens:c,en:"tab-stop",ans:c,a:"leader-text-style"},{ens:c,en:"drop-cap",ans:c,a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"notes-configuration",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"citation-body-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"notes-configuration",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"citation-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"a",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"alphabetical-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"linenumbering-configuration",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"list-level-style-number",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"ruby-text",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"span",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"a",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"visited-style-name"},{ens:c,en:"text-properties",ans:c,a:"text-line-through-text-style"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"alphabetical-index-source",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"main-entry-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-bibliography",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-chapter",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-link-end",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-link-start",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-page-number",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-span",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-tab-stop",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-entry-text",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-title-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"list-level-style-bullet",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"outline-level-style",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"}],paragraph:[{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"caption",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"circle",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"connector",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"control",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"custom-shape",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"ellipse",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"frame",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"line",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"measure",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"path",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polyline",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"rect",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"regular-polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",en:"annotation",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"text-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",en:"column",ans:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",a:"text-style-name"},{ens:c,en:"style",ans:c,a:"next-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"body",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"even-columns",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"even-rows",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"first-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"first-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"last-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"last-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"odd-columns",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"odd-rows",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"paragraph-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"notes-configuration",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"default-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"alphabetical-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"bibliography-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"h",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"illustration-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-source-style",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"object-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"p",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-of-content-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"user-index-entry-template",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:c,en:"page-layout-properties",ans:c,a:"register-truth-ref-style-name"}],chart:[{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"axis",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"chart",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"data-label",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"data-point",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"equation",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"error-indicator",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"floor",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"footer",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"grid",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"legend",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"mean-value",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"plot-area",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"regression-curve",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"series",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"stock-gain-marker",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"stock-loss-marker",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"stock-range-line",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"subtitle",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"title",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",en:"wall",ans:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",a:"style-name"}],section:[{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"alphabetical-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"bibliography",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"illustration-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"index-title",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"object-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"section",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-of-content",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"user-index",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"}],ruby:[{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"ruby",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"}],table:[{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",en:"query",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",en:"table-representation",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"background",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"}],"table-column":[{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",en:"column",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"}],"table-row":[{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",en:"query",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"default-row-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",en:"table-representation",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"default-row-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"}],"table-cell":[{ens:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",
en:"column",ans:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",a:"default-cell-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"default-cell-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"default-cell-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"body",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"covered-table-cell",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"even-columns",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"covered-table-cell",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"even-columns",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"even-rows",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"first-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"first-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"last-column",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"last-row",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"odd-columns",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"odd-rows",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",en:"table-cell",ans:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",a:"style-name"}],graphic:[{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"cube",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"extrude",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"rotate",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"scene",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"sphere",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"caption",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"circle",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"connector",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"control",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"custom-shape",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"ellipse",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"frame",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"g",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"line",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"measure",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"page-thumbnail",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"path",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polyline",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"rect",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"regular-polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",en:"annotation",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"}],presentation:[{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"cube",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"extrude",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"rotate",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"scene",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",en:"sphere",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"caption",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"circle",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"connector",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"control",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"custom-shape",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"ellipse",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"frame",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"g",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"line",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"measure",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"page-thumbnail",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"path",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"polyline",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"rect",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"regular-polygon",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",en:"annotation",ans:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",a:"style-name"}],"drawing-page":[{ens:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",en:"page",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",en:"notes",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:c,en:"handout-master",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"},{ens:c,en:"master-page",ans:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",a:"style-name"}],"list-style":[{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"list",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"numbered-paragraph",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"list-item",ans:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",a:"style-override"},{ens:c,en:"style",ans:c,a:"list-style-name"}],data:[{ens:c,en:"style",ans:c,a:"data-style-name"},{ens:c,en:"style",ans:c,a:"percentage-data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",en:"date-time-decl",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"creation-date",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"creation-time",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"database-display",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"date",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"editing-duration",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"expression",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"meta-field",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"modification-date",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"modification-time",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"print-date",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"print-time",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"table-formula",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"time",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"user-defined",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"user-field-get",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"user-field-input",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"variable-get",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"variable-input",ans:c,a:"data-style-name"},{ens:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",en:"variable-set",ans:c,a:"data-style-name"}],"page-layout":[{ens:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",en:"notes",ans:c,a:"page-layout-name"},{ens:c,en:"handout-master",ans:c,a:"page-layout-name"},{ens:c,en:"master-page",ans:c,a:"page-layout-name"}]},f=new xmldom.XPath;this.UsedStyleList=function(e,t){var n={};this.uses=function(e){var t=e.localName,o=e.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","name")||e.getAttributeNS(c,"name");return e="style"===t?e.getAttributeNS(c,"family"):"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"===e.namespaceURI?"data":t,(e=n[e])?0<e[o]:!1},o(e,n),t&&l(t,n)},this.hasDerivedStyles=function(e,t,n){var o=t("style"),r=n.getAttributeNS(o,"name");return n=n.getAttributeNS(o,"family"),f.getODFElementsWithXPath(e,"//style:*[@style:parent-style-name='"+r+"'][@style:family='"+n+"']",t).length?!0:!1},this.prefixStyleNames=function(t,n,o){var r;if(t){for(r=t.firstChild;r;){if(r.nodeType===Node.ELEMENT_NODE){var a=r,i=n,s=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","name"),l=void 0;s?l="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":(s=a.getAttributeNS(c,"name"))&&(l=c),l&&a.setAttributeNS(l,d[l]+"name",i+s)}r=r.nextSibling}e(t,n),o&&e(o,n)}},this.removePrefixFromStyleNames=function(e,n,o){var r=RegExp("^"+n);if(e){for(n=e.firstChild;n;){if(n.nodeType===Node.ELEMENT_NODE){var a=n,i=r,s=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","name"),l=void 0;s?l="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":(s=a.getAttributeNS(c,"name"))&&(l=c),l&&(s=s.replace(i,""),a.setAttributeNS(l,d[l]+"name",s))}n=n.nextSibling}t(e,r),o&&t(o,r)}},this.determineStylesForNode=n,u=function(e){var t,n,o,r,a,i,s={};for(t in e)if(e.hasOwnProperty(t))for(r=e[t],o=r.length,n=0;o>n;n+=1)a=r[n],i=s[a.en]=s[a.en]||{},i=i[a.ens]=i[a.ens]||[],i.push({ns:a.ans,localname:a.a,keyname:t});return s}(m)},runtime.loadClass("core.DomUtils"),odf.OdfUtils=function(){function e(e){var t=e&&e.localName;return("p"===t||"h"===t)&&e.namespaceURI===h}function t(t){for(;t&&!e(t);)t=t.parentNode;return t}function n(e){return/^[ \t\r\n]+$/.test(e)}function o(e){var t=e&&e.localName;return/^(span|p|h|a|meta)$/.test(t)&&e.namespaceURI===h||"span"===t&&"annotationHighlight"===e.className?!0:!1}function r(e){var t,n=e&&e.localName,o=!1;return n&&(t=e.namespaceURI,t===h?o="s"===n||"tab"===n||"line-break"===n:t===y&&(o="frame"===n&&"as-char"===e.getAttributeNS(h,"anchor-type"))),o}function a(e){for(;null!==e.firstChild&&o(e);)e=e.firstChild;return e}function i(e){for(;null!==e.lastChild&&o(e);)e=e.lastChild;return e}function s(t){for(;!e(t)&&null===t.previousSibling;)t=t.parentNode;return e(t)?null:i(t.previousSibling)}function l(t){for(;!e(t)&&null===t.nextSibling;)t=t.parentNode;return e(t)?null:a(t.nextSibling)}function u(e){for(var t=!1;e;)if(e.nodeType===Node.TEXT_NODE){if(0!==e.length)return!n(e.data.substr(e.length-1,1));e=s(e)}else r(e)?(t=!0,e=null):e=s(e);return t}function c(e){var t=!1;for(e=e&&a(e);e;){if(e.nodeType===Node.TEXT_NODE&&0<e.length&&!n(e.data)){t=!0;break}if(r(e)){t=!0;break}e=l(e)}return t}function d(e,t){return n(e.data.substr(t))?!c(l(e)):!1}function m(e,t){var o,a=e.data;return!n(a[t])||r(e.parentNode)?!1:(t>0?n(a[t-1])||(o=!0):u(s(e))&&(o=!0),!0===o?d(e,t)?!1:!0:!1)}function f(e){return(e=/-?([0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(e))?{value:parseFloat(e[1]),unit:e[3]}:null}function p(e){return(e=f(e))&&"%"!==e.unit?null:e}function g(e){switch(e.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(e.localName){case"note-body":case"ruby-text":return!1}break;case odf.Namespaces.officens:switch(e.localName){case"annotation":case"binary-data":case"event-listeners":return!1}break;default:switch(e.localName){case"editinfo":return!1}}return!0}var h="urn:oasis:names:tc:opendocument:xmlns:text:1.0",y="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",b=/^\s*$/,x=new core.DomUtils;this.isParagraph=e,this.getParagraphElement=t,this.isWithinTrackedChanges=function(e,t){for(;e&&e!==t;){if(e.namespaceURI===h&&"tracked-changes"===e.localName)return!0;e=e.parentNode}return!1},this.isListItem=function(e){return"list-item"===(e&&e.localName)&&e.namespaceURI===h},this.isODFWhitespace=n,this.isGroupingElement=o,this.isCharacterElement=r,this.firstChild=a,this.lastChild=i,this.previousNode=s,this.nextNode=l,this.scanLeftForNonWhitespace=u,this.lookLeftForCharacter=function(e){var t;return t=0,e.nodeType===Node.TEXT_NODE&&0<e.length?(t=e.data,t=n(t.substr(t.length-1,1))?1===t.length?u(s(e))?2:0:n(t.substr(t.length-2,1))?0:2:1):r(e)&&(t=1),t},this.lookRightForCharacter=function(e){var t=!1;return e&&e.nodeType===Node.TEXT_NODE&&0<e.length?t=!n(e.data.substr(0,1)):r(e)&&(t=!0),t},this.scanLeftForAnyCharacter=function(e){var t=!1;for(e=e&&i(e);e;){if(e.nodeType===Node.TEXT_NODE&&0<e.length&&!n(e.data)){t=!0;break}if(r(e)){t=!0;break}e=s(e)}return t},this.scanRightForAnyCharacter=c,this.isTrailingWhitespace=d,this.isSignificantWhitespace=m,this.getFirstNonWhitespaceChild=function(e){for(e=e&&e.firstChild;e&&e.nodeType===Node.TEXT_NODE&&b.test(e.nodeValue);)e=e.nextSibling;return e},this.parseLength=f,this.parseFoFontSize=function(e){var t;return t=(t=f(e))&&(0>=t.value||"%"===t.unit)?null:t,t||p(e)},this.parseFoLineHeight=function(e){var t;return t=(t=f(e))&&(0>t.value||"%"===t.unit)?null:t,t||p(e)},this.getImpactedParagraphs=function(t){var n=t.commonAncestorContainer,o=[];for(n.nodeType===Node.ELEMENT_NODE&&(o=x.getElementsByTagNameNS(n,h,"p").concat(x.getElementsByTagNameNS(n,h,"h")));n&&!e(n);)n=n.parentNode;return n&&o.push(n),o.filter(function(e){return x.rangeIntersectsNode(t,e)})},this.getTextNodes=function(e,o){var r,a=e.startContainer.ownerDocument.createRange();return r=x.getNodesInRange(e,function(r){if(a.selectNodeContents(r),r.nodeType===Node.TEXT_NODE){if(o&&x.rangesIntersect(e,a)||x.containsRange(e,a))return Boolean(t(r)&&(!n(r.textContent)||m(r,0)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}else if(x.rangesIntersect(e,a)&&g(r))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_REJECT}),a.detach(),r},this.getTextElements=function(e,a){var i,s=e.startContainer.ownerDocument.createRange();return i=x.getNodesInRange(e,function(i){var l=i.nodeType;if(s.selectNodeContents(i),l===Node.TEXT_NODE){if(x.containsRange(e,s)&&(a||Boolean(t(i)&&(!n(i.textContent)||m(i,0)))))return NodeFilter.FILTER_ACCEPT}else if(r(i)){if(x.containsRange(e,s))return NodeFilter.FILTER_ACCEPT}else if(g(i)||o(i))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_REJECT}),s.detach(),i},this.getParagraphElements=function(t){var n,r=t.startContainer.ownerDocument.createRange();return n=x.getNodesInRange(t,function(n){if(r.selectNodeContents(n),e(n)){if(x.rangesIntersect(t,r))return NodeFilter.FILTER_ACCEPT}else if(g(n)||o(n))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_REJECT}),r.detach(),n}},runtime.loadClass("odf.OdfUtils"),odf.TextSerializer=function(){function e(o){var r,a="",i=t.filter?t.filter.acceptNode(o):NodeFilter.FILTER_ACCEPT,s=o.nodeType;if(i===NodeFilter.FILTER_ACCEPT||i===NodeFilter.FILTER_SKIP)for(r=o.firstChild;r;)a+=e(r),r=r.nextSibling;return i===NodeFilter.FILTER_ACCEPT&&(s===Node.ELEMENT_NODE&&n.isParagraph(o)?a+="\n":s===Node.TEXT_NODE&&o.textContent&&(a+=o.textContent)),a}var t=this,n=new odf.OdfUtils;this.filter=null,this.writeToString=function(t){return t?e(t):""}},runtime.loadClass("core.DomUtils"),runtime.loadClass("core.LoopWatchDog"),runtime.loadClass("odf.Namespaces"),odf.TextStyleApplicator=function(e,t,n){function o(e){function n(e,t){return"object"==typeof e&&"object"==typeof t?Object.keys(e).every(function(o){return n(e[o],t[o])}):e===t}this.isStyleApplied=function(o){return o=t.getAppliedStylesForElement(o),n(e,o)}}function r(o){var r={};this.applyStyleToContainer=function(a){var u;u=a.getAttributeNS(i,"style-name");var c=a.ownerDocument;if(u=u||"",!r.hasOwnProperty(u)){var d,m=u,f=u;f?(d=t.getStyleElement(f,"text"),d.parentNode===n?c=d.cloneNode(!0):(c=c.createElementNS(s,"style:style"),c.setAttributeNS(s,"style:parent-style-name",f),c.setAttributeNS(s,"style:family","text"),c.setAttributeNS(l,"scope","document-content"))):(c=c.createElementNS(s,"style:style"),c.setAttributeNS(s,"style:family","text"),c.setAttributeNS(l,"scope","document-content")),t.updateStyle(c,o,e),n.appendChild(c),r[m]=c}u=r[u].getAttributeNS(s,"name"),a.setAttributeNS(i,"text:style-name",u)}}var a=new core.DomUtils,i=odf.Namespaces.textns,s=odf.Namespaces.stylens,l="urn:webodf:names:scope";this.applyStyle=function(e,t,n){var s,l,u,c,d={};runtime.assert(n&&n["style:text-properties"],"applyStyle without any text properties"),d["style:text-properties"]=n["style:text-properties"],u=new r(d),c=new o(d),e.forEach(function(e){if(s=c.isStyleApplied(e),!1===s){var n,o=e.ownerDocument,r=e.parentNode,d=e,m=new core.LoopWatchDog(1e3);for("span"===r.localName&&r.namespaceURI===i?(e.previousSibling&&!a.rangeContainsNode(t,e.previousSibling)?(o=r.cloneNode(!1),r.parentNode.insertBefore(o,r.nextSibling)):o=r,n=!0):(o=o.createElementNS(i,"text:span"),r.insertBefore(o,e),n=!1);d&&(d===e||a.rangeContainsNode(t,d));)m.check(),r=d.nextSibling,d.parentNode!==o&&o.appendChild(d),d=r;if(d&&n)for(e=o.cloneNode(!1),o.parentNode.insertBefore(e,o.nextSibling);d;)m.check(),r=d.nextSibling,e.appendChild(d),d=r;l=o,u.applyStyleToContainer(l)}})}},runtime.loadClass("odf.Namespaces"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("xmldom.XPath"),runtime.loadClass("core.CSSUnits"),odf.Style2CSS=function(){function e(e){var t,n,o={};if(!e)return o;for(e=e.firstChild;e;)(n=e.namespaceURI!==y||"style"!==e.localName&&"default-style"!==e.localName?e.namespaceURI===v&&"list-style"===e.localName?"list":e.namespaceURI!==y||"page-layout"!==e.localName&&"default-page-layout"!==e.localName?void 0:"page":e.getAttributeNS(y,"family"))&&((t=e.getAttributeNS&&e.getAttributeNS(y,"name"))||(t=""),n=o[n]=o[n]||{},n[t]=e),e=e.nextSibling;return o}function t(e,n){if(!n||!e)return null;if(e[n])return e[n];var o,r;for(o in e)if(e.hasOwnProperty(o)&&(r=t(e[o].derivedStyles,n)))return r;return null}function n(e,o,r){var a,i,s=o[e];s&&(a=s.getAttributeNS(y,"parent-style-name"),i=null,a&&(i=t(r,a),!i&&o[a]&&(n(a,o,r),i=o[a],o[a]=null)),i?(i.derivedStyles||(i.derivedStyles={}),i.derivedStyles[e]=s):r[e]=s)}function o(e,t){for(var o in e)e.hasOwnProperty(o)&&(n(o,e,t),e[o]=null)}function r(e,t){var n,o=S[e];return null===o?null:(n=t?"["+o+'|style-name="'+t+'"]':"["+o+"|style-name]","presentation"===o&&(o="draw",n=t?'[presentation|style-name="'+t+'"]':"[presentation|style-name]"),o+"|"+w[e].join(n+","+o+"|")+n)}function a(e,t,n){var o,i,s=[];s.push(r(e,t));for(o in n.derivedStyles)if(n.derivedStyles.hasOwnProperty(o))for(i in t=a(e,o,n.derivedStyles[o]))t.hasOwnProperty(i)&&s.push(t[i]);return s}function i(e,t,n){if(!e)return null;for(e=e.firstChild;e;){if(e.namespaceURI===t&&e.localName===n)return t=e;e=e.nextSibling}return null}function s(e,t){var n,o,r="";for(n in t)if(t.hasOwnProperty(n)&&(n=t[n],o=e.getAttributeNS(n[0],n[1]))){if(o=o.trim(),U.hasOwnProperty(n[1])){var a=o.indexOf(" "),i=void 0,s=void 0;-1!==a?(i=o.substring(0,a),s=o.substring(a)):(i=o,s=""),(i=B.parseLength(i))&&"pt"===i.unit&&.75>i.value&&(o="0.75pt"+s)}n[2]&&(r+=n[2]+":"+o+";")}return r}function l(e){return(e=i(e,y,"text-properties"))?B.parseFoFontSize(e.getAttributeNS(h,"font-size")):null}function u(e){return e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,o){return t+t+n+n+o+o}),(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function c(e,t,n,o){t='text|list[text|style-name="'+t+'"]';var r,a=n.getAttributeNS(v,"level");n=B.getFirstNonWhitespaceChild(n),n=B.getFirstNonWhitespaceChild(n);var i;for(n&&(r=n.attributes,i=r["fo:text-indent"]?r["fo:text-indent"].value:void 0,r=r["fo:margin-left"]?r["fo:margin-left"].value:void 0),i||(i="-0.6cm"),n="-"===i.charAt(0)?i.substring(1):"-"+i,a=a&&parseInt(a,10);a>1;)t+=" > text|list-item > text|list",a-=1;a=t+" > text|list-item > *:not(text|list):first-child",void 0!==r&&(r=a+"{margin-left:"+r+";}",e.insertRule(r,e.cssRules.length)),o=t+" > text|list-item > *:not(text|list):first-child:before{"+o+";",o+="counter-increment:list;",o+="margin-left:"+i+";",o+="width:"+n+";",o+="display:inline-block}";try{e.insertRule(o,e.cssRules.length)}catch(s){throw s}}function d(e,t,n,o){if("list"===t)for(var r,b,S=o.firstChild;S;){if(S.namespaceURI===v)if(r=S,"list-level-style-number"===S.localName){var w=r;b=w.getAttributeNS(y,"num-format");var U=w.getAttributeNS(y,"num-suffix"),X={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"},w=w.getAttributeNS(y,"num-prefix")||"",w=X.hasOwnProperty(b)?w+(" counter(list, "+X[b]+")"):b?w+("'"+b+"';"):w+" ''";U&&(w+=" '"+U+"'"),b="content: "+w+";",c(e,n,r,b)}else"list-level-style-image"===S.localName?(b="content: none;",c(e,n,r,b)):"list-level-style-bullet"===S.localName&&(b="content: '"+r.getAttributeNS(v,"bullet-char")+"';",c(e,n,r,b));S=S.nextSibling}else if("page"===t){if(U=r=n="",S=o.getElementsByTagNameNS(y,"page-layout-properties")[0],r=S.parentNode.parentNode.parentNode.masterStyles,U="",n+=s(S,F),b=S.getElementsByTagNameNS(y,"background-image"),0<b.length&&(U=b.item(0).getAttributeNS(N,"href"))&&(n+="background-image: url('odfkit:"+U+"');",b=b.item(0),n+=s(b,T)),"presentation"===m){if(r)for(b=r.getElementsByTagNameNS(y,"master-page"),X=0;X<b.length;X+=1)if(b[X].getAttributeNS(y,"page-layout-name")===S.parentNode.getAttributeNS(y,"name")){U=b[X].getAttributeNS(y,"name"),r="draw|page[draw|master-page-name="+U+"] {"+n+"}",U="office|body, draw|page[draw|master-page-name="+U+"] {"+s(S,k)+" }";try{e.insertRule(r,e.cssRules.length),e.insertRule(U,e.cssRules.length)}catch(W){throw W}}}else if("text"===m){r="office|text {"+n+"}",U="office|body {width: "+S.getAttributeNS(h,"page-width")+";}";try{e.insertRule(r,e.cssRules.length),e.insertRule(U,e.cssRules.length)}catch(H){throw H}}}else{if(n=a(t,n,o).join(","),S="",r=i(o,y,"text-properties")){var z,X=r;if(b=z="",U=1,r=""+s(X,E),w=X.getAttributeNS(y,"text-underline-style"),"solid"===w&&(z+=" underline"),w=X.getAttributeNS(y,"text-line-through-style"),"solid"===w&&(z+=" line-through"),z.length&&(r+="text-decoration:"+z+";"),(z=X.getAttributeNS(y,"font-name")||X.getAttributeNS(h,"font-family"))&&(w=M[z],r+="font-family: "+(w||z)+", sans-serif;"),w=X.parentNode,X=l(w)){for(;w;){if(X=l(w)){if("%"!==X.unit){b="font-size: "+X.value*U+X.unit+";";break}U*=X.value/100}X=w,z=w="",w=null,"default-style"===X.localName?w=null:(w=X.getAttributeNS(y,"parent-style-name"),z=X.getAttributeNS(y,"family"),w=L.getODFElementsWithXPath(f,w?"//style:*[@style:name='"+w+"'][@style:family='"+z+"']":"//style:default-style[@style:family='"+z+"']",odf.Namespaces.resolvePrefix)[0])}b||(b="font-size: "+parseFloat(p)*U+_.getUnits(p)+";"),r+=b}S+=r}if((r=i(o,y,"paragraph-properties"))&&(b=r,r=""+s(b,O),U=b.getElementsByTagNameNS(y,"background-image"),0<U.length&&(X=U.item(0).getAttributeNS(N,"href"))&&(r+="background-image: url('odfkit:"+X+"');",U=U.item(0),r+=s(U,T)),(b=b.getAttributeNS(h,"line-height"))&&"normal"!==b&&(b=B.parseFoLineHeight(b),r="%"!==b.unit?r+("line-height: "+b.value+b.unit+";"):r+("line-height: "+b.value/100+";")),S+=r),(r=i(o,y,"graphic-properties"))&&(X=r,r=""+s(X,D),b=X.getAttributeNS(g,"opacity"),U=X.getAttributeNS(g,"fill"),X=X.getAttributeNS(g,"fill-color"),"solid"===U||"hatch"===U?X&&"none"!==X?(b=isNaN(parseFloat(b))?1:parseFloat(b)/100,(X=u(X))&&(r+="background-color: rgba("+X.r+","+X.g+","+X.b+","+b+");")):r+="background: none;":"none"===U&&(r+="background: none;"),S+=r),(r=i(o,y,"drawing-page-properties"))&&(b=""+s(r,D),"true"===r.getAttributeNS(C,"background-visible")&&(b+="background: none;"),S+=b),(r=i(o,y,"table-cell-properties"))&&(r=""+s(r,A),S+=r),(r=i(o,y,"table-row-properties"))&&(r=""+s(r,P),S+=r),(r=i(o,y,"table-column-properties"))&&(r=""+s(r,R),S+=r),(r=i(o,y,"table-properties"))&&(b=r,r=""+s(b,I),b=b.getAttributeNS(x,"border-model"),"collapsing"===b?r+="border-collapse:collapse;":"separating"===b&&(r+="border-collapse:separate;"),S+=r),0!==S.length)try{e.insertRule(n+"{"+S+"}",e.cssRules.length)}catch(V){throw V}}for(var j in o.derivedStyles)o.derivedStyles.hasOwnProperty(j)&&d(e,t,j,o.derivedStyles[j])}var m,f,p,g=odf.Namespaces.drawns,h=odf.Namespaces.fons,y=odf.Namespaces.stylens,b=odf.Namespaces.svgns,x=odf.Namespaces.tablens,v=odf.Namespaces.textns,N=odf.Namespaces.xlinkns,C=odf.Namespaces.presentationns,S={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},w={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),list:["list-item"]},E=[[h,"color","color"],[h,"background-color","background-color"],[h,"font-weight","font-weight"],[h,"font-style","font-style"]],T=[[y,"repeat","background-repeat"]],O=[[h,"background-color","background-color"],[h,"text-align","text-align"],[h,"text-indent","text-indent"],[h,"padding","padding"],[h,"padding-left","padding-left"],[h,"padding-right","padding-right"],[h,"padding-top","padding-top"],[h,"padding-bottom","padding-bottom"],[h,"border-left","border-left"],[h,"border-right","border-right"],[h,"border-top","border-top"],[h,"border-bottom","border-bottom"],[h,"margin","margin"],[h,"margin-left","margin-left"],[h,"margin-right","margin-right"],[h,"margin-top","margin-top"],[h,"margin-bottom","margin-bottom"],[h,"border","border"]],D=[[h,"background-color","background-color"],[h,"min-height","min-height"],[g,"stroke","border"],[b,"stroke-color","border-color"],[b,"stroke-width","border-width"],[h,"border","border"],[h,"border-left","border-left"],[h,"border-right","border-right"],[h,"border-top","border-top"],[h,"border-bottom","border-bottom"]],A=[[h,"background-color","background-color"],[h,"border-left","border-left"],[h,"border-right","border-right"],[h,"border-top","border-top"],[h,"border-bottom","border-bottom"],[h,"border","border"]],R=[[y,"column-width","width"]],P=[[y,"row-height","height"],[h,"keep-together",null]],I=[[y,"width","width"],[h,"margin-left","margin-left"],[h,"margin-right","margin-right"],[h,"margin-top","margin-top"],[h,"margin-bottom","margin-bottom"]],F=[[h,"background-color","background-color"],[h,"padding","padding"],[h,"padding-left","padding-left"],[h,"padding-right","padding-right"],[h,"padding-top","padding-top"],[h,"padding-bottom","padding-bottom"],[h,"border","border"],[h,"border-left","border-left"],[h,"border-right","border-right"],[h,"border-top","border-top"],[h,"border-bottom","border-bottom"],[h,"margin","margin"],[h,"margin-left","margin-left"],[h,"margin-right","margin-right"],[h,"margin-top","margin-top"],[h,"margin-bottom","margin-bottom"]],k=[[h,"page-width","width"],[h,"page-height","height"]],U={
border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},M={},B=new odf.OdfUtils,L=new xmldom.XPath,_=new core.CSSUnits;this.style2css=function(t,n,r,a,i){for(var s,l,u,c;n.cssRules.length;)n.deleteRule(n.cssRules.length-1);if(s=null,a&&(s=a.ownerDocument,f=a.parentNode),i&&(s=i.ownerDocument,f=i.parentNode),s)for(c in odf.Namespaces.forEachPrefix(function(e,t){u="@namespace "+e+" url("+t+");";try{n.insertRule(u,n.cssRules.length)}catch(o){}}),M=r,m=t,p=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt",t=e(a),a=e(i),i={},S)if(S.hasOwnProperty(c))for(l in r=i[c]={},o(t[c],r),o(a[c],r),r)r.hasOwnProperty(l)&&d(n,c,l,r[l])}},runtime.loadClass("core.Base64"),runtime.loadClass("core.Zip"),runtime.loadClass("xmldom.LSSerializer"),runtime.loadClass("odf.StyleInfo"),runtime.loadClass("odf.Namespaces"),runtime.loadClass("odf.OdfNodeFilter"),odf.OdfContainer=function(){function e(e,t,n){for(e=e?e.firstChild:null;e;){if(e.localName===n&&e.namespaceURI===t)return e;e=e.nextSibling}return null}function t(e){var t,n=d.length;for(t=0;n>t;t+=1)if(e.namespaceURI===l&&e.localName===d[t])return t;return-1}function n(e,t){var n=new s.UsedStyleList(e,t),o=new odf.OdfNodeFilter;this.acceptNode=function(e){var r=o.acceptNode(e);return r===NodeFilter.FILTER_ACCEPT&&e.parentNode===t&&e.nodeType===Node.ELEMENT_NODE&&(r=n.uses(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT),r}}function o(e,t){var o=new n(e,t);this.acceptNode=function(e){var t=o.acceptNode(e);return t!==NodeFilter.FILTER_ACCEPT||!e.parentNode||e.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==e.parentNode.localName&&"tab"!==e.parentNode.localName||(t=NodeFilter.FILTER_REJECT),t}}function r(e,n){if(n){var o,r=t(n),a=e.firstChild;if(-1!==r){for(;a&&(o=t(a),!(-1!==o&&o>r));)a=a.nextSibling;e.insertBefore(n,a)}}}function a(e){this.OdfContainer=e}function i(e,t,n,o){var r=this;this.size=0,this.type=null,this.name=e,this.container=n,this.onchange=this.onreadystatechange=this.document=this.mimetype=this.url=null,this.EMPTY=0,this.LOADING=1,this.DONE=2,this.state=this.EMPTY,this.load=function(){null!==o&&(this.mimetype=t,o.loadAsDataURL(e,t,function(e,t){e&&runtime.log(e),r.url=t,r.onchange&&r.onchange(r),r.onstatereadychange&&r.onstatereadychange(r)}))}}var s=new odf.StyleInfo,l="urn:oasis:names:tc:opendocument:xmlns:office:1.0",u="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0",c="urn:webodf:names:scope",d="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),m=(new Date).getTime()+"_webodf_",f=new core.Base64;return a.prototype=new function(){},a.prototype.constructor=a,a.namespaceURI=l,a.localName="document",i.prototype.load=function(){},i.prototype.getUrl=function(){return this.data?"data:;base64,"+f.toBase64(this.data):null},odf.OdfContainer=function p(t,d){function f(e){for(var t,n=e.firstChild;n;)t=n.nextSibling,n.nodeType===Node.ELEMENT_NODE?f(n):n.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&e.removeChild(n),n=t}function g(e,t){for(var n=e&&e.firstChild;n;)n.nodeType===Node.ELEMENT_NODE&&n.setAttributeNS(c,"scope",t),n=n.nextSibling}function h(e,t){var n,o,r,a=null;if(e)for(a=e.cloneNode(!0),n=a.firstChild;n;)o=n.nextSibling,n.nodeType===Node.ELEMENT_NODE&&(r=n.getAttributeNS(c,"scope"))&&r!==t&&a.removeChild(n),n=o;return a}function y(e){var t,n=_.rootElement.ownerDocument;if(e){f(e.documentElement);try{t=n.importNode(e.documentElement,!0)}catch(o){}}return t}function b(e){_.state=e,_.onchange&&_.onchange(_),_.onstatereadychange&&_.onstatereadychange(_)}function x(t){L=null,_.rootElement=t,t.fontFaceDecls=e(t,l,"font-face-decls"),t.styles=e(t,l,"styles"),t.automaticStyles=e(t,l,"automatic-styles"),t.masterStyles=e(t,l,"master-styles"),t.body=e(t,l,"body"),t.meta=e(t,l,"meta")}function v(t){t=y(t);var n=_.rootElement;t&&"document-styles"===t.localName&&t.namespaceURI===l?(n.fontFaceDecls=e(t,l,"font-face-decls"),r(n,n.fontFaceDecls),n.styles=e(t,l,"styles"),r(n,n.styles),n.automaticStyles=e(t,l,"automatic-styles"),g(n.automaticStyles,"document-styles"),r(n,n.automaticStyles),n.masterStyles=e(t,l,"master-styles"),r(n,n.masterStyles),s.prefixStyleNames(n.automaticStyles,m,n.masterStyles)):b(p.INVALID)}function N(t){t=y(t);var n,o,a;if(t&&"document-content"===t.localName&&t.namespaceURI===l){if(n=_.rootElement,o=e(t,l,"font-face-decls"),n.fontFaceDecls&&o)for(a=o.firstChild;a;)n.fontFaceDecls.appendChild(a),a=o.firstChild;else o&&(n.fontFaceDecls=o,r(n,o));if(o=e(t,l,"automatic-styles"),g(o,"document-content"),n.automaticStyles&&o)for(a=o.firstChild;a;)n.automaticStyles.appendChild(a),a=o.firstChild;else o&&(n.automaticStyles=o,r(n,o));n.body=e(t,l,"body"),r(n,n.body)}else b(p.INVALID)}function C(t){t=y(t);var n;t&&"document-meta"===t.localName&&t.namespaceURI===l&&(n=_.rootElement,n.meta=e(t,l,"meta"),r(n,n.meta))}function S(t){t=y(t);var n;t&&"document-settings"===t.localName&&t.namespaceURI===l&&(n=_.rootElement,n.settings=e(t,l,"settings"),r(n,n.settings))}function w(e){e=y(e);var t;if(e&&"manifest"===e.localName&&e.namespaceURI===u)for(t=_.rootElement,t.manifest=e,e=t.manifest.firstChild;e;)e.nodeType===Node.ELEMENT_NODE&&"file-entry"===e.localName&&e.namespaceURI===u&&(X[e.getAttributeNS(u,"full-path")]=e.getAttributeNS(u,"media-type")),e=e.nextSibling}function E(e){var t,n,o=e.shift();o?(t=o[0],n=o[1],B.loadAsDOM(t,function(t,o){n(o),t||_.state===p.INVALID||E(e)})):b(p.DONE)}function T(e){var t="";return odf.Namespaces.forEachPrefix(function(e,n){t+=" xmlns:"+e+'="'+n+'"'}),'<?xml version="1.0" encoding="UTF-8"?><office:'+e+" "+t+' office:version="1.2">'}function O(){var e=new xmldom.LSSerializer,t=T("document-meta");return e.filter=new odf.OdfNodeFilter,t+=e.writeToString(_.rootElement.meta,odf.Namespaces.namespaceMap),t+"</office:document-meta>"}function D(e,t){var n=document.createElementNS(u,"manifest:file-entry");return n.setAttributeNS(u,"manifest:full-path",e),n.setAttributeNS(u,"manifest:media-type",t),n}function A(){var t,n=runtime.parseXML('<manifest:manifest xmlns:manifest="'+u+'"></manifest:manifest>'),o=e(n,u,"manifest"),r=new xmldom.LSSerializer;for(t in X)X.hasOwnProperty(t)&&o.appendChild(D(t,X[t]));return r.filter=new odf.OdfNodeFilter,'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+r.writeToString(n,odf.Namespaces.namespaceMap)}function R(){var e=new xmldom.LSSerializer,t=T("document-settings");return e.filter=new odf.OdfNodeFilter,t+=e.writeToString(_.rootElement.settings,odf.Namespaces.namespaceMap),t+"</office:document-settings>"}function P(){var e=odf.Namespaces.namespaceMap,t=new xmldom.LSSerializer,o=h(_.rootElement.automaticStyles,"document-styles"),r=_.rootElement.masterStyles&&_.rootElement.masterStyles.cloneNode(!0),a=T("document-styles");return s.removePrefixFromStyleNames(o,m,r),t.filter=new n(r,o),a+=t.writeToString(_.rootElement.fontFaceDecls,e),a+=t.writeToString(_.rootElement.styles,e),a+=t.writeToString(o,e),a+=t.writeToString(r,e),a+"</office:document-styles>"}function I(){var e=odf.Namespaces.namespaceMap,t=new xmldom.LSSerializer,n=h(_.rootElement.automaticStyles,"document-content"),r=T("document-content");return t.filter=new o(_.rootElement.body,n),r+=t.writeToString(n,e),r+=t.writeToString(_.rootElement.body,e),r+"</office:document-content>"}function F(e,t){runtime.loadXML(e,function(e,n){if(e)t(e);else{var o=y(n);o&&"document"===o.localName&&o.namespaceURI===l?(x(o),b(p.DONE)):b(p.INVALID)}})}function k(){function e(e,t){var n;t||(t=e),n=document.createElementNS(l,t),o[e]=n,o.appendChild(n)}var t=new core.Zip("",null),n=runtime.byteArrayFromString("application/vnd.oasis.opendocument.text","utf8"),o=_.rootElement,r=document.createElementNS(l,"text");return t.save("mimetype",n,!1,new Date),e("meta"),e("settings"),e("scripts"),e("fontFaceDecls","font-face-decls"),e("styles"),e("automaticStyles","automatic-styles"),e("masterStyles","master-styles"),e("body"),o.body.appendChild(r),b(p.DONE),t}function U(){var e,t=new Date;e=runtime.byteArrayFromString(R(),"utf8"),B.save("settings.xml",e,!0,t),e=runtime.byteArrayFromString(O(),"utf8"),B.save("meta.xml",e,!0,t),e=runtime.byteArrayFromString(P(),"utf8"),B.save("styles.xml",e,!0,t),e=runtime.byteArrayFromString(I(),"utf8"),B.save("content.xml",e,!0,t),e=runtime.byteArrayFromString(A(),"utf8"),B.save("META-INF/manifest.xml",e,!0,t)}function M(e,t){U(),B.writeAs(e,function(e){t(e)})}var B,L,_=this,X={};this.onstatereadychange=d,this.rootElement=this.state=this.onchange=null,this.setRootElement=x,this.getContentElement=function(){var e;return L||(e=_.rootElement.body,L=e.getElementsByTagNameNS(l,"text")[0]||e.getElementsByTagNameNS(l,"presentation")[0]||e.getElementsByTagNameNS(l,"spreadsheet")[0]),L},this.getDocumentType=function(){var e=_.getContentElement();return e&&e.localName},this.getPart=function(e){return new i(e,X[e],_,B)},this.getPartData=function(e,t){B.load(e,t)},this.createByteArray=function(e,t){U(),B.createByteArray(e,t)},this.saveAs=M,this.save=function(e){M(t,e)},this.getUrl=function(){return t},this.state=p.LOADING,this.rootElement=function(e){var t,n=document.createElementNS(e.namespaceURI,e.localName);e=new e;for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(a),B=t?new core.Zip(t,function(e,n){B=n,e?F(t,function(t){e&&(B.error=e+"\n"+t,b(p.INVALID))}):E([["styles.xml",v],["content.xml",N],["meta.xml",C],["settings.xml",S],["META-INF/manifest.xml",w]])}):k()},odf.OdfContainer.EMPTY=0,odf.OdfContainer.LOADING=1,odf.OdfContainer.DONE=2,odf.OdfContainer.INVALID=3,odf.OdfContainer.SAVING=4,odf.OdfContainer.MODIFIED=5,odf.OdfContainer.getContainer=function(e){return new odf.OdfContainer(e,null)},odf.OdfContainer}(),runtime.loadClass("core.Base64"),runtime.loadClass("xmldom.XPath"),runtime.loadClass("odf.OdfContainer"),odf.FontLoader=function(){function e(t,o,r,a,i){var s,l,u=0;for(l in t)if(t.hasOwnProperty(l)){if(u===r){s=l;break}u+=1}s?o.getPartData(t[s].href,function(l,u){if(l)runtime.log(l);else{var c="@font-face { font-family: '"+(t[s].family||s)+"'; src: url(data:application/x-font-ttf;charset=binary;base64,"+n.convertUTF8ArrayToBase64(u)+') format("truetype"); }';try{a.insertRule(c,a.cssRules.length)}catch(d){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(d)+"\nRule: "+c)}}e(t,o,r+1,a,i)}):i&&i()}var t=new xmldom.XPath,n=new core.Base64;return odf.FontLoader=function(){this.loadFonts=function(n,o){for(var r=n.rootElement.fontFaceDecls;o.cssRules.length;)o.deleteRule(o.cssRules.length-1);if(r){var a,i,s,l,u={};if(r)for(r=t.getODFElementsWithXPath(r,"style:font-face[svg:font-face-src]",odf.Namespaces.resolvePrefix),a=0;a<r.length;a+=1)i=r[a],s=i.getAttributeNS(odf.Namespaces.stylens,"name"),l=i.getAttributeNS(odf.Namespaces.svgns,"font-family"),i=t.getODFElementsWithXPath(i,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.resolvePrefix),0<i.length&&(i=i[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),u[s]={href:i,family:l});e(u,n,0,o)}}},odf.FontLoader}(),runtime.loadClass("core.Utils"),runtime.loadClass("odf.Namespaces"),runtime.loadClass("odf.OdfContainer"),runtime.loadClass("odf.StyleInfo"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("odf.TextStyleApplicator"),odf.Formatting=function(){function e(t,n){return Object.keys(n).forEach(function(o){try{t[o]=n[o].constructor===Object?e(t[o],n[o]):n[o]}catch(r){t[o]=n[o]}}),t}function t(e,t,n){var o,r;for(n=n||[l.rootElement.automaticStyles,l.rootElement.styles],o=n.shift();o;){for(o=o.firstChild;o;){if(o.nodeType===Node.ELEMENT_NODE&&(r=o.getAttributeNS(m,"name"),o.namespaceURI===m&&"style"===o.localName&&o.getAttributeNS(m,"family")===t&&r===e||"list-style"===t&&o.namespaceURI===f&&"list-style"===o.localName&&r===e||"data"===t&&o.namespaceURI===p&&r===e))return o;o=o.nextSibling}o=n.shift()}return null}function n(e){for(var t={},n=e.firstChild;n;){if(n.nodeType===Node.ELEMENT_NODE&&n.namespaceURI===m)for(t[n.nodeName]={},e=0;e<n.attributes.length;e+=1)t[n.nodeName][n.attributes[e].name]=n.attributes[e].value;n=n.nextSibling}return t}function o(e,t){Object.keys(t).forEach(function(n){var r=n.split(":"),a=r[1],i=odf.Namespaces.resolvePrefix(r[0]),r=t[n];"object"==typeof r&&Object.keys(r).length?(n=e.getElementsByTagNameNS(i,a)[0]||e.ownerDocument.createElementNS(i,n),e.appendChild(n),o(n,r)):e.setAttributeNS(i,n,r)})}function r(o){var r,a=l.rootElement.styles;r={};for(var i={},s=o;s;)r=n(s),i=e(r,i),s=(r=s.getAttributeNS(m,"parent-style-name"))?t(r,o.getAttributeNS(m,"family"),[a]):null;e:{for(o=o.getAttributeNS(m,"family"),a=l.rootElement.styles.firstChild;a;){if(a.nodeType===Node.ELEMENT_NODE&&a.namespaceURI===m&&"default-style"===a.localName&&a.getAttributeNS(m,"family")===o){s=a;break e}a=a.nextSibling}s=null}return s&&(r=n(s),i=e(r,i)),i}function a(e,t){for(var n,o=e.nodeType===Node.TEXT_NODE?e.parentNode:e,r=[],a="",i=!1;o;)!i&&g.isGroupingElement(o)&&(i=!0),(n=c.determineStylesForNode(o))&&r.push(n),o=o.parentNode;return i&&(r.forEach(function(e){Object.keys(e).forEach(function(t){Object.keys(e[t]).forEach(function(e){a+="|"+t+":"+e+"|"})})}),t&&(t[a]=r)),i?r:void 0}function i(n){var o={orderedStyles:[]};return n.forEach(function(n){Object.keys(n).forEach(function(a){var i,s,l=Object.keys(n[a])[0];(i=t(l,a))?(s=r(i),o=e(s,o),s=i.getAttributeNS(m,"display-name")):runtime.log("No style element found for '"+l+"' of family '"+a+"'"),o.orderedStyles.push({name:l,family:a,displayName:s})})}),o}function s(){var e,t=[];return[l.rootElement.automaticStyles,l.rootElement.styles].forEach(function(n){for(e=n.firstChild;e;)e.nodeType===Node.ELEMENT_NODE&&(e.namespaceURI===m&&"style"===e.localName||e.namespaceURI===f&&"list-style"===e.localName)&&t.push(e.getAttributeNS(m,"name")),e=e.nextSibling}),t}var l,u=this,c=new odf.StyleInfo,d=odf.Namespaces.svgns,m=odf.Namespaces.stylens,f=odf.Namespaces.textns,p=odf.Namespaces.numberns,g=new odf.OdfUtils,h=new core.Utils;this.setOdfContainer=function(e){l=e},this.getFontMap=function(){for(var e,t,n=l.rootElement.fontFaceDecls,o={},n=n&&n.firstChild;n;)n.nodeType===Node.ELEMENT_NODE&&(e=n.getAttributeNS(m,"name"))&&((t=n.getAttributeNS(d,"font-family"))||n.getElementsByTagNameNS(d,"font-face-uri")[0])&&(o[e]=t),n=n.nextSibling;return o},this.getAvailableParagraphStyles=function(){for(var e,t,n=l.rootElement.styles&&l.rootElement.styles.firstChild,o=[];n;)n.nodeType===Node.ELEMENT_NODE&&"style"===n.localName&&n.namespaceURI===m&&(t=n,e=t.getAttributeNS(m,"family"),"paragraph"===e&&(e=t.getAttributeNS(m,"name"),t=t.getAttributeNS(m,"display-name")||e,e&&t&&o.push({name:e,displayName:t}))),n=n.nextSibling;return o},this.isStyleUsed=function(e){var t;return t=c.hasDerivedStyles(l.rootElement,odf.Namespaces.resolvePrefix,e),e=new c.UsedStyleList(l.rootElement.styles).uses(e)||new c.UsedStyleList(l.rootElement.automaticStyles).uses(e)||new c.UsedStyleList(l.rootElement.body).uses(e),t||e},this.getStyleElement=t,this.getStyleAttributes=n,this.getInheritedStyleAttributes=r,this.getFirstNamedParentStyleNameOrSelf=function(e){var n,o=l.rootElement.automaticStyles,r=l.rootElement.styles;for(n=t(e,"paragraph",[o]);n;)e=n.getAttributeNS(m,"parent-style-name"),n=t(e,"paragraph",[o]);return(n=t(e,"paragraph",[r]))?e:null},this.hasParagraphStyle=function(e){return Boolean(t(e,"paragraph"))},this.getAppliedStyles=function(e){var t={},n=[];return e.forEach(function(e){a(e,t)}),Object.keys(t).forEach(function(e){n.push(i(t[e]))}),n},this.getAppliedStylesForElement=function(e){return(e=a(e))?i(e):void 0},this.applyStyle=function(e,t,n,o){new odf.TextStyleApplicator("auto"+h.hashString(e)+"_",u,l.rootElement.automaticStyles).applyStyle(t,n,o)},this.updateStyle=function(e,t,n){var r,a;if(o(e,t),n){e.getAttributeNS(m,"name"),r=s(),a=0;do t=n+a,a+=1;while(-1!==r.indexOf(t));e.setAttributeNS(m,"style:name",t)}}},runtime.loadClass("core.DomUtils"),runtime.loadClass("odf.OdfContainer"),runtime.loadClass("odf.Formatting"),runtime.loadClass("xmldom.XPath"),runtime.loadClass("odf.FontLoader"),runtime.loadClass("odf.Style2CSS"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("gui.AnnotationViewManager"),odf.OdfCanvas=function(){function e(){function e(o){n=!0,runtime.setTimeout(function(){try{o()}catch(r){runtime.log(r)}n=!1,0<t.length&&e(t.pop())},10)}var t=[],n=!1;this.clearQueue=function(){t.length=0},this.addToQueue=function(o){return 0!==t.length||n?void t.push(o):e(o)}}function t(e){function t(){for(;0<n.cssRules.length;)n.deleteRule(0);n.insertRule("#shadowContent draw|page {display:none;}",0),n.insertRule("office|presentation draw|page {display:none;}",1),n.insertRule("#shadowContent draw|page:nth-of-type("+o+") {display:block;}",2),n.insertRule("office|presentation draw|page:nth-of-type("+o+") {display:block;}",3)}var n=e.sheet,o=1;this.showFirstPage=function(){o=1,t()},this.showNextPage=function(){o+=1,t()},this.showPreviousPage=function(){o>1&&(o-=1,t())},this.showPage=function(e){e>0&&(o=e,t())},this.css=e}function n(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function o(e){function t(e,t){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function o(){var n,o,i=[],s=runtime.getWindow().getSelection();for(n=0;n<s.rangeCount;n+=1)o=s.getRangeAt(n),null!==o&&t(e,o.startContainer)&&t(e,o.endContainer)&&i.push(o);if(i.length===r.length){for(s=0;s<i.length&&(n=i[s],o=r[s],n=n===o?!1:null===n||null===o?!0:n.startContainer!==o.startContainer||n.startOffset!==o.startOffset||n.endContainer!==o.endContainer||n.endOffset!==o.endOffset,!n);s+=1);if(s===i.length)return}r=i;var l,s=[i.length],u=e.ownerDocument;for(n=0;n<i.length;n+=1)o=i[n],l=u.createRange(),l.setStart(o.startContainer,o.startOffset),l.setEnd(o.endContainer,o.endOffset),s[n]=l;for(r=s,s=a.length,i=0;s>i;i+=1)a[i](e,r)}var r=[],a=[];this.addListener=function(e,t){var n,o=a.length;for(n=0;o>n;n+=1)if(a[n]===t)return;a.push(t)},n(e,"mouseup",o),n(e,"keyup",o),n(e,"keydown",o)}function r(e,t,n){(new odf.Style2CSS).style2css(e.getDocumentType(),n.sheet,t.getFontMap(),e.rootElement.styles,e.rootElement.automaticStyles)}function a(e,t,n,o){n.setAttribute("styleid",t);var r,i,s,l=n.getAttributeNS(E,"anchor-type"),u=n.getAttributeNS(S,"x"),c=n.getAttributeNS(S,"y"),d=n.getAttributeNS(S,"width"),m=n.getAttributeNS(S,"height"),f=n.getAttributeNS(v,"min-height"),p=n.getAttributeNS(v,"min-width"),h=n.getAttributeNS(x,"master-page-name"),y=null;i=0;var b,N=e.rootElement.ownerDocument;if(h){for(y=e.rootElement.masterStyles.getElementsByTagNameNS(C,"master-page"),i=null,s=0;s<y.length;s+=1)if(y[s].getAttributeNS(C,"name")===h){i=y[s];break}y=i}else y=null;if(y){for(h=N.createElementNS(x,"draw:page"),b=y.firstElementChild,i=0;b;)"true"!==b.getAttributeNS(D,"placeholder")&&(s=b.cloneNode(!0),h.appendChild(s),a(e,t+"_"+i,s,o)),b=b.nextElementSibling,i+=1;if(g.appendChild(h),i=g.getElementsByTagNameNS(x,"page").length,s=h.getElementsByTagNameNS(E,"page-number")[0]){for(;s.firstChild;)s.removeChild(s.firstChild);s.appendChild(N.createTextNode(i))}a(e,t,h,o),h.setAttributeNS(x,"draw:master-page-name",y.getAttributeNS(C,"name"))}"as-char"===l?r="display: inline-block;":l||u||c?r="position: absolute;":(d||m||f||p)&&(r="display: block;"),u&&(r+="left: "+u+";"),c&&(r+="top: "+c+";"),d&&(r+="width: "+d+";"),m&&(r+="height: "+m+";"),f&&(r+="min-height: "+f+";"),p&&(r+="min-width: "+p+";"),r&&(r="draw|"+n.localName+'[styleid="'+t+'"] {'+r+"}",o.insertRule(r,o.cssRules.length))}function i(e){for(e=e.firstChild;e;){if(e.namespaceURI===N&&"binary-data"===e.localName)return"data:image/png;base64,"+e.textContent.replace(/[\r\n\s]/g,"");e=e.nextSibling}return""}function s(e,t,n,o){function r(t){t&&(t='draw|image[styleid="'+e+'"] {'+("background-image: url("+t+");")+"}",o.insertRule(t,o.cssRules.length))}n.setAttribute("styleid",e);var a,s=n.getAttributeNS(T,"href");if(s)try{a=t.getPart(s),a.onchange=function(e){r(e.url)},a.load()}catch(l){runtime.log("slight problem: "+l)}else s=i(n),r(s)}function l(e){function t(e){return o===e.getAttributeNS(N,"name")}var n=I.getElementsByTagNameNS(e,N,"annotation");e=I.getElementsByTagNameNS(e,N,"annotation-end");var o,r;for(r=0;r<n.length;r+=1)o=n[r].getAttributeNS(N,"name"),b.addAnnotation({node:n[r],end:e.filter(t)[0]||null});b.rerenderAnnotations()}function u(e){function t(t){var n,o;t.hasAttributeNS(T,"href")&&(n=t.getAttributeNS(T,"href"),"#"===n[0]?(n=n.substring(1),o=function(){var t=R.getODFElementsWithXPath(e,"//text:bookmark-start[@text:name='"+n+"']",odf.Namespaces.resolvePrefix);return 0===t.length&&(t=R.getODFElementsWithXPath(e,"//text:bookmark[@text:name='"+n+"']",odf.Namespaces.resolvePrefix)),0<t.length&&t[0].scrollIntoView(!0),!1}):o=function(){A.open(n)},t.onclick=o)}var n,o,r;for(o=e.getElementsByTagNameNS(E,"a"),n=0;n<o.length;n+=1)r=o.item(n),t(r)}function c(e){var t=e.ownerDocument;I.getElementsByTagNameNS(e,E,"s").forEach(function(e){for(var n,o;e.firstChild;)e.removeChild(e.firstChild);if(e.appendChild(t.createTextNode(" ")),o=parseInt(e.getAttributeNS(E,"c"),10),o>1)for(e.removeAttributeNS(E,"c"),n=1;o>n;n+=1)e.parentNode.insertBefore(e.cloneNode(!0),e)})}function d(e){I.getElementsByTagNameNS(e,E,"tab").forEach(function(e){e.textContent="	"})}function m(e,t){function n(e,n){var a=l.documentElement.namespaceURI;"video/"===n.substr(0,6)?(o=l.createElementNS(a,"video"),o.setAttribute("controls","controls"),r=l.createElementNS(a,"source"),r.setAttribute("src",e),r.setAttribute("type",n),o.appendChild(r),t.parentNode.appendChild(o)):t.innerHtml="Unrecognised Plugin"}var o,r,a,s,l=t.ownerDocument;if(a=t.getAttributeNS(T,"href"))try{s=e.getPart(a),s.onchange=function(e){n(e.url,e.mimetype)},s.load()}catch(u){runtime.log("slight problem: "+u)}else runtime.log("using MP4 data fallback"),a=i(t),n(a,"video/mp4")}function f(e){var t,n=e.getElementsByTagName("head")[0];return"undefined"!==String(typeof webodf_css)?(t=e.createElementNS(n.namespaceURI,"style"),t.setAttribute("media","screen, print, handheld, projection"),t.appendChild(e.createTextNode(webodf_css))):(t=e.createElementNS(n.namespaceURI,"link"),e="webodf.css",runtime.currentDirectory&&(e=runtime.currentDirectory()+"/../"+e),t.setAttribute("href",e),t.setAttribute("rel","stylesheet")),t.setAttribute("type","text/css"),n.appendChild(t),t}function p(e){var t=e.getElementsByTagName("head")[0],n=e.createElementNS(t.namespaceURI,"style"),o="";return n.setAttribute("type","text/css"),n.setAttribute("media","screen, print, handheld, projection"),odf.Namespaces.forEachPrefix(function(e,t){o+="@namespace "+e+" url("+t+");\n"}),n.appendChild(e.createTextNode(o)),t.appendChild(n),n}var g,h,y,b,x=odf.Namespaces.drawns,v=odf.Namespaces.fons,N=odf.Namespaces.officens,C=odf.Namespaces.stylens,S=odf.Namespaces.svgns,w=odf.Namespaces.tablens,E=odf.Namespaces.textns,T=odf.Namespaces.xlinkns,O=odf.Namespaces.xmlns,D=odf.Namespaces.presentationns,A=runtime.getWindow(),R=new xmldom.XPath,P=new odf.OdfUtils,I=new core.DomUtils,F=!1;return odf.OdfCanvas=function(i){function v(e,t,n){function o(e,t,n,o){K.addToQueue(function(){s(e,t,n,o)})}var r,a;for(r=t.getElementsByTagNameNS(x,"image"),t=0;t<r.length;t+=1)a=r.item(t),o("image"+String(t),e,a,n)}function N(e,t){function n(e,t){K.addToQueue(function(){m(e,t)})}var o,r,a;for(r=t.getElementsByTagNameNS(x,"plugin"),o=0;o<r.length;o+=1)a=r.item(o),n(e,a)}function S(){h.firstChild&&(J>1?(h.style.MozTransformOrigin="center top",h.style.WebkitTransformOrigin="center top",h.style.OTransformOrigin="center top",h.style.msTransformOrigin="center top"):(h.style.MozTransformOrigin="left top",h.style.WebkitTransformOrigin="left top",h.style.OTransformOrigin="left top",h.style.msTransformOrigin="left top"),h.style.WebkitTransform="scale("+J+")",h.style.MozTransform="scale("+J+")",h.style.OTransform="scale("+J+")",h.style.msTransform="scale("+J+")",i.style.width=Math.round(J*h.offsetWidth)+"px",i.style.height=Math.round(J*h.offsetHeight)+"px")}function T(e){F?(y.parentNode||(h.appendChild(y),S()),b&&b.forgetAnnotations(),b=new gui.AnnotationViewManager(H,e.body,y),l(e.body)):y.parentNode&&(h.removeChild(y),b.forgetAnnotations(),S())}function D(e){function t(){for(var t=i;t.firstChild;)t.removeChild(t.firstChild);i.style.display="inline-block",t=M.rootElement,i.ownerDocument.importNode(t,!0),V.setOdfContainer(M);var n=M,o=L;(new odf.FontLoader).loadFonts(n,o.sheet),r(M,V,_);for(var o=M,n=X.sheet,s=i;s.firstChild;)s.removeChild(s.firstChild);h=z.createElementNS(i.namespaceURI,"div"),h.style.display="inline-block",h.style.background="white",h.appendChild(t),i.appendChild(h),y=z.createElementNS(i.namespaceURI,"div"),y.id="annotationsPane",g=z.createElementNS(i.namespaceURI,"div"),g.id="shadowContent",g.style.position="absolute",g.style.top=0,g.style.left=0,o.getContentElement().appendChild(g);var l,m,f,s=t.body;for(m=[],l=s.firstChild;l&&l!==s;)if(l.namespaceURI===x&&(m[m.length]=l),l.firstChild)l=l.firstChild;else{for(;l&&l!==s&&!l.nextSibling;)l=l.parentNode;l&&l.nextSibling&&(l=l.nextSibling)}for(f=0;f<m.length;f+=1)l=m[f],a(o,"frame"+String(f),l,n);for(m=R.getODFElementsWithXPath(s,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.resolvePrefix),l=0;l<m.length;l+=1)s=m[l],s.setAttributeNS&&s.setAttributeNS("urn:webodf","containsparagraphanchor",!0);for(l=t.body.getElementsByTagNameNS(w,"table-cell"),s=0;s<l.length;s+=1)m=l.item(s),m.hasAttributeNS(w,"number-columns-spanned")&&m.setAttribute("colspan",m.getAttributeNS(w,"number-columns-spanned")),m.hasAttributeNS(w,"number-rows-spanned")&&m.setAttribute("rowspan",m.getAttributeNS(w,"number-rows-spanned"));u(t.body),c(t.body),d(t.body),v(o,t.body,n),N(o,t.body),m=t.body;var p,b,D,I,s={};l={};var F;for(f=A.document.getElementsByTagNameNS(E,"list-style"),o=0;o<f.length;o+=1)p=f.item(o),(D=p.getAttributeNS(C,"name"))&&(l[D]=p);for(m=m.getElementsByTagNameNS(E,"list"),o=0;o<m.length;o+=1)if(p=m.item(o),f=p.getAttributeNS(O,"id")){if(b=p.getAttributeNS(E,"continue-list"),p.setAttribute("id",f),I="text|list#"+f+" > text|list-item > *:first-child:before {",D=p.getAttributeNS(E,"style-name")){if(p=l[D],F=P.getFirstNonWhitespaceChild(p),p=void 0,F)if("list-level-style-number"===F.localName){p=F.getAttributeNS(C,"num-format"),D=F.getAttributeNS(C,"num-suffix");var k="",k={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"},U=void 0,U=F.getAttributeNS(C,"num-prefix")||"",U=k.hasOwnProperty(p)?U+(" counter(list, "+k[p]+")"):p?U+("'"+p+"';"):U+" ''";D&&(U+=" '"+D+"'"),p=k="content: "+U+";"}else"list-level-style-image"===F.localName?p="content: none;":"list-level-style-bullet"===F.localName&&(p="content: '"+F.getAttributeNS(E,"bullet-char")+"';");F=p}if(b){for(p=s[b];p;)b=p,p=s[b];I+="counter-increment:"+b+";",F?(F=F.replace("list",b),I+=F):I+="content:counter("+b+");"}else b="",F?(F=F.replace("list",f),I+=F):I+="content: counter("+f+");",I+="counter-increment:"+f+";",n.insertRule("text|list#"+f+" {counter-reset:"+f+"}",n.cssRules.length);I+="}",s[f]=b,I&&n.insertRule(I,n.cssRules.length)}if(h.insertBefore(g,h.firstChild),S(),T(t),!e&&(t=[M],G.hasOwnProperty("statereadychange")))for(n=G.statereadychange,F=0;F<n.length;F+=1)n[F].apply(null,t)}M.state===odf.OdfContainer.DONE?t():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),runtime.setTimeout(function n(){M.state===odf.OdfContainer.DONE?t():(runtime.log("will be back later..."),runtime.setTimeout(n,500))},100))}function I(e){K.clearQueue(),i.innerHTML="loading "+e,i.removeAttribute("style"),M=new odf.OdfContainer(e,function(e){M=e,D(!1)})}function k(){if(W){for(var e=W.ownerDocument.createDocumentFragment();W.firstChild;)e.insertBefore(W.firstChild,null);W.parentNode.replaceChild(e,W)}}function U(e){e=e||A.event;for(var t,n,o=e.target,r=A.getSelection(),a=0<r.rangeCount?r.getRangeAt(0):null,i=a&&a.startContainer,s=a&&a.startOffset,l=a&&a.endContainer,u=a&&a.endOffset;o&&("p"!==o.localName&&"h"!==o.localName||o.namespaceURI!==E);)o=o.parentNode;q&&o&&o.parentNode!==W&&(t=o.ownerDocument,n=t.documentElement.namespaceURI,W?W.parentNode&&k():(W=t.createElementNS(n,"p"),W.style.margin="0px",W.style.padding="0px",W.style.border="0px",W.setAttribute("contenteditable",!0)),o.parentNode.replaceChild(W,o),W.appendChild(o),W.focus(),a&&(r.removeAllRanges(),a=o.ownerDocument.createRange(),a.setStart(i,s),a.setEnd(l,u),r.addRange(a)),e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0))}runtime.assert(null!==i&&void 0!==i,"odf.OdfCanvas constructor needs DOM element"),runtime.assert(null!==i.ownerDocument&&void 0!==i.ownerDocument,"odf.OdfCanvas constructor needs DOM");var M,B,L,_,X,W,H=this,z=i.ownerDocument,V=new odf.Formatting,j=new o(i),q=!1,J=1,G={},K=new e;f(z),B=new t(p(z)),L=p(z),_=p(z),X=p(z),this.refreshCSS=function(){r(M,V,_),S()},this.refreshSize=function(){S()},this.odfContainer=function(){return M},this.slidevisibilitycss=function(){return B.css},this.setOdfContainer=function(e,t){M=e,D(!0===t)},this.load=this.load=I,this.save=function(e){k(),M.save(e)},this.setEditable=function(e){n(i,"click",U),(q=e)||k()},this.addListener=function(e,t){switch(e){case"selectionchange":j.addListener(e,t);break;case"click":n(i,e,t);break;default:var o=G[e];void 0===o&&(o=G[e]=[]),t&&-1===o.indexOf(t)&&o.push(t)}},this.getFormatting=function(){return V},this.getAnnotationManager=function(){return b},this.refreshAnnotations=function(){T(M.rootElement)},this.rerenderAnnotations=function(){b&&b.rerenderAnnotations()},this.getSizer=function(){return h},this.enableAnnotations=function(e){e!==F&&(F=e,T(M.rootElement))},this.addAnnotation=function(e){b&&b.addAnnotation(e)},this.forgetAnnotations=function(){b&&b.forgetAnnotations()},this.setZoomLevel=function(e){J=e,S()},this.getZoomLevel=function(){return J},this.fitToContainingElement=function(e,t){var n=i.offsetHeight/J;J=e/(i.offsetWidth/J),J>t/n&&(J=t/n),S()},this.fitToWidth=function(e){J=e/(i.offsetWidth/J),S()},this.fitSmart=function(e,t){var n,o;n=i.offsetWidth/J,o=i.offsetHeight/J,n=e/n,void 0!==t&&n>t/o&&(n=t/o),J=Math.min(1,n),S()},this.fitToHeight=function(e){J=e/(i.offsetHeight/J),S()},this.showFirstPage=function(){B.showFirstPage()},this.showNextPage=function(){B.showNextPage()},this.showPreviousPage=function(){B.showPreviousPage()},this.showPage=function(e){B.showPage(e),S()},this.getElement=function(){return i}},odf.OdfCanvas}(),runtime.loadClass("odf.OdfCanvas"),odf.CommandLineTools=function(){this.roundTrip=function(e,t,n){return new odf.OdfContainer(e,function(o){return o.state===odf.OdfContainer.INVALID?n("Document "+e+" is invalid."):void(o.state===odf.OdfContainer.DONE?o.saveAs(t,function(e){n(e)}):n("Document was not completely loaded."))})},this.render=function(e,t,n){for(t=t.getElementsByTagName("body")[0];t.firstChild;)t.removeChild(t.firstChild);t=new odf.OdfCanvas(t),t.addListener("statereadychange",function(e){n(e)}),t.load(e)}},ops.Server=function(){},ops.Server.prototype.connect=function(e,t){},ops.Server.prototype.networkStatus=function(){},ops.Server.prototype.login=function(e,t,n,o){},ops.Server.prototype.joinSession=function(e,t,n,o){},ops.Server.prototype.getGenesisUrl=function(e){},ops.Operation=function(){},ops.Operation.prototype.init=function(e){},ops.Operation.prototype.execute=function(e){},ops.Operation.prototype.spec=function(){},ops.OpAddCursor=function(){var e,t;this.init=function(n){e=n.memberid,t=n.timestamp},this.execute=function(t){var n=t.getCursor(e);return n?!1:(n=new ops.OdtCursor(e,t),t.addCursor(n),t.emit(ops.OdtDocument.signalCursorAdded,n),!0)},this.spec=function(){return{optype:"AddCursor",memberid:e,timestamp:t}}},runtime.loadClass("core.DomUtils"),runtime.loadClass("odf.OdfUtils"),gui.StyleHelper=function(e){function t(t,n,r){var a,i=!0;for(t.collapsed?(a=t.startContainer,a.hasChildNodes()&&t.startOffset<a.childNodes.length&&(a=a.childNodes[t.startOffset]),t=[a]):t=o.getTextNodes(t,!0),t=e.getAppliedStyles(t),a=0;a<t.length&&(i=t[a]["style:text-properties"],!(i=!i||i[n]!==r));a+=1);return!i}var n=new core.DomUtils,o=new odf.OdfUtils;

this.getAppliedStyles=function(t){return t=o.getTextNodes(t,!0),e.getAppliedStyles(t)},this.applyStyle=function(t,r,a){var i=n.splitBoundaries(r),s=o.getTextNodes(r,!1);e.applyStyle(t,s,{startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset},a),i.forEach(n.normalizeTextNodes)},this.isBold=function(e){return t(e,"fo:font-weight","bold")},this.isItalic=function(e){return t(e,"fo:font-style","italic")},this.hasUnderline=function(e){return t(e,"style:text-underline-style","solid")},this.hasStrikeThrough=function(e){return t(e,"style:text-line-through-style","solid")}},runtime.loadClass("gui.StyleHelper"),runtime.loadClass("odf.OdfUtils"),ops.OpApplyDirectStyling=function(){function e(e){var t=r>=0?o+r:o,n=e.getIteratorAtPosition(r>=0?o:o+r),t=r?e.getIteratorAtPosition(t):n;return e=e.getDOM().createRange(),e.setStart(n.container(),n.unfilteredDomOffset()),e.setEnd(t.container(),t.unfilteredDomOffset()),e}var t,n,o,r,a,i=new odf.OdfUtils;this.init=function(e){t=e.memberid,n=e.timestamp,o=parseInt(e.position,10),r=parseInt(e.length,10),a=e.setProperties},this.execute=function(o){var r=e(o),s=i.getImpactedParagraphs(r);return new gui.StyleHelper(o.getFormatting()).applyStyle(t,r,a),r.detach(),o.getOdfCanvas().refreshCSS(),s.forEach(function(e){o.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:e,memberId:t,timeStamp:n})}),o.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"ApplyDirectStyling",memberid:t,timestamp:n,position:o,length:r,setProperties:a}}},ops.OpRemoveCursor=function(){var e,t;this.init=function(n){e=n.memberid,t=n.timestamp},this.execute=function(t){return t.removeCursor(e)?!0:!1},this.spec=function(){return{optype:"RemoveCursor",memberid:e,timestamp:t}}},ops.OpMoveCursor=function(){var e,t,n,o;this.init=function(r){e=r.memberid,t=r.timestamp,n=r.position,o=r.length||0},this.execute=function(t){var r=t.getCursor(e),a=t.getCursorPosition(e),i=t.getPositionFilter(),s=n-a;return r?(a=r.getStepCounter(),s=s>0?a.countForwardSteps(s,i):0>s?-a.countBackwardSteps(-s,i):0,r.move(s),o&&(i=o>0?a.countForwardSteps(o,i):0>o?-a.countBackwardSteps(-o,i):0,r.move(i,!0)),t.emit(ops.OdtDocument.signalCursorMoved,r),!0):!1},this.spec=function(){return{optype:"MoveCursor",memberid:e,timestamp:t,position:n,length:o}}},ops.OpInsertTable=function(){function e(e,t){var n;if(1===u.length)n=u[0];else if(3===u.length)switch(e){case 0:n=u[0];break;case o-1:n=u[2];break;default:n=u[1]}else n=u[e];if(1===n.length)return n[0];if(3===n.length)switch(t){case 0:return n[0];case r-1:return n[2];default:return n[1]}return n[t]}var t,n,o,r,a,i,s,l,u;this.init=function(e){t=e.memberid,n=e.timestamp,a=e.position,o=e.initialRows,r=e.initialColumns,i=e.tableName,s=e.tableStyleName,l=e.tableColumnStyleName,u=e.tableCellStyleMatrix},this.execute=function(u){var c=u.getPositionInTextNode(a),d=u.getRootNode();if(c){var m,f,p,g,h=u.getDOM(),y=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),b=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column");for(s&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",s),i&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",i),b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:number-columns-repeated",r),l&&b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",l),y.appendChild(b),p=0;o>p;p+=1){for(b=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row"),g=0;r>g;g+=1)m=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(f=e(p,g))&&m.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",f),f=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:p"),m.appendChild(f),b.appendChild(m);y.appendChild(b)}return c=u.getParagraphElement(c.textNode),d.insertBefore(y,c?c.nextSibling:void 0),u.getOdfCanvas().refreshSize(),u.emit(ops.OdtDocument.signalTableAdded,{tableElement:y,memberId:t,timeStamp:n}),u.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertTable",memberid:t,timestamp:n,position:a,initialRows:o,initialColumns:r,tableName:i,tableStyleName:s,tableColumnStyleName:l,tableCellStyleMatrix:u}}},ops.OpInsertText=function(){function e(e,t){var n=t.parentNode,o=t.nextSibling,r=[];e.getCursors().forEach(function(e){var n=e.getSelectedRange();!n||n.startContainer!==t&&n.endContainer!==t||r.push({cursor:e,startContainer:n.startContainer,startOffset:n.startOffset,endContainer:n.endContainer,endOffset:n.endOffset})}),n.removeChild(t),n.insertBefore(t,o),r.forEach(function(e){var t=e.cursor.getSelectedRange();t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset)})}var t,n,o,r;this.init=function(e){t=e.memberid,n=e.timestamp,o=e.position,r=e.text},this.execute=function(a){var i,s,l,u,c,d,m=a.getDOM(),f=!0,p=0;if(i=a.getPositionInTextNode(o,t)){for(s=i.textNode,l=s.parentNode,u=s.nextSibling,c=a.getParagraphElement(s),i.offset!==s.length&&(u=s.splitText(i.offset)),i=0;i<r.length;i+=1)(" "===r[i]||"	"===r[i])&&(i>p&&(p=r.substring(p,i),f?s.appendData(p):l.insertBefore(m.createTextNode(p),u)),p=i+1,f=!1,d=" "===r[i]?"text:s":"text:tab",d=m.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",d),d.appendChild(m.createTextNode(r[i])),l.insertBefore(d,u));return p=r.substring(p),0<p.length&&(f?s.appendData(p):l.insertBefore(m.createTextNode(p),u)),e(a,s),0===s.length&&s.parentNode.removeChild(s),a.getOdfCanvas().refreshSize(),a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:c,memberId:t,timeStamp:n}),a.getOdfCanvas().rerenderAnnotations(),!0}return!1},this.spec=function(){return{optype:"InsertText",memberid:t,timestamp:n,position:o,text:r}}},runtime.loadClass("odf.Namespaces"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("core.DomUtils"),ops.OpRemoveText=function(){function e(e){function t(e){if(i.isCharacterElement(e))return!1;if(e.nodeType===Node.TEXT_NODE)return 0===e.textContent.length;for(e=e.firstChild;e;){if(!t(e))return!1;e=e.nextSibling}return!0}function n(o){return o=s.mergeIntoParent(o),!i.isParagraph(o)&&o!==e&&t(o)?n(o):o}this.isEmpty=t,this.mergeChildrenIntoParent=n}function t(e){var t,n,o,i,l=e.getPositionFilter(),u=a,c=e.getDOM().createRange();for(e=e.getIteratorAtPosition(r),t=e.container(),n=e.unfilteredDomOffset();u&&e.nextPosition();)o=e.container(),i=e.unfilteredDomOffset(),l.acceptPosition(e)===NodeFilter.FILTER_ACCEPT&&(u-=1);return c.setStart(t,n),c.setEnd(o,i),s.splitBoundaries(c),c}var n,o,r,a,i,s;this.init=function(e){runtime.assert(0<=e.length,"OpRemoveText only supports positive lengths"),n=e.memberid,o=e.timestamp,r=parseInt(e.position,10),a=parseInt(e.length,10),i=new odf.OdfUtils,s=new core.DomUtils},this.execute=function(i){var s,l,u,c,d=new e(i.getRootNode());return i.upgradeWhitespacesAtPosition(r),i.upgradeWhitespacesAtPosition(r+a),l=t(i),s=i.getParagraphElement(l.startContainer),u=i.getTextElements(l,!0),c=i.getParagraphElements(l),l.detach(),u.forEach(function(e){d.mergeChildrenIntoParent(e)}),l=c.reduce(function(e,t){var n,o,r,a,i=e,s=t;for(d.isEmpty(e)&&(o=!0,t.parentNode!==e.parentNode&&(r=t.parentNode,e.parentNode.insertBefore(t,e.nextSibling)),s=e,i=t,a=i.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo")[0]||i.firstChild);s.hasChildNodes();)n=o?s.lastChild:s.firstChild,s.removeChild(n),"editinfo"!==n.localName&&i.insertBefore(n,a);return r&&d.isEmpty(r)&&d.mergeChildrenIntoParent(r),d.mergeChildrenIntoParent(s),i}),i.fixCursorPositions(),i.getOdfCanvas().refreshSize(),i.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:l||s,memberId:n,timeStamp:o}),i.emit(ops.OdtDocument.signalCursorMoved,i.getCursor(n)),i.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"RemoveText",memberid:n,timestamp:o,position:r,length:a}}},ops.OpSplitParagraph=function(){var e,t,n,o;this.init=function(r){e=r.memberid,t=r.timestamp,n=r.position,o=new odf.OdfUtils},this.execute=function(r){var a,i,s,l,u,c;if(r.upgradeWhitespacesAtPosition(n),a=r.getPositionInTextNode(n,e),!a)return!1;if(i=r.getParagraphElement(a.textNode),!i)return!1;for(s=o.isListItem(i.parentNode)?i.parentNode:i,0===a.offset?(c=a.textNode.previousSibling,u=null):(c=a.textNode,u=a.offset>=a.textNode.length?null:a.textNode.splitText(a.offset)),a=a.textNode;a!==s;)if(a=a.parentNode,l=a.cloneNode(!1),c){for(u&&l.appendChild(u);c.nextSibling;)l.appendChild(c.nextSibling);a.parentNode.insertBefore(l,a.nextSibling),c=a,u=l}else a.parentNode.insertBefore(l,a),c=l,u=a;return o.isListItem(u)&&(u=u.childNodes[0]),r.fixCursorPositions(e),r.getOdfCanvas().refreshSize(),r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:i,memberId:e,timeStamp:t}),r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:u,memberId:e,timeStamp:t}),r.getOdfCanvas().rerenderAnnotations(),!0},this.spec=function(){return{optype:"SplitParagraph",memberid:e,timestamp:t,position:n}}},ops.OpSetParagraphStyle=function(){var e,t,n,o;this.init=function(r){e=r.memberid,t=r.timestamp,n=r.position,o=r.styleName},this.execute=function(r){var a;return(a=r.getPositionInTextNode(n))&&(a=r.getParagraphElement(a.textNode))?(""!==o?a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",o):a.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),r.getOdfCanvas().refreshSize(),r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:a,timeStamp:t,memberId:e}),r.getOdfCanvas().rerenderAnnotations(),!0):!1},this.spec=function(){return{optype:"SetParagraphStyle",memberid:e,timestamp:t,position:n,styleName:o}}},ops.OpUpdateParagraphStyle=function(){function e(e,t){var n,o,r=t?t.split(","):[];for(n=0;n<r.length;n+=1)o=r[n].split(":"),e.removeAttributeNS(odf.Namespaces.resolvePrefix(o[0]),o[1])}var t,n,o,r,a;this.init=function(e){t=e.memberid,n=e.timestamp,o=e.styleName,r=e.setProperties,a=e.removedProperties},this.execute=function(t){var n,i,s,l,u,c=t.getFormatting(),d=t.getDOM(),m=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","style:style");return(m=t.getParagraphStyleElement(o))?(n=m.getElementsByTagNameNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","paragraph-properties")[0],i=m.getElementsByTagNameNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","text-properties")[0],r&&Object.keys(r).forEach(function(e){switch(e){case"style:paragraph-properties":void 0===n&&(n=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","style:paragraph-properties"),m.appendChild(n)),c.updateStyle(n,r["style:paragraph-properties"]);break;case"style:text-properties":void 0===i&&(i=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","style:text-properties"),m.appendChild(i)),(l=r["style:text-properties"]["style:font-name"])&&!c.getFontMap().hasOwnProperty(l)&&(s=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","style:font-face"),s.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:style:1.0","style:name",l),s.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","svg:font-family",l),t.getOdfCanvas().odfContainer().rootElement.fontFaceDecls.appendChild(s)),c.updateStyle(i,r["style:text-properties"]);break;default:"object"!=typeof r[e]&&(u=odf.Namespaces.resolvePrefix(e.substr(0,e.indexOf(":"))),m.setAttributeNS(u,e,r[e]))}}),a&&(a["style:paragraph-properties"]&&(e(n,a["style:paragraph-properties"].attributes),0===n.attributes.length&&m.removeChild(n)),a["style:text-properties"]&&(e(i,a["style:text-properties"].attributes),0===i.attributes.length&&m.removeChild(i)),e(m,a.attributes)),t.getOdfCanvas().refreshCSS(),t.emit(ops.OdtDocument.signalParagraphStyleModified,o),t.getOdfCanvas().rerenderAnnotations(),!0):!1},this.spec=function(){return{optype:"UpdateParagraphStyle",memberid:t,timestamp:n,styleName:o,setProperties:r,removedProperties:a}}},runtime.loadClass("odf.Namespaces"),ops.OpAddParagraphStyle=function(){var e,t,n,o,r=odf.Namespaces.svgns,a=odf.Namespaces.stylens;this.init=function(r){e=r.memberid,t=r.timestamp,n=r.styleName,o=r.setProperties},this.execute=function(e){var t,i,s,l,u,c=e.getOdfCanvas().odfContainer(),d=e.getFormatting(),m=e.getDOM(),f=m.createElementNS(a,"style:style");return f?(f.setAttributeNS(a,"style:family","paragraph"),f.setAttributeNS(a,"style:name",n),o&&Object.keys(o).forEach(function(e){switch(e){case"style:paragraph-properties":t=m.createElementNS(a,"style:paragraph-properties"),f.appendChild(t),d.updateStyle(t,o["style:paragraph-properties"]);break;case"style:text-properties":i=m.createElementNS(a,"style:text-properties"),f.appendChild(i),(l=o["style:text-properties"]["style:font-name"])&&!d.getFontMap().hasOwnProperty(l)&&(s=m.createElementNS(a,"style:font-face"),s.setAttributeNS(a,"style:name",l),s.setAttributeNS(r,"svg:font-family",l),c.rootElement.fontFaceDecls.appendChild(s)),d.updateStyle(i,o["style:text-properties"]);break;default:"object"!=typeof o[e]&&(u=odf.Namespaces.resolvePrefix(e.substr(0,e.indexOf(":"))),f.setAttributeNS(u,e,o[e]))}}),c.rootElement.styles.appendChild(f),e.getOdfCanvas().refreshCSS(),e.emit(ops.OdtDocument.signalStyleCreated,n),!0):!1},this.spec=function(){return{optype:"AddParagraphStyle",memberid:e,timestamp:t,styleName:n,setProperties:o}}},ops.OpRemoveParagraphStyle=function(){var e,t,n;this.init=function(o){e=o.memberid,t=o.timestamp,n=o.styleName},this.execute=function(e){var t=e.getParagraphStyleElement(n);return t?(t.parentNode.removeChild(t),e.getOdfCanvas().refreshCSS(),e.emit(ops.OdtDocument.signalStyleDeleted,n),!0):!1},this.spec=function(){return{optype:"RemoveParagraphStyle",memberid:e,timestamp:t,styleName:n}}},ops.OpAddAnnotation=function(){function e(e,n,o){(o=e.getPositionInTextNode(o,t))&&(e=o.textNode,o.offset!==e.length&&e.splitText(o.offset),e.parentNode.insertBefore(n,e.nextSibling))}var t,n,o,r,a;this.init=function(e){t=e.memberid,n=parseInt(e.timestamp,10),o=parseInt(e.position,10),r=parseInt(e.length,10)||0,a=e.name},this.execute=function(i){var s,l,u,c,d,m={},f=i.getPositionFilter(),p=i.getCursor(t),g=i.getCursorPosition(t),g=o-g-1,h=new Date(n);if(d=i.getDOM(),s=d.createElementNS(odf.Namespaces.officens,"office:annotation"),s.setAttributeNS(odf.Namespaces.officens,"office:name",a),l=d.createElementNS(odf.Namespaces.dcns,"dc:creator"),l.setAttributeNS(odf.Namespaces.webodfns+":names:editinfo","editinfo:memberid",t),u=d.createElementNS(odf.Namespaces.dcns,"dc:date"),u.appendChild(d.createTextNode(h.toISOString())),h=d.createElementNS(odf.Namespaces.textns,"text:list"),c=d.createElementNS(odf.Namespaces.textns,"text:list-item"),d=d.createElementNS(odf.Namespaces.textns,"text:p"),c.appendChild(d),h.appendChild(c),s.appendChild(l),s.appendChild(u),s.appendChild(h),m.node=s,!m.node)return!1;if(r){if(s=i.getDOM().createElementNS(odf.Namespaces.officens,"office:annotation-end"),s.setAttributeNS(odf.Namespaces.officens,"office:name",a),m.end=s,!m.end)return!1;e(i,m.end,o+r)}return e(i,m.node,o),p&&(s=p.getStepCounter(),f=g>0?s.countForwardSteps(g,f):0>g?-s.countBackwardSteps(-g,f):0,p.move(f),i.emit(ops.OdtDocument.signalCursorMoved,p)),i.getOdfCanvas().addAnnotation(m),!0},this.spec=function(){return{optype:"AddAnnotation",memberid:t,timestamp:n,position:o,length:r,name:a}}},runtime.loadClass("odf.Namespaces"),runtime.loadClass("core.DomUtils"),ops.OpRemoveAnnotation=function(){var e,t,n,o,r;this.init=function(a){e=a.memberid,t=a.timestamp,n=parseInt(a.position,10),o=parseInt(a.length,10),r=new core.DomUtils},this.execute=function(e){for(var t,o=e.getIteratorAtPosition(n).container(),a=null,i=null;o.namespaceURI!==odf.Namespaces.officens||"annotation"!==o.localName;)o=o.parentNode;if(null===o)return!1;for(a=o,(t=a.getAttributeNS(odf.Namespaces.officens,"name"))&&(i=r.getElementsByTagNameNS(e.getRootNode(),odf.Namespaces.officens,"annotation-end").filter(function(e){return t===e.getAttributeNS(odf.Namespaces.officens,"name")})[0]||null),e.getOdfCanvas().forgetAnnotations(),o=r.getElementsByTagNameNS(a,odf.Namespaces.webodfns+":names:cursor","cursor");o.length;)a.parentNode.insertBefore(o.pop(),a);return a.parentNode.removeChild(a),i&&i.parentNode.removeChild(i),e.fixCursorPositions(),e.getOdfCanvas().refreshAnnotations(),!0},this.spec=function(){return{optype:"RemoveAnnotation",memberid:e,timestamp:t,position:n,length:o}}},runtime.loadClass("ops.OpAddCursor"),runtime.loadClass("ops.OpApplyDirectStyling"),runtime.loadClass("ops.OpRemoveCursor"),runtime.loadClass("ops.OpMoveCursor"),runtime.loadClass("ops.OpInsertTable"),runtime.loadClass("ops.OpInsertText"),runtime.loadClass("ops.OpRemoveText"),runtime.loadClass("ops.OpSplitParagraph"),runtime.loadClass("ops.OpSetParagraphStyle"),runtime.loadClass("ops.OpUpdateParagraphStyle"),runtime.loadClass("ops.OpAddParagraphStyle"),runtime.loadClass("ops.OpRemoveParagraphStyle"),runtime.loadClass("ops.OpAddAnnotation"),runtime.loadClass("ops.OpRemoveAnnotation"),ops.OperationFactory=function(){function e(e){return function(){return new e}}var t;this.register=function(e,n){t[e]=n},this.create=function(e){var n=null,o=t[e.optype];return o&&(n=o(e),n.init(e)),n},t={AddCursor:e(ops.OpAddCursor),ApplyDirectStyling:e(ops.OpApplyDirectStyling),InsertTable:e(ops.OpInsertTable),InsertText:e(ops.OpInsertText),RemoveText:e(ops.OpRemoveText),SplitParagraph:e(ops.OpSplitParagraph),SetParagraphStyle:e(ops.OpSetParagraphStyle),UpdateParagraphStyle:e(ops.OpUpdateParagraphStyle),AddParagraphStyle:e(ops.OpAddParagraphStyle),RemoveParagraphStyle:e(ops.OpRemoveParagraphStyle),MoveCursor:e(ops.OpMoveCursor),RemoveCursor:e(ops.OpRemoveCursor),AddAnnotation:e(ops.OpAddAnnotation),RemoveAnnotation:e(ops.OpRemoveAnnotation)}},runtime.loadClass("core.Cursor"),runtime.loadClass("core.PositionIterator"),runtime.loadClass("core.PositionFilter"),runtime.loadClass("core.LoopWatchDog"),runtime.loadClass("odf.OdfUtils"),gui.SelectionMover=function(e,t){function n(){return y.setUnfilteredPosition(e.getNode(),0),y}function o(e,t){var n,o=null;return e&&(n=t?e[e.length-1]:e[0]),n&&(o={top:n.top,left:t?n.right:n.left,bottom:n.bottom}),o}function r(e,n,a,i){var s=e.nodeType;return a.setStart(e,n),a.collapse(!i),i=o(a.getClientRects(),!0===i),!i&&n>0&&(a.setStart(e,n-1),a.setEnd(e,n),i=o(a.getClientRects(),!0)),i||(s===Node.ELEMENT_NODE&&e.childNodes[n-1]?i=r(e,n-1,a,!0):e.nodeType===Node.TEXT_NODE&&n>0?i=r(e,n-1,a,!0):e.previousSibling?i=r(e.previousSibling,e.previousSibling.nodeType===Node.TEXT_NODE?e.previousSibling.textContent.length:e.previousSibling.childNodes.length,a,!0):e.parentNode&&e.parentNode!==t?i=r(e.parentNode,0,a,!1):(a.selectNode(t),i=o(a.getClientRects(),!1))),runtime.assert(Boolean(i),"No visible rectangle found"),i}function a(o,a,i){var s,l,u=o,c=n(),d=t.ownerDocument.createRange(),m=e.getSelectedRange()?e.getSelectedRange().cloneRange():t.ownerDocument.createRange(),f=runtime.getWindow();for(s=r(c.container(),c.unfilteredDomOffset(),d);u>0&&i();)u-=1;return a?(a=c.container(),c=c.unfilteredDomOffset(),-1===m.comparePoint(a,c)?(m.setStart(a,c),l=!1):m.setEnd(a,c)):(m.setStart(c.container(),c.unfilteredDomOffset()),m.collapse(!0)),e.setSelectedRange(m,l),c=n(),m=r(c.container(),c.unfilteredDomOffset(),d),(m.top===s.top||void 0===b)&&(b=m.left),f.clearTimeout(x),x=f.setTimeout(function(){b=void 0},2e3),d.detach(),o-u}function i(e){var t=n();return e.acceptPosition(t)===v?!0:!1}function s(e,t){for(var o=n(),r=new core.LoopWatchDog(1e3),a=0,i=0;e>0&&o.nextPosition();)a+=1,r.check(),t.acceptPosition(o)===v&&(i+=a,a=0,e-=1);return i}function l(e,t,o){for(var r=n(),a=new core.LoopWatchDog(1e3),i=0,s=0;e>0&&r.nextPosition();)a.check(),o.acceptPosition(r)===v&&(i+=1,t.acceptPosition(r)===v&&(s+=i,i=0,e-=1));return s}function u(e,t,o){for(var r=n(),a=new core.LoopWatchDog(1e3),i=0,s=0;e>0&&r.previousPosition();)a.check(),o.acceptPosition(r)===v&&(i+=1,t.acceptPosition(r)===v&&(s+=i,i=0,e-=1));return s}function c(e,t){for(var o=n(),r=new core.LoopWatchDog(1e3),a=0,i=0;e>0&&o.previousPosition();)a+=1,r.check(),t.acceptPosition(o)===v&&(i+=a,a=0,e-=1);return i}function d(e){var t,o=n(),r=h.getParagraphElement(o.getCurrentNode());return t=-c(1,e),(0===t||r&&r!==h.getParagraphElement(o.getCurrentNode()))&&(t=s(1,e)),t}function m(e,o){var a=n(),i=0,s=0,l=0>e?-1:1;for(e=Math.abs(e);e>0;){for(var u=o,c=l,d=a,m=d.container(),f=0,p=null,g=void 0,h=10,y=void 0,x=0,N=void 0,C=void 0,S=void 0,y=void 0,w=t.ownerDocument.createRange(),E=new core.LoopWatchDog(1e3),y=r(m,d.unfilteredDomOffset(),w),N=y.top,C=void 0===b?y.left:b,S=N;!0===(0>c?d.previousPosition():d.nextPosition());)if(E.check(),u.acceptPosition(d)===v&&(f+=1,m=d.container(),y=r(m,d.unfilteredDomOffset(),w),y.top!==N)){if(y.top!==S&&S!==N)break;S=y.top,y=Math.abs(C-y.left),(null===p||h>y)&&(p=m,g=d.unfilteredDomOffset(),h=y,x=f)}if(null!==p?(d.setUnfilteredPosition(p,g),f=x):f=0,w.detach(),i+=f,0===i)break;s+=i,e-=1}return s*l}function f(e,o){var a,i,s,l,u=n(),c=h.getParagraphElement(u.getCurrentNode()),d=0,m=t.ownerDocument.createRange();for(0>e?(a=u.previousPosition,i=-1):(a=u.nextPosition,i=1),s=r(u.container(),u.unfilteredDomOffset(),m);a.call(u);)if(o.acceptPosition(u)===v){if(h.getParagraphElement(u.getCurrentNode())!==c)break;if(l=r(u.container(),u.unfilteredDomOffset(),m),l.bottom!==s.bottom&&(s=l.top>=s.top&&l.bottom<s.bottom||l.top<=s.top&&l.bottom>s.bottom,!s))break;d+=i,s=l}return m.detach(),d}function p(e,t){for(var n,o=0;e.parentNode!==t;)runtime.assert(null!==e.parentNode,"parent is null"),e=e.parentNode;for(n=t.firstChild;n!==e;)o+=1,n=n.nextSibling;return o}function g(e,t,o){runtime.assert(null!==e,"SelectionMover.countStepsToPosition called with element===null");var r=n(),a=r.container(),i=r.unfilteredDomOffset(),s=0,l=new core.LoopWatchDog(1e3);r.setUnfilteredPosition(e,t),e=r.container(),runtime.assert(Boolean(e),"SelectionMover.countStepsToPosition: positionIterator.container() returned null"),t=r.unfilteredDomOffset(),r.setUnfilteredPosition(a,i);var a=e,i=t,u=r.container(),c=r.unfilteredDomOffset();if(a===u)a=c-i;else{var d=a.compareDocumentPosition(u);2===d?d=-1:4===d?d=1:10===d?(i=p(a,u),d=c>i?1:-1):(c=p(u,a),d=i>c?-1:1),a=d}if(0>a)for(;r.nextPosition()&&(l.check(),o.acceptPosition(r)===v&&(s+=1),r.container()!==e||r.unfilteredDomOffset()!==t););else if(a>0)for(;r.previousPosition()&&(l.check(),o.acceptPosition(r)===v&&(s-=1),r.container()!==e||r.unfilteredDomOffset()!==t););return s}var h,y,b,x,v=core.PositionFilter.FilterResult.FILTER_ACCEPT;this.movePointForward=function(e,t){return a(e,t,y.nextPosition)},this.movePointBackward=function(e,t){return a(e,t,y.previousPosition)},this.getStepCounter=function(){return{countForwardSteps:s,countBackwardSteps:c,convertForwardStepsBetweenFilters:l,convertBackwardStepsBetweenFilters:u,countLinesSteps:m,countStepsToLineBoundary:f,countStepsToPosition:g,isPositionWalkable:i,countStepsToValidPosition:d}},function(){h=new odf.OdfUtils,y=gui.SelectionMover.createPositionIterator(t);var n=t.ownerDocument.createRange();n.setStart(y.container(),y.unfilteredDomOffset()),n.collapse(!0),e.setSelectedRange(n)}()},gui.SelectionMover.createPositionIterator=function(e){var t=new function(){this.acceptNode=function(e){return"urn:webodf:names:cursor"===e.namespaceURI||"urn:webodf:names:editinfo"===e.namespaceURI?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};return new core.PositionIterator(e,5,t,!1)},function(){return gui.SelectionMover}(),runtime.loadClass("core.Cursor"),runtime.loadClass("gui.SelectionMover"),ops.OdtCursor=function(e,t){var n,o,r=this;this.removeFromOdtDocument=function(){o.remove()},this.move=function(e,t){var o=0;return e>0?o=n.movePointForward(e,t):0>=e&&(o=-n.movePointBackward(-e,t)),r.handleUpdate(),o},this.handleUpdate=function(){},this.getStepCounter=function(){return n.getStepCounter()},this.getMemberId=function(){return e},this.getNode=function(){return o.getNode()},this.getAnchorNode=function(){return o.getAnchorNode()},this.getSelectedRange=function(){return o.getSelectedRange()},this.getOdtDocument=function(){return t},o=new core.Cursor(t.getDOM(),e),n=new gui.SelectionMover(o,t.getRootNode())},ops.EditInfo=function(e,t){function n(){var e,t=[];for(e in r)r.hasOwnProperty(e)&&t.push({memberid:e,time:r[e].time});return t.sort(function(e,t){return e.time-t.time}),t}var o,r={};this.getNode=function(){return o},this.getOdtDocument=function(){return t},this.getEdits=function(){return r},this.getSortedEdits=function(){return n()},this.addEdit=function(e,t){r[e]={time:t}},this.clearEdits=function(){r={}},o=t.getDOM().createElementNS("urn:webodf:names:editinfo","editinfo"),e.insertBefore(o,e.firstChild)},gui.Avatar=function(e,t){var n,o,r,a=this;this.setColor=function(e){o.style.borderColor=e},this.setImageUrl=function(e){a.isVisible()?o.src=e:r=e},this.isVisible=function(){return"block"===n.style.display},this.show=function(){r&&(o.src=r,r=void 0),n.style.display="block"},this.hide=function(){n.style.display="none"},this.markAsFocussed=function(e){n.className=e?"active":""},function(){var r=e.ownerDocument,a=r.documentElement.namespaceURI;n=r.createElementNS(a,"div"),o=r.createElementNS(a,"img"),o.width=64,o.height=64,n.appendChild(o),n.style.width="64px",n.style.height="70px",n.style.position="absolute",n.style.top="-80px",n.style.left="-34px",n.style.display=t?"block":"none",e.appendChild(n)}()},runtime.loadClass("gui.Avatar"),runtime.loadClass("ops.OdtCursor"),gui.Caret=function(e,t,n){function o(e){l&&i.parentNode&&(!u||e)&&(e&&void 0!==s&&runtime.clearTimeout(s),u=!0,r.style.opacity=e||"0"===r.style.opacity?"1":"0",s=runtime.setTimeout(function(){u=!1,o(!1)},500))}var r,a,i,s,l=!1,u=!1;this.refreshCursorBlinking=function(){n||e.getSelectedRange().collapsed?(l=!0,o(!0)):(l=!1,r.style.opacity="0")},this.setFocus=function(){l=!0,a.markAsFocussed(!0),o(!0)},this.removeFocus=function(){l=!1,a.markAsFocussed(!1),r.style.opacity="0"},this.setAvatarImageUrl=function(e){a.setImageUrl(e)},this.setColor=function(e){r.style.borderColor=e,a.setColor(e)},this.getCursor=function(){return e},this.getFocusElement=function(){return r},this.toggleHandleVisibility=function(){a.isVisible()?a.hide():a.show()},this.showHandle=function(){a.show()},this.hideHandle=function(){a.hide()},this.ensureVisible=function(){var t,n,o,a,i,s=e.getOdtDocument().getOdfCanvas().getElement().parentNode;o=s.offsetWidth-s.clientWidth+5,a=s.offsetHeight-s.clientHeight+5,i=r.getBoundingClientRect(),t=i.left-o,n=i.top-a,o=i.right+o,a=i.bottom+a,i=s.getBoundingClientRect(),n<i.top?s.scrollTop-=i.top-n:a>i.bottom&&(s.scrollTop+=a-i.bottom),t<i.left?s.scrollLeft-=i.left-t:o>i.right&&(s.scrollLeft+=o-i.right)},function(){var n=e.getOdtDocument().getDOM();r=n.createElementNS(n.documentElement.namespaceURI,"span"),i=e.getNode(),i.appendChild(r),a=new gui.Avatar(i,t)}()},runtime.loadClass("core.EventNotifier"),gui.ClickHandler=function(){function e(){n=0,o=null}var t,n=0,o=null,r=new core.EventNotifier([gui.ClickHandler.signalSingleClick,gui.ClickHandler.signalDoubleClick,gui.ClickHandler.signalTripleClick]);this.subscribe=function(e,t){r.subscribe(e,t)},this.handleMouseUp=function(a){var i=runtime.getWindow();o&&o.x===a.screenX&&o.y===a.screenY?(n+=1,1===n?r.emit(gui.ClickHandler.signalSingleClick,a):2===n?r.emit(gui.ClickHandler.signalDoubleClick,void 0):3===n&&(i.clearTimeout(t),r.emit(gui.ClickHandler.signalTripleClick,void 0),e())):(r.emit(gui.ClickHandler.signalSingleClick,a),n=1,o={x:a.screenX,y:a.screenY},i.clearTimeout(t),t=i.setTimeout(e,400))}},gui.ClickHandler.signalSingleClick="click",gui.ClickHandler.signalDoubleClick="doubleClick",gui.ClickHandler.signalTripleClick="tripleClick",function(){return gui.ClickHandler}(),gui.KeyboardHandler=function(){function e(e,n){return n||(n=t.None),e+":"+n}var t=gui.KeyboardHandler.Modifier,n=null,o={};this.setDefault=function(e){n=e},this.bind=function(t,n,r){t=e(t,n),runtime.assert(!1===o.hasOwnProperty(t),"tried to overwrite the callback handler of key combo: "+t),o[t]=r},this.unbind=function(t,n){var r=e(t,n);delete o[r]},this.reset=function(){n=null,o={}},this.handleEvent=function(r){var a=r.keyCode,i=t.None;r.metaKey&&(i|=t.Meta),r.ctrlKey&&(i|=t.Ctrl),r.altKey&&(i|=t.Alt),r.shiftKey&&(i|=t.Shift),a=e(a,i),a=o[a],i=!1,a?i=a():null!==n&&(i=n(r)),i&&(r.preventDefault?r.preventDefault():r.returnValue=!1)}},gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12},gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,I:73,U:85,Z:90},function(){return gui.KeyboardHandler}(),runtime.loadClass("odf.Namespaces"),runtime.loadClass("xmldom.LSSerializer"),runtime.loadClass("odf.OdfNodeFilter"),runtime.loadClass("odf.TextSerializer"),gui.Clipboard=function(){var e,t,n;this.setDataFromRange=function(n,o){var r,a=!0,i=n.clipboardData;r=runtime.getWindow();var s=o.startContainer.ownerDocument;return!i&&r&&(i=r.clipboardData),i?(s=s.createElement("span"),s.appendChild(o.cloneContents()),r=i.setData("text/plain",t.writeToString(s)),a=a&&r,r=i.setData("text/html",e.writeToString(s,odf.Namespaces.namespaceMap)),a=a&&r,n.preventDefault()):a=!1,a},e=new xmldom.LSSerializer,t=new odf.TextSerializer,n=new odf.OdfNodeFilter,e.filter=n,t.filter=n},runtime.loadClass("core.DomUtils"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("ops.OpAddCursor"),runtime.loadClass("ops.OpRemoveCursor"),runtime.loadClass("ops.OpMoveCursor"),runtime.loadClass("ops.OpInsertText"),runtime.loadClass("ops.OpRemoveText"),runtime.loadClass("ops.OpSplitParagraph"),runtime.loadClass("ops.OpSetParagraphStyle"),runtime.loadClass("ops.OpRemoveAnnotation"),runtime.loadClass("gui.ClickHandler"),runtime.loadClass("gui.Clipboard"),runtime.loadClass("gui.KeyboardHandler"),runtime.loadClass("gui.StyleHelper"),gui.SessionController=function(){return gui.SessionController=function(e,t){function n(e,t,n,o){var r="on"+t,a=!1;e.attachEvent&&(a=e.attachEvent(r,n)),!a&&e.addEventListener&&(e.addEventListener(t,n,!1),a=!0),a&&!o||!e.hasOwnProperty(r)||(e[r]=n)}function o(e,t,n){var o="on"+t;e.detachEvent&&e.detachEvent(o,n),e.removeEventListener&&e.removeEventListener(t,n,!1),e[o]===n&&(e[o]=null)}function r(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function a(e,n){var o=new ops.OpMoveCursor;return o.init({memberid:t,position:e,length:n||0}),o}function i(e,n){var o,r=gui.SelectionMover.createPositionIterator(re.getRootNode()),a=re.getOdfCanvas().getElement();if(o=e,!o)return null;for(;o!==a&&!("urn:webodf:names:cursor"===o.namespaceURI&&"cursor"===o.localName||"urn:webodf:names:editinfo"===o.namespaceURI&&"editinfo"===o.localName);)if(o=o.parentNode,!o)return null;return o!==a&&e!==o&&(e=o.parentNode,n=Array.prototype.indexOf.call(e.childNodes,o)),r.setUnfilteredPosition(e,n),re.getDistanceFromCursor(t,r.container(),r.unfilteredDomOffset())}function s(e){var t=re.getOdfCanvas().getElement(),n=re.getRootNode(),o=0;return t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING||(e=gui.SelectionMover.createPositionIterator(n),e.moveToEnd(),n=e.container(),o=e.unfilteredDomOffset()),{node:n,offset:o}}function l(n){runtime.setTimeout(function(){var o;e:{var r,l,u,c,d=re.getOdfCanvas().getElement(),m=oe.getSelection();if(null===m.anchorNode&&null===m.focusNode){if(o=n.clientX,r=n.clientY,l=re.getDOM(),l.caretRangeFromPoint?(o=l.caretRangeFromPoint(o,r),r={container:o.startContainer,offset:o.startOffset}):l.caretPositionFromPoint?(o=l.caretPositionFromPoint(o,r),r={container:o.offsetNode,offset:o.offset}):r=null,!r){o=null;break e}o=r.container,r=r.offset,l=o,m=r}else o=m.anchorNode,r=m.anchorOffset,l=m.focusNode,m=m.focusOffset;runtime.assert(null!==o&&null!==l,"anchorNode is null or focusNode is null"),u=ae.containsNode(d,o),c=ae.containsNode(d,l),u||c?(u||(u=s(o),o=u.node,r=u.offset),
c||(u=s(l),l=u.node,m=u.offset),d.focus(),o={anchorNode:o,anchorOffset:r,focusNode:l,focusOffset:m}):o=null}null!==o&&(d=i(o.anchorNode,o.anchorOffset),r=o.focusNode===o.anchorNode&&o.focusOffset===o.anchorOffset?d:i(o.focusNode,o.focusOffset),null!==r&&0!==r||null!==d&&0!==d)&&(o=re.getCursorPosition(t),d=a(o+d,r-d),e.enqueue(d))},0)}function u(e){l(e)}function c(){var n,o,r=re.getOdfCanvas().getElement(),i=/[A-Za-z0-9]/,s=0,l=0;if(ae.containsNode(r,oe.getSelection().focusNode)){for(r=gui.SelectionMover.createPositionIterator(re.getRootNode()),n=re.getCursor(t).getNode(),r.setUnfilteredPosition(n,0);r.previousPosition();)if(o=r.getCurrentNode(),o.nodeType===Node.TEXT_NODE){if(o=o.data[r.unfilteredDomOffset()],!i.test(o))break;s-=1}else if(o.namespaceURI!==odf.Namespaces.textns||"span"!==o.localName)break;r.setUnfilteredPosition(n,0);do if(o=r.getCurrentNode(),o.nodeType===Node.TEXT_NODE){if(o=o.data[r.unfilteredDomOffset()],!i.test(o))break;l+=1}else if(o.namespaceURI!==odf.Namespaces.textns||"span"!==o.localName)break;while(r.nextPosition());(0!==s||0!==l)&&(i=re.getCursorPosition(t),s=a(i+s,Math.abs(s)+Math.abs(l)),e.enqueue(s))}}function d(){var n,o,r=re.getOdfCanvas().getElement();ae.containsNode(r,oe.getSelection().focusNode)&&(o=re.getParagraphElement(re.getCursor(t).getNode()),r=re.getDistanceFromCursor(t,o,0),n=gui.SelectionMover.createPositionIterator(re.getRootNode()),n.moveToEndOfNode(o),o=re.getDistanceFromCursor(t,o,n.unfilteredDomOffset()),0!==r||0!==o)&&(n=re.getCursorPosition(t),r=a(n+r,Math.abs(r)+Math.abs(o)),e.enqueue(r))}function m(n){var o=re.getCursorSelection(t),r=re.getCursor(t).getStepCounter();0!==n&&(n=n>0?r.convertForwardStepsBetweenFilters(n,me,fe):-r.convertBackwardStepsBetweenFilters(-n,me,fe),n=o.length+n,e.enqueue(a(o.position,n)))}function f(n){var o=re.getCursorPosition(t),r=re.getCursor(t).getStepCounter();0!==n&&(n=n>0?r.convertForwardStepsBetweenFilters(n,me,fe):-r.convertBackwardStepsBetweenFilters(-n,me,fe),e.enqueue(a(o+n,0)))}function p(){return f(-1),!0}function g(){return f(1),!0}function h(){return m(-1),!0}function y(){return m(1),!0}function b(e,n){var o=re.getParagraphElement(re.getCursor(t).getNode());runtime.assert(Boolean(o),"SessionController: Cursor outside paragraph"),o=re.getCursor(t).getStepCounter().countLinesSteps(e,me),n?m(o):f(o)}function x(){return b(-1,!1),!0}function v(){return b(1,!1),!0}function N(){return b(-1,!0),!0}function C(){return b(1,!0),!0}function S(e,n){var o=re.getCursor(t).getStepCounter().countStepsToLineBoundary(e,me);n?m(o):f(o)}function w(){return S(-1,!1),!0}function E(){return S(1,!1),!0}function T(){return S(-1,!0),!0}function O(){return S(1,!0),!0}function D(){var e,n,o=re.getParagraphElement(re.getCursor(t).getNode());for(runtime.assert(Boolean(o),"SessionController: Cursor outside paragraph"),n=re.getDistanceFromCursor(t,o,0),e=gui.SelectionMover.createPositionIterator(re.getRootNode()),e.setUnfilteredPosition(o,0);0===n&&e.previousPosition();)o=e.getCurrentNode(),ie.isParagraph(o)&&(n=re.getDistanceFromCursor(t,o,0));return m(n),!0}function A(){var e,n,o=re.getParagraphElement(re.getCursor(t).getNode());for(runtime.assert(Boolean(o),"SessionController: Cursor outside paragraph"),e=gui.SelectionMover.createPositionIterator(re.getRootNode()),e.moveToEndOfNode(o),n=re.getDistanceFromCursor(t,e.container(),e.unfilteredDomOffset());0===n&&e.nextPosition();)o=e.getCurrentNode(),ie.isParagraph(o)&&(e.moveToEndOfNode(o),n=re.getDistanceFromCursor(t,e.container(),e.unfilteredDomOffset()));return m(n),!0}function R(e,n){var o=gui.SelectionMover.createPositionIterator(re.getRootNode());e>0&&o.moveToEnd(),o=re.getDistanceFromCursor(t,o.container(),o.unfilteredDomOffset()),n?m(o):f(o)}function P(){return R(-1,!1),!0}function I(){return R(1,!1),!0}function F(){return R(-1,!0),!0}function k(){return R(1,!0),!0}function U(){var n,o=gui.SelectionMover.createPositionIterator(re.getRootNode());return n=-re.getDistanceFromCursor(t,o.container(),o.unfilteredDomOffset()),o.moveToEnd(),n+=re.getDistanceFromCursor(t,o.container(),o.unfilteredDomOffset()),e.enqueue(a(0,n)),!0}function M(e){return 0>e.length&&(e.position+=e.length,e.length=-e.length),e}function B(e){var n=new ops.OpRemoveText;return n.init({memberid:t,position:e.position,length:e.length}),n}function L(){var n=M(re.getCursorSelection(t)),o=null;return 0===n.length?0<n.position&&re.getPositionInTextNode(n.position-1)&&(o=new ops.OpRemoveText,o.init({memberid:t,position:n.position-1,length:1}),e.enqueue(o)):(o=B(n),e.enqueue(o)),!0}function _(){var n=M(re.getCursorSelection(t)),o=null;return 0===n.length?re.getPositionInTextNode(n.position+1)&&(o=new ops.OpRemoveText,o.init({memberid:t,position:n.position,length:1}),e.enqueue(o)):(o=B(n),e.enqueue(o)),null!==o}function X(){var n=M(re.getCursorSelection(t));return 0!==n.length&&e.enqueue(B(n)),!0}function W(n){var o=M(re.getCursorSelection(t)),r=null;0<o.length&&(r=B(o),e.enqueue(r)),r=new ops.OpInsertText,r.init({memberid:t,position:o.position,text:n}),e.enqueue(r)}function H(){var n,o=re.getCursorPosition(t);return n=new ops.OpSplitParagraph,n.init({memberid:t,position:o}),e.enqueue(n),!0}function z(){var e=re.getCursor(t),n=oe.getSelection();e&&(n.removeAllRanges(),n.addRange(e.getSelectedRange().cloneRange()))}function V(n){var o=re.getCursor(t);o.getSelectedRange().collapsed||(se.setDataFromRange(n,o.getSelectedRange())?(o=new ops.OpRemoveText,n=M(e.getOdtDocument().getCursorSelection(t)),o.init({memberid:t,position:n.position,length:n.length}),e.enqueue(o)):runtime.log("Cut operation failed"))}function j(){return!1!==re.getCursor(t).getSelectedRange().collapsed}function q(e){var n=re.getCursor(t);n.getSelectedRange().collapsed||se.setDataFromRange(e,n.getSelectedRange())||runtime.log("Cut operation failed")}function J(e){var t;oe.clipboardData&&oe.clipboardData.getData?t=oe.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),t&&(W(t),e.preventDefault?e.preventDefault():e.returnValue=!1)}function G(){return!1}function K(e){pe&&pe.onOperationExecuted(e)}function Z(e){re.emit(ops.OdtDocument.signalUndoStackChanged,e)}function $(){return pe?(pe.moveBackward(1),z(),!0):!1}function Y(){return pe?(pe.moveForward(1),z(),!0):!1}function Q(n,o){var r=re.getCursorSelection(t),a=new ops.OpApplyDirectStyling,i={};i[n]=o,a.init({memberid:t,position:r.position,length:r.length,setProperties:{"style:text-properties":i}}),e.enqueue(a)}function ee(){var e=re.getCursor(t).getSelectedRange(),e=de.isBold(e)?"normal":"bold";return Q("fo:font-weight",e),!0}function te(){var e=re.getCursor(t).getSelectedRange(),e=de.isItalic(e)?"normal":"italic";return Q("fo:font-style",e),!0}function ne(){var e=re.getCursor(t).getSelectedRange(),e=de.hasUnderline(e)?"none":"solid";return Q("style:text-underline-style",e),!0}var oe=runtime.getWindow(),re=e.getOdtDocument(),ae=new core.DomUtils,ie=new odf.OdfUtils,se=new gui.Clipboard,le=new gui.ClickHandler,ue=new gui.KeyboardHandler,ce=new gui.KeyboardHandler,de=new gui.StyleHelper(re.getFormatting()),me=new core.PositionFilterChain,fe=re.getPositionFilter(),pe=null;runtime.assert(null!==oe,"Expected to be run in an environment which has a global window, like a browser."),me.addFilter("BaseFilter",fe),me.addFilter("RootFilter",re.createRootFilter(t)),this.startEditing=function(){var o;o=re.getOdfCanvas().getElement(),n(o,"keydown",ue.handleEvent),n(o,"keypress",ce.handleEvent),n(o,"keyup",r),n(o,"beforecut",j,!0),n(o,"cut",V),n(o,"copy",q),n(o,"beforepaste",G,!0),n(o,"paste",J),n(oe,"mouseup",le.handleMouseUp),n(o,"contextmenu",u),re.subscribe(ops.OdtDocument.signalOperationExecuted,z),re.subscribe(ops.OdtDocument.signalOperationExecuted,K),o=new ops.OpAddCursor,o.init({memberid:t}),e.enqueue(o),pe&&pe.saveInitialState()},this.endEditing=function(){var n;re.unsubscribe(ops.OdtDocument.signalOperationExecuted,K),re.unsubscribe(ops.OdtDocument.signalOperationExecuted,z),n=re.getOdfCanvas().getElement(),o(n,"keydown",ue.handleEvent),o(n,"keypress",ce.handleEvent),o(n,"keyup",r),o(n,"cut",V),o(n,"beforecut",j),o(n,"copy",q),o(n,"paste",J),o(n,"beforepaste",G),o(oe,"mouseup",le.handleMouseUp),o(n,"contextmenu",u),n=new ops.OpRemoveCursor,n.init({memberid:t}),e.enqueue(n),pe&&pe.resetInitialState()},this.getInputMemberId=function(){return t},this.getSession=function(){return e},this.setUndoManager=function(e){pe&&pe.unsubscribe(gui.UndoManager.signalUndoStackChanged,Z),(pe=e)&&(pe.setOdtDocument(re),pe.setPlaybackFunction(function(e){e.execute(re)}),pe.subscribe(gui.UndoManager.signalUndoStackChanged,Z))},this.getUndoManager=function(){return pe},function(){var n=-1!==oe.navigator.appVersion.toLowerCase().indexOf("mac"),o=gui.KeyboardHandler.Modifier,r=gui.KeyboardHandler.KeyCode;ue.bind(r.Tab,o.None,function(){return W("	"),!0}),ue.bind(r.Left,o.None,p),ue.bind(r.Right,o.None,g),ue.bind(r.Up,o.None,x),ue.bind(r.Down,o.None,v),ue.bind(r.Backspace,o.None,L),ue.bind(r.Delete,o.None,_),ue.bind(r.Left,o.Shift,h),ue.bind(r.Right,o.Shift,y),ue.bind(r.Up,o.Shift,N),ue.bind(r.Down,o.Shift,C),ue.bind(r.Home,o.None,w),ue.bind(r.End,o.None,E),ue.bind(r.Home,o.Ctrl,P),ue.bind(r.End,o.Ctrl,I),ue.bind(r.Home,o.Shift,T),ue.bind(r.End,o.Shift,O),ue.bind(r.Up,o.CtrlShift,D),ue.bind(r.Down,o.CtrlShift,A),ue.bind(r.Home,o.CtrlShift,F),ue.bind(r.End,o.CtrlShift,k),n?(ue.bind(r.Clear,o.None,X),ue.bind(r.Left,o.Meta,w),ue.bind(r.Right,o.Meta,E),ue.bind(r.Home,o.Meta,P),ue.bind(r.End,o.Meta,I),ue.bind(r.Left,o.MetaShift,T),ue.bind(r.Right,o.MetaShift,O),ue.bind(r.Up,o.AltShift,D),ue.bind(r.Down,o.AltShift,A),ue.bind(r.Up,o.MetaShift,F),ue.bind(r.Down,o.MetaShift,k),ue.bind(r.A,o.Meta,U),ue.bind(r.B,o.Meta,ee),ue.bind(r.I,o.Meta,te),ue.bind(r.U,o.Meta,ne),ue.bind(r.Z,o.Meta,$),ue.bind(r.Z,o.MetaShift,Y)):(ue.bind(r.A,o.Ctrl,U),ue.bind(r.B,o.Ctrl,ee),ue.bind(r.I,o.Ctrl,te),ue.bind(r.U,o.Ctrl,ne),ue.bind(r.Z,o.Ctrl,$),ue.bind(r.Z,o.CtrlShift,Y)),ce.setDefault(function(e){var t;return t=null===e.which?String.fromCharCode(e.keyCode):0!==e.which&&0!==e.charCode?String.fromCharCode(e.which):null,!t||e.altKey||e.ctrlKey||e.metaKey?!1:(W(t),!0)}),ce.bind(r.Enter,o.None,H),le.subscribe(gui.ClickHandler.signalSingleClick,function(n){var o=n.target,r=null;if("annotationRemoveButton"===o.className){n=r=ae.getElementsByTagNameNS(o.parentNode,odf.Namespaces.officens,"annotation")[0];for(var o=0,r=gui.SelectionMover.createPositionIterator(re.getRootNode()),a=new core.LoopWatchDog(1e3),i=!1;r.nextPosition();)if(a.check(),i=Boolean(n.compareDocumentPosition(r.container())&Node.DOCUMENT_POSITION_CONTAINED_BY),1===fe.acceptPosition(r)){if(i)break;o+=1}r=0,a=gui.SelectionMover.createPositionIterator(re.getRootNode()),i=!1,a.setUnfilteredPosition(n,0);do{if(i=Boolean(n.compareDocumentPosition(a.container())&Node.DOCUMENT_POSITION_CONTAINED_BY),!i&&n!==a.container())break;1===fe.acceptPosition(a)&&(r+=1)}while(a.nextPosition());n=r,r=new ops.OpRemoveAnnotation,r.init({memberid:t,position:o,length:n}),e.enqueue(r)}else l(n)}),le.subscribe(gui.ClickHandler.signalDoubleClick,c),le.subscribe(gui.ClickHandler.signalTripleClick,d)}()},gui.SessionController}(),ops.MemberModel=function(){},ops.MemberModel.prototype.getMemberDetailsAndUpdates=function(e,t){},ops.MemberModel.prototype.unsubscribeMemberDetailsUpdates=function(e,t){},ops.TrivialMemberModel=function(){this.getMemberDetailsAndUpdates=function(e,t){t(e,null)},this.unsubscribeMemberDetailsUpdates=function(e,t){}},ops.OperationRouter=function(){},ops.OperationRouter.prototype.setOperationFactory=function(e){},ops.OperationRouter.prototype.setPlaybackFunction=function(e){},ops.OperationRouter.prototype.push=function(e){},ops.TrivialOperationRouter=function(){var e,t;this.setOperationFactory=function(t){e=t},this.setPlaybackFunction=function(e){t=e},this.push=function(n){n=n.spec(),n.timestamp=(new Date).getTime(),n=e.create(n),t(n)}},gui.EditInfoHandle=function(e){var t,n=[],o=e.ownerDocument,r=o.documentElement.namespaceURI;this.setEdits=function(e){n=e;var a,i,s,l;for(t.innerHTML="",e=0;e<n.length;e+=1)a=o.createElementNS(r,"div"),a.className="editInfo",i=o.createElementNS(r,"span"),i.className="editInfoColor",i.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",n[e].memberid),s=o.createElementNS(r,"span"),s.className="editInfoAuthor",s.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",n[e].memberid),l=o.createElementNS(r,"span"),l.className="editInfoTime",l.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",n[e].memberid),l.innerHTML=n[e].time,a.appendChild(i),a.appendChild(s),a.appendChild(l),t.appendChild(a)},this.show=function(){t.style.display="block"},this.hide=function(){t.style.display="none"},t=o.createElementNS(r,"div"),t.setAttribute("class","editInfoHandle"),t.style.display="none",e.appendChild(t)},runtime.loadClass("ops.EditInfo"),runtime.loadClass("gui.EditInfoHandle"),gui.EditInfoMarker=function(e,t){function n(e,t){return runtime.getWindow().setTimeout(function(){a.style.opacity=e},t)}var o,r,a,i,s,l=this;this.addEdit=function(t,o){var l=Date.now()-o;if(e.addEdit(t,o),r.setEdits(e.getSortedEdits()),a.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",t),i){var u=i;runtime.getWindow().clearTimeout(u)}s&&(u=s,runtime.getWindow().clearTimeout(u)),1e4>l?(n(1,0),i=n(.5,1e4-l),s=n(.2,2e4-l)):l>=1e4&&2e4>l?(n(.5,0),s=n(.2,2e4-l)):n(.2,0)},this.getEdits=function(){return e.getEdits()},this.clearEdits=function(){e.clearEdits(),r.setEdits([]),a.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&a.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")},this.getEditInfo=function(){return e},this.show=function(){a.style.display="block"},this.hide=function(){l.hideHandle(),a.style.display="none"},this.showHandle=function(){r.show()},this.hideHandle=function(){r.hide()},function(){var n=e.getOdtDocument().getDOM();a=n.createElementNS(n.documentElement.namespaceURI,"div"),a.setAttribute("class","editInfoMarker"),a.onmouseover=function(){l.showHandle()},a.onmouseout=function(){l.hideHandle()},o=e.getNode(),o.appendChild(a),r=new gui.EditInfoHandle(o),t||l.hide()}()},runtime.loadClass("gui.Caret"),runtime.loadClass("ops.TrivialMemberModel"),runtime.loadClass("ops.EditInfo"),runtime.loadClass("gui.EditInfoMarker"),gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0},gui.SessionView=function(){return function(e,t,n){function o(e,t,n){function o(t,n,o){n=t+'[editinfo|memberid^="'+e+'"]'+o+n;e:{var r=u.firstChild;for(t=t+'[editinfo|memberid^="'+e+'"]'+o;r;){if(r.nodeType===Node.TEXT_NODE&&0===r.data.indexOf(t)){t=r;break e}r=r.nextSibling}t=null}t?t.data=n:u.appendChild(document.createTextNode(n))}o("div.editInfoMarker","{ background-color: "+n+"; }",""),o("span.editInfoColor","{ background-color: "+n+"; }",""),o("span.editInfoAuthor",'{ content: "'+t+'"; }',":before"),o("dc|creator",'{ content: "'+t+'"; display: none;}',":before"),o("dc|creator","{ background-color: "+n+"; }","")}function r(e){var t,n;for(n in c)c.hasOwnProperty(n)&&(t=c[n],e?t.show():t.hide())}function a(e){n.getCarets().forEach(function(t){e?t.showHandle():t.hideHandle()})}function i(e,t){var r=n.getCaret(e);void 0===t?runtime.log('MemberModel sent undefined data for member "'+e+'".'):(null===t&&(t={memberid:e,fullname:"Unknown Identity",color:"black",imageurl:"avatar-joe.png"}),r&&(r.setAvatarImageUrl(t.imageurl),r.setColor(t.color)),o(e,t.fullname,t.color))}function s(e){var o=e.getMemberId(),r=t.getMemberModel();n.registerCursor(e,m,f),i(o,null),r.getMemberDetailsAndUpdates(o,i),runtime.log("+++ View here +++ eagerly created an Caret for '"+o+"'! +++")}function l(e){var n,o=!1;for(n in c)if(c.hasOwnProperty(n)&&c[n].getEditInfo().getEdits().hasOwnProperty(e)){o=!0;break}o||t.getMemberModel().unsubscribeMemberDetailsUpdates(e,i)}var u,c={},d=void 0!==e.editInfoMarkersInitiallyVisible?Boolean(e.editInfoMarkersInitiallyVisible):!0,m=void 0!==e.caretAvatarsInitiallyVisible?Boolean(e.caretAvatarsInitiallyVisible):!0,f=void 0!==e.caretBlinksOnRangeSelect?Boolean(e.caretBlinksOnRangeSelect):!0;this.showEditInfoMarkers=function(){d||(d=!0,r(d))},this.hideEditInfoMarkers=function(){d&&(d=!1,r(d))},this.showCaretAvatars=function(){m||(m=!0,a(m))},this.hideCaretAvatars=function(){m&&(m=!1,a(m))},this.getSession=function(){return t},this.getCaret=function(e){return n.getCaret(e)},function(){var e=t.getOdtDocument(),n=document.getElementsByTagName("head")[0];e.subscribe(ops.OdtDocument.signalCursorAdded,s),e.subscribe(ops.OdtDocument.signalCursorRemoved,l),e.subscribe(ops.OdtDocument.signalParagraphChanged,function(e){var n=e.paragraphElement,o=e.memberId;e=e.timeStamp;var r,a="",i=n.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo")[0];i?(a=i.getAttributeNS("urn:webodf:names:editinfo","id"),r=c[a]):(a=Math.random().toString(),r=new ops.EditInfo(n,t.getOdtDocument()),r=new gui.EditInfoMarker(r,d),i=n.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo")[0],i.setAttributeNS("urn:webodf:names:editinfo","id",a),c[a]=r),r.addEdit(o,new Date(e))}),u=document.createElementNS(n.namespaceURI,"style"),u.type="text/css",u.media="screen, print, handheld, projection",u.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);")),u.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);")),n.appendChild(u)}()}}(),runtime.loadClass("gui.Caret"),gui.CaretManager=function(e){function t(e){return l.hasOwnProperty(e)?l[e]:null}function n(){return e.getSession().getOdtDocument().getOdfCanvas().getElement()}function o(t){t===e.getInputMemberId()&&n().removeAttribute("tabindex"),delete l[t]}function r(n){n=n.getMemberId(),n===e.getInputMemberId()&&(n=t(n))&&n.refreshCursorBlinking()}function a(n){n.memberId===e.getInputMemberId()&&(n=t(n.memberId))&&n.ensureVisible()}function i(){var n=t(e.getInputMemberId());n&&n.setFocus()}function s(){var n=t(e.getInputMemberId());n&&n.removeFocus()}var l={};this.registerCursor=function(t,o,r){var a=t.getMemberId(),i=n();return o=new gui.Caret(t,o,r),l[a]=o,a===e.getInputMemberId()&&(runtime.log("Starting to track input on new cursor of "+a),t.handleUpdate=o.ensureVisible,i.setAttribute("tabindex",0),i.focus()),o},this.getCaret=t,this.getCarets=function(){return Object.keys(l).map(function(e){return l[e]})},function(){var t=e.getSession().getOdtDocument(),l=n();t.subscribe(ops.OdtDocument.signalParagraphChanged,a),t.subscribe(ops.OdtDocument.signalCursorMoved,r),t.subscribe(ops.OdtDocument.signalCursorRemoved,o),l.onfocus=i,l.onblur=s}()},runtime.loadClass("xmldom.XPath"),runtime.loadClass("odf.Namespaces"),gui.PresenterUI=function(){var e=new xmldom.XPath,t=runtime.getWindow();return function(n){var o=this;o.setInitialSlideMode=function(){o.startSlideMode("single")},o.keyDownHandler=function(e){if(!e.target.isContentEditable&&"input"!==e.target.nodeName)switch(e.keyCode){case 84:o.toggleToolbar();break;case 37:case 8:o.prevSlide();break;case 39:case 32:o.nextSlide();break;case 36:o.firstSlide();break;case 35:o.lastSlide()}},o.root=function(){return o.odf_canvas.odfContainer().rootElement},o.firstSlide=function(){o.slideChange(function(e,t){return 0})},o.lastSlide=function(){o.slideChange(function(e,t){return t-1})},o.nextSlide=function(){o.slideChange(function(e,t){return t>e+1?e+1:-1})},o.prevSlide=function(){o.slideChange(function(e,t){return 1>e?-1:e-1})},o.slideChange=function(e){var n=o.getPages(o.odf_canvas.odfContainer().rootElement),r=-1,a=0;n.forEach(function(e){e=e[1],e.hasAttribute("slide_current")&&(r=a,e.removeAttribute("slide_current")),a+=1}),e=e(r,n.length),-1===e&&(e=r),n[e][1].setAttribute("slide_current","1"),document.getElementById("pagelist").selectedIndex=e,"cont"===o.slide_mode&&t.scrollBy(0,n[e][1].getBoundingClientRect().top-30)},o.selectSlide=function(e){o.slideChange(function(t,n){return e>=n||0>e?-1:e})},o.scrollIntoContView=function(e){var n=o.getPages(o.odf_canvas.odfContainer().rootElement);0!==n.length&&t.scrollBy(0,n[e][1].getBoundingClientRect().top-30)},o.getPages=function(e){e=e.getElementsByTagNameNS(odf.Namespaces.drawns,"page");var t,n=[];for(t=0;t<e.length;t+=1)n.push([e[t].getAttribute("draw:name"),e[t]]);return n},o.fillPageList=function(t,n){for(var r,a,i,s=o.getPages(t);n.firstChild;)n.removeChild(n.firstChild);for(r=0;r<s.length;r+=1)a=document.createElement("option"),i=e.getODFElementsWithXPath(s[r][1],'./draw:frame[@presentation:class="title"]//draw:text-box/text:p',xmldom.XPath),i=0<i.length?i[0].textContent:s[r][0],a.textContent=r+1+": "+i,n.appendChild(a)},o.startSlideMode=function(e){var n=document.getElementById("pagelist"),r=o.odf_canvas.slidevisibilitycss().sheet;for(o.slide_mode=e;0<r.cssRules.length;)r.deleteRule(0);o.selectSlide(0),"single"===o.slide_mode?(r.insertRule("draw|page { position:fixed; left:0px;top:30px; z-index:1; }",0),r.insertRule("draw|page[slide_current]  { z-index:2;}",1),r.insertRule("draw|page  { -webkit-transform: scale(1);}",2),o.fitToWindow(),t.addEventListener("resize",o.fitToWindow,!1)):"cont"===o.slide_mode&&t.removeEventListener("resize",o.fitToWindow,!1),o.fillPageList(o.odf_canvas.odfContainer().rootElement,n)},o.toggleToolbar=function(){var e,t,n;for(e=o.odf_canvas.slidevisibilitycss().sheet,t=-1,n=0;n<e.cssRules.length;n+=1)if(".toolbar"===e.cssRules[n].cssText.substring(0,8)){t=n;break}t>-1?e.deleteRule(t):e.insertRule(".toolbar { position:fixed; left:0px;top:-200px; z-index:0; }",0)},o.fitToWindow=function(){var e=o.getPages(o.root()),n=(t.innerHeight-40)/e[0][1].clientHeight,e=(t.innerWidth-10)/e[0][1].clientWidth,n=e>n?n:e,e=o.odf_canvas.slidevisibilitycss().sheet;e.deleteRule(2),e.insertRule("draw|page { \n-moz-transform: scale("+n+"); \n-moz-transform-origin: 0% 0%; -webkit-transform-origin: 0% 0%; -webkit-transform: scale("+n+"); -o-transform-origin: 0% 0%; -o-transform: scale("+n+"); -ms-transform-origin: 0% 0%; -ms-transform: scale("+n+"); }",2)},o.load=function(e){o.odf_canvas.load(e)},o.odf_element=n,o.odf_canvas=new odf.OdfCanvas(o.odf_element),o.odf_canvas.addListener("statereadychange",o.setInitialSlideMode),o.slide_mode="undefined",document.addEventListener("keydown",o.keyDownHandler,!1)}}(),runtime.loadClass("core.PositionIterator"),runtime.loadClass("core.Cursor"),gui.XMLEdit=function(e,t){function n(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}function o(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function r(){var t=e.ownerDocument.defaultView.getSelection();!t||0>=t.rangeCount||!p||(t=t.getRangeAt(0),p.setPoint(t.startContainer,t.startOffset))}function a(){var t,n,o=e.ownerDocument.defaultView.getSelection();o.removeAllRanges(),p&&p.node()&&(t=p.node(),n=t.ownerDocument.createRange(),n.setStart(t,p.position()),n.collapse(!0),o.addRange(n))}function i(e){var t=e.charCode||e.keyCode;if(p=null,p&&37===t)r(),p.stepBackward(),a();else if(t>=16&&20>=t||t>=33&&40>=t)return;o(e)}function s(e){o(e)}function l(e){for(var t=e.firstChild;t&&t!==e;)t.nodeType===Node.ELEMENT_NODE&&l(t),t=t.nextSibling||t.parentNode;var n,o,r,t=e.attributes;for(n="",r=t.length-1;r>=0;r-=1)o=t.item(r),n=n+" "+o.nodeName+'="'+o.nodeValue+'"';for(e.setAttribute("customns_name",e.nodeName),e.setAttribute("customns_atts",n),t=e.firstChild,o=/^\s*$/;t&&t!==e;)n=t,t=t.nextSibling||t.parentNode,n.nodeType===Node.TEXT_NODE&&o.test(n.nodeValue)&&n.parentNode.removeChild(n)}function u(e,t){for(var n,o,r,a=e.firstChild;a&&a!==e;){if(a.nodeType===Node.ELEMENT_NODE)for(u(a,t),n=a.attributes,r=n.length-1;r>=0;r-=1)o=n.item(r),"http://www.w3.org/2000/xmlns/"!==o.namespaceURI||t[o.nodeValue]||(t[o.nodeValue]=o.localName);a=a.nextSibling||a.parentNode}}function c(){var n,o=e.ownerDocument.createElement("style");n={},u(e,n);var r,a,i={},s=0;for(r in n)if(n.hasOwnProperty(r)&&r){if(a=n[r],!a||i.hasOwnProperty(a)||"xmlns"===a){do a="ns"+s,s+=1;while(i.hasOwnProperty(a));n[r]=a}i[a]=!0}o.type="text/css",n="@namespace customns url(customns);\n"+d,o.appendChild(e.ownerDocument.createTextNode(n)),t=t.parentNode.replaceChild(o,t)}var d,m,f,p=null;e.id||(e.id="xml"+String(Math.random()).substring(2)),m="#"+e.id+" ",d=m+"*,"+m+":visited, "+m+":link {display:block; margin: 0px; margin-left: 10px; font-size: medium; color: black; background: white; font-variant: normal; font-weight: normal; font-style: normal; font-family: sans-serif; text-decoration: none; white-space: pre-wrap; height: auto; width: auto}\n"+m+":before {color: blue; content: '<' attr(customns_name) attr(customns_atts) '>';}\n"+m+":after {color: blue; content: '</' attr(customns_name) '>';}\n"+m+"{overflow: auto;}\n",function(e){n(e,"click",s),n(e,"keydown",i),n(e,"drop",o),n(e,"dragend",o),n(e,"beforepaste",o),n(e,"paste",o)}(e),this.updateCSS=c,this.setXML=function(t){for(t=t.documentElement||t,f=t=e.ownerDocument.importNode(t,!0),l(t);e.lastChild;)e.removeChild(e.lastChild);e.appendChild(t),c(),p=new core.PositionIterator(t)},this.getXML=function(){return f}},gui.UndoManager=function(){},gui.UndoManager.prototype.subscribe=function(e,t){},gui.UndoManager.prototype.unsubscribe=function(e,t){},gui.UndoManager.prototype.setOdtDocument=function(e){},gui.UndoManager.prototype.saveInitialState=function(){},gui.UndoManager.prototype.resetInitialState=function(){},gui.UndoManager.prototype.setPlaybackFunction=function(e){},gui.UndoManager.prototype.hasUndoStates=function(){},gui.UndoManager.prototype.hasRedoStates=function(){},gui.UndoManager.prototype.moveForward=function(e){},gui.UndoManager.prototype.moveBackward=function(e){},gui.UndoManager.prototype.onOperationExecuted=function(e){},gui.UndoManager.signalUndoStackChanged="undoStackChanged",gui.UndoManager.signalUndoStateCreated="undoStateCreated",gui.UndoManager.signalUndoStateModified="undoStateModified",function(){return gui.UndoManager}(),gui.UndoStateRules=function(){function e(e){return e.spec().optype}function t(t){switch(e(t)){case"MoveCursor":case"AddCursor":case"RemoveCursor":return!1;default:return!0}}this.getOpType=e,this.isEditOperation=t,this.isPartOfOperationSet=function(n,o){if(t(n)){if(0===o.length)return!0;var r;if(r=t(o[o.length-1]))e:{r=o.filter(t);var a,i=e(n);t:switch(i){case"RemoveText":case"InsertText":a=!0;break t;default:a=!1}if(a&&i===e(r[0])){if(1===r.length){r=!0;break e}if(i=r[r.length-2].spec().position,r=r[r.length-1].spec().position,a=n.spec().position,r===a-(r-i)){r=!0;break e}}r=!1}return r}return!0}},runtime.loadClass("core.DomUtils"),runtime.loadClass("gui.UndoManager"),runtime.loadClass("gui.UndoStateRules"),gui.TrivialUndoManager=function(e){function t(){g.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:u.hasUndoStates(),redoAvailable:u.hasRedoStates()})}function n(){m!==d&&m!==f[f.length-1]&&f.push(m)}function o(e){var t=e.previousSibling||e.nextSibling;e.parentNode.removeChild(e),c.normalizeTextNodes(t)}function r(e){return Object.keys(e).map(function(t){return e[t]})}function a(e){function t(e){var t=e.spec();if(i[t.memberid])switch(t.optype){case"AddCursor":o[t.memberid]||(o[t.memberid]=e,delete i[t.memberid],n-=1);break;case"MoveCursor":a[t.memberid]||(a[t.memberid]=e)}}var n,o={},a={},i={},s=e.pop();for(l.getCursors().forEach(function(e){i[e.getMemberId()]=!0}),n=Object.keys(i).length;s&&n>0;)s.reverse(),s.forEach(t),s=e.pop();return r(o).concat(r(a))}var i,s,l,u=this,c=new core.DomUtils,d=[],m=[],f=[],p=[],g=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.TrivialUndoManager.signalDocumentRootReplaced]),h=e||new gui.UndoStateRules;this.subscribe=function(e,t){g.subscribe(e,t)},this.unsubscribe=function(e,t){g.unsubscribe(e,t)},this.hasUndoStates=function(){return 0<f.length},this.hasRedoStates=function(){return 0<p.length},this.setOdtDocument=function(e){l=e},this.resetInitialState=function(){f.length=0,p.length=0,d.length=0,m.length=0,i=null,t()},this.saveInitialState=function(){var e=l.getOdfCanvas().odfContainer(),r=l.getOdfCanvas().getAnnotationManager();r&&r.forgetAnnotations(),i=e.rootElement.cloneNode(!0),l.getOdfCanvas().refreshAnnotations(),e=i,c.getElementsByTagNameNS(e,"urn:webodf:names:cursor","cursor").forEach(o),c.getElementsByTagNameNS(e,"urn:webodf:names:cursor","anchor").forEach(o),n(),f.unshift(d),m=d=a(f),f.length=0,p.length=0,t()},this.setPlaybackFunction=function(e){s=e},this.onOperationExecuted=function(e){p.length=0,h.isEditOperation(e)&&m===d||!h.isPartOfOperationSet(e,m)?(n(),m=[e],f.push(m),g.emit(gui.UndoManager.signalUndoStateCreated,{operations:m}),t()):(m.push(e),g.emit(gui.UndoManager.signalUndoStateModified,{operations:m}))},this.moveForward=function(e){for(var n,o=0;e&&p.length;)n=p.pop(),f.push(n),n.forEach(s),e-=1,o+=1;return o&&(m=f[f.length-1],t()),o},this.moveBackward=function(e){for(var n=l.getOdfCanvas(),o=n.odfContainer(),r=0;e&&f.length;)p.push(f.pop()),e-=1,r+=1;return r&&(o.setRootElement(i.cloneNode(!0)),n.setOdfContainer(o,!0),g.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),l.getCursors().forEach(function(e){l.removeCursor(e.getMemberId())}),d.forEach(s),f.forEach(function(e){e.forEach(s)}),n.refreshCSS(),m=f[f.length-1]||d,t()),r}},gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced",function(){return gui.TrivialUndoManager}(),runtime.loadClass("core.EventNotifier"),runtime.loadClass("odf.OdfUtils"),runtime.loadClass("gui.SelectionMover"),runtime.loadClass("gui.StyleHelper"),runtime.loadClass("core.PositionFilterChain"),ops.OdtDocument=function(e){function t(){var t=e.odfContainer().getContentElement(),n=t&&t.localName;return runtime.assert("text"===n,"Unsupported content element type '"+n+"'for OdtDocument"),t}function n(e){function t(e){for(;!(e.namespaceURI===odf.Namespaces.officens&&"text"===e.localName||e.namespaceURI===odf.Namespaces.officens&&"annotation"===e.localName);)e=e.parentNode;return e}this.acceptPosition=function(n){n=n.container();var o=u[e].getNode();return t(n)===t(o)?d:m}}function o(e){var n=gui.SelectionMover.createPositionIterator(t());for(e+=1;e>0&&n.nextPosition();)1===s.acceptPosition(n)&&(e-=1);return n}function r(e){return i.getParagraphElement(e)}function a(t){return e.getFormatting().getStyleElement(t,"paragraph")}var i,s,l=this,u={},c=new core.EventNotifier([ops.OdtDocument.signalCursorAdded,ops.OdtDocument.signalCursorRemoved,ops.OdtDocument.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalStyleCreated,ops.OdtDocument.signalStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationExecuted,ops.OdtDocument.signalUndoStackChanged]),d=core.PositionFilter.FilterResult.FILTER_ACCEPT,m=core.PositionFilter.FilterResult.FILTER_REJECT;this.getIteratorAtPosition=o,this.upgradeWhitespacesAtPosition=function(e){e=o(e);var t,n,r;for(e.previousPosition(),e.previousPosition(),r=-1;1>=r;r+=1){if(t=e.container(),n=e.unfilteredDomOffset(),t.nodeType===Node.TEXT_NODE&&" "===t.data[n]&&i.isSignificantWhitespace(t,n)){runtime.assert(" "===t.data[n],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var a=t.ownerDocument.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s");a.appendChild(t.ownerDocument.createTextNode(" ")),t.deleteData(n,1),n>0&&(t=t.splitText(n)),t.parentNode.insertBefore(a,t),t=a,e.moveToEndOfNode(t)}e.nextPosition()}},this.getParagraphStyleElement=a,this.getParagraphElement=r,this.getParagraphStyleAttributes=function(t){return(t=a(t))?e.getFormatting().getInheritedStyleAttributes(t):null},this.getPositionInTextNode=function(e,n){var o,r=gui.SelectionMover.createPositionIterator(t()),a=null,i=0,c=null,d=e;for(runtime.assert(e>=0,"position must be >= 0"),1===s.acceptPosition(r)?(o=r.container(),o.nodeType===Node.TEXT_NODE&&(a=o,i=0)):e+=1;e>0||null===a;){if(!r.nextPosition())return null;

if(1===s.acceptPosition(r))if(e-=1,o=r.container(),o.nodeType===Node.TEXT_NODE)o!==a?(a=o,i=r.domOffset()):i+=1;else if(null!==a){if(0===e){i=a.length;break}a=null}else if(0===e){a=t().ownerDocument.createTextNode(""),o.insertBefore(a,r.rightNode()),i=0;break}}if(null===a)return null;if(n&&u[n]&&l.getCursorPosition(n)===d){for(c=u[n].getNode();0===i&&c.nextSibling&&"cursor"===c.nextSibling.localName;)c.parentNode.insertBefore(c,c.nextSibling.nextSibling);c&&0<a.length&&(a=t().ownerDocument.createTextNode(""),i=0,c.parentNode.insertBefore(a,c.nextSibling))}for(;0===i&&a.previousSibling&&"cursor"===a.previousSibling.localName&&(o=a.previousSibling,0<a.length&&(a=t().ownerDocument.createTextNode("")),o.parentNode.insertBefore(a,o),c!==o););for(;a.previousSibling&&a.previousSibling.nodeType===Node.TEXT_NODE;)a.previousSibling.appendData(a.data),i=a.length+a.previousSibling.length,a=a.previousSibling,a.parentNode.removeChild(a.nextSibling);return{textNode:a,offset:i}},this.fixCursorPositions=function(e){var t,n,o,r=new core.PositionFilterChain;r.addFilter("BaseFilter",l.getPositionFilter());for(t in u)u.hasOwnProperty(t)&&(r.addFilter("RootFilter",l.createRootFilter(t)),n=u[t],o=n.getStepCounter(),o.isPositionWalkable(r)?0===l.getCursorSelection(t).length&&n.move(0):(o=o.countStepsToValidPosition(r),n.move(o),t===e&&l.emit(ops.OdtDocument.signalCursorMoved,n)),r.removeFilter("RootFilter"))},this.getWalkableParagraphLength=function(e){var t=o(0),n=0;t.setUnfilteredPosition(e,0);do{if(r(t.container())!==e)break;1===s.acceptPosition(t)&&(n+=1)}while(t.nextPosition());return n},this.getDistanceFromCursor=function(e,t,n){e=u[e];var o=0;return runtime.assert(null!==t&&void 0!==t,"OdtDocument.getDistanceFromCursor called without node"),e&&(e=e.getStepCounter().countStepsToPosition,o=e(t,n,s)),o},this.getCursorPosition=function(e){return-l.getDistanceFromCursor(e,t(),0)},this.getCursorSelection=function(e){var n;e=u[e];var o=0;return n=0,e&&(n=e.getStepCounter().countStepsToPosition,o=-n(t(),0,s),n=n(e.getAnchorNode(),0,s)),{position:o+n,length:-n}},this.getPositionFilter=function(){return s},this.getOdfCanvas=function(){return e},this.getRootNode=t,this.getDOM=function(){return t().ownerDocument},this.getCursor=function(e){return u[e]},this.getCursors=function(){var e,t=[];for(e in u)u.hasOwnProperty(e)&&t.push(u[e]);return t},this.addCursor=function(e){runtime.assert(Boolean(e),"OdtDocument::addCursor without cursor");var t=e.getStepCounter().countForwardSteps(1,s),n=e.getMemberId();runtime.assert(Boolean(n),"OdtDocument::addCursor has cursor without memberid"),runtime.assert(!u[n],"OdtDocument::addCursor is adding a duplicate cursor with memberid "+n),e.move(t),u[n]=e},this.removeCursor=function(e){var t=u[e];return t?(t.removeFromOdtDocument(),delete u[e],l.emit(ops.OdtDocument.signalCursorRemoved,e),!0):!1},this.getMetaData=function(t){for(var n=e.odfContainer().rootElement.firstChild;n&&"meta"!==n.localName;)n=n.nextSibling;for(n=n&&n.firstChild;n&&n.localName!==t;)n=n.nextSibling;for(n=n&&n.firstChild;n&&n.nodeType!==Node.TEXT_NODE;)n=n.nextSibling;return n?n.data:null},this.getFormatting=function(){return e.getFormatting()},this.getTextElements=function(e,t){return i.getTextElements(e,t)},this.getParagraphElements=function(e){return i.getParagraphElements(e)},this.emit=function(e,t){c.emit(e,t)},this.subscribe=function(e,t){c.subscribe(e,t)},this.unsubscribe=function(e,t){c.unsubscribe(e,t)},this.createRootFilter=function(e){return new n(e)},s=new function(){function e(e,t,n){var o,r;return t&&(o=i.lookLeftForCharacter(t),1===o||2===o&&(i.scanRightForAnyCharacter(n)||i.scanRightForAnyCharacter(i.nextNode(e))))?d:(o=null===t&&i.isParagraph(e),r=i.lookRightForCharacter(n),o?r?d:i.scanRightForAnyCharacter(n)?m:d:r?(t=t||i.previousNode(e),i.scanLeftForAnyCharacter(t)?m:d):m)}this.acceptPosition=function(n){var o,r,a,s=n.container(),l=s.nodeType;if(l!==Node.ELEMENT_NODE&&l!==Node.TEXT_NODE)return m;if(l===Node.TEXT_NODE){if(!i.isGroupingElement(s.parentNode)||i.isWithinTrackedChanges(s.parentNode,t()))return m;if(l=n.unfilteredDomOffset(),o=s.data,runtime.assert(l!==o.length,"Unexpected offset."),l>0){if(n=o.substr(l-1,1),!i.isODFWhitespace(n))return d;if(l>1)if(n=o.substr(l-2,1),i.isODFWhitespace(n)){if(!i.isODFWhitespace(o.substr(0,l)))return m}else r=d;else a=i.previousNode(s),i.scanLeftForNonWhitespace(a)&&(r=d);return r===d?i.isTrailingWhitespace(s,l)?m:d:(r=o.substr(l,1),i.isODFWhitespace(r)?m:i.scanLeftForAnyCharacter(i.previousNode(s))?m:d)}a=n.leftNode(),r=s,s=s.parentNode,r=e(s,a,r)}else!i.isGroupingElement(s)||i.isWithinTrackedChanges(s,t())?r=m:(a=n.leftNode(),r=n.rightNode(),r=e(s,a,r));return r}},i=new odf.OdfUtils},ops.OdtDocument.signalCursorAdded="cursor/added",ops.OdtDocument.signalCursorRemoved="cursor/removed",ops.OdtDocument.signalCursorMoved="cursor/moved",ops.OdtDocument.signalParagraphChanged="paragraph/changed",ops.OdtDocument.signalTableAdded="table/added",ops.OdtDocument.signalStyleCreated="style/created",ops.OdtDocument.signalStyleDeleted="style/deleted",ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified",ops.OdtDocument.signalOperationExecuted="operation/executed",ops.OdtDocument.signalUndoStackChanged="undo/changed",function(){return ops.OdtDocument}(),runtime.loadClass("ops.TrivialMemberModel"),runtime.loadClass("ops.TrivialOperationRouter"),runtime.loadClass("ops.OperationFactory"),runtime.loadClass("ops.OdtDocument"),ops.Session=function(e){var t=new ops.OperationFactory,n=new ops.OdtDocument(e),o=new ops.TrivialMemberModel,r=null;this.setMemberModel=function(e){o=e},this.setOperationFactory=function(e){t=e,r&&r.setOperationFactory(t)},this.setOperationRouter=function(e){r=e,e.setPlaybackFunction(function(e){e.execute(n),n.emit(ops.OdtDocument.signalOperationExecuted,e)}),e.setOperationFactory(t)},this.getMemberModel=function(){return o},this.getOperationFactory=function(){return t},this.getOdtDocument=function(){return n},this.enqueue=function(e){r.push(e)},this.setOperationRouter(new ops.TrivialOperationRouter)};var webodf_css="@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);\n@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);\n@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);\n@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);\n@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);\n@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);\n@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);\n@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);\n@namespace runtimens url(urn:webodf); /* namespace for runtime only */\n@namespace cursor url(urn:webodf:names:cursor);\n@namespace editinfo url(urn:webodf:names:editinfo);\n@namespace annotation url(urn:webodf:names:annotation);\n@namespace dc url(http://purl.org/dc/elements/1.1/);\n\noffice|document > *, office|document-content > * {\n  display: none;\n}\noffice|body, office|document {\n  display: inline-block;\n  position: relative;\n}\n\ntext|p, text|h {\n  display: block;\n  padding: 0;\n  margin: 0;\n  line-height: normal;\n  position: relative;\n  min-height: 1.3em; /* prevent empty paragraphs and headings from collapsing if they are empty */\n}\n*[runtimens|containsparagraphanchor] {\n  position: relative;\n}\ntext|s {\n    white-space: pre;\n}\ntext|tab {\n  display: inline;\n  white-space: pre;\n}\ntext|line-break {\n  content: \" \";\n  display: block;\n}\ntext|tracked-changes {\n  /*Consumers that do not support change tracking, should ignore changes.*/\n  display: none;\n}\noffice|binary-data {\n  display: none;\n}\noffice|text {\n  display: block;\n  text-align: left;\n  overflow: visible;\n  word-wrap: break-word;\n}\n\noffice|text::selection {\n    /** Let's not draw selection highlight that overflows into the office|text\n     * node when selecting content across several paragraphs\n     */\n    background: transparent;\n}\noffice|text * draw|text-box {\n    /** only for text documents */\n    display: block;\n    border: 1px solid #d3d3d3;\n}\noffice|spreadsheet {\n  display: block;\n  border-collapse: collapse;\n  empty-cells: show;\n  font-family: sans-serif;\n  font-size: 10pt;\n  text-align: left;\n  page-break-inside: avoid;\n  overflow: hidden;\n}\noffice|presentation {\n  display: inline-block;\n  text-align: left;\n}\n#shadowContent {\n  display: inline-block;\n  text-align: left;\n}\ndraw|page {\n  display: block;\n  position: relative;\n  overflow: hidden;\n}\npresentation|notes, presentation|footer-decl, presentation|date-time-decl {\n    display: none;\n}\n@media print {\n  draw|page {\n    border: 1pt solid black;\n    page-break-inside: avoid;\n  }\n  presentation|notes {\n    /*TODO*/\n  }\n}\noffice|spreadsheet text|p {\n  border: 0px;\n  padding: 1px;\n  margin: 0px;\n}\noffice|spreadsheet table|table {\n  margin: 3px;\n}\noffice|spreadsheet table|table:after {\n  /* show sheet name the end of the sheet */\n  /*content: attr(table|name);*/ /* gives parsing error in opera */\n}\noffice|spreadsheet table|table-row {\n  counter-increment: row;\n}\noffice|spreadsheet table|table-row:before {\n  width: 3em;\n  background: #cccccc;\n  border: 1px solid black;\n  text-align: center;\n  content: counter(row);\n  display: table-cell;\n}\noffice|spreadsheet table|table-cell {\n  border: 1px solid #cccccc;\n}\ntable|table {\n  display: table;\n}\ndraw|frame table|table {\n  width: 100%;\n  height: 100%;\n  background: white;\n}\ntable|table-header-rows {\n  display: table-header-group;\n}\ntable|table-row {\n  display: table-row;\n}\ntable|table-column {\n  display: table-column;\n}\ntable|table-cell {\n  width: 0.889in;\n  display: table-cell;\n  word-break: break-all; /* prevent long words from extending out the table cell */\n}\ndraw|frame {\n  display: block;\n}\ndraw|image {\n  display: block;\n  width: 100%;\n  height: 100%;\n  top: 0px;\n  left: 0px;\n  background-repeat: no-repeat;\n  background-size: 100% 100%;\n  -moz-background-size: 100% 100%;\n}\n/* only show the first image in frame */\ndraw|frame > draw|image:nth-of-type(n+2) {\n  display: none;\n}\ntext|list:before {\n    display: none;\n    content:\"\";\n}\ntext|list {\n    counter-reset: list;\n}\ntext|list-item {\n    display: block;\n}\ntext|number {\n    display:none;\n}\n\ntext|a {\n    color: blue;\n    text-decoration: underline;\n    cursor: pointer;\n}\ntext|note-citation {\n    vertical-align: super;\n    font-size: smaller;\n}\ntext|note-body {\n    display: none;\n}\ntext|note:hover text|note-citation {\n    background: #dddddd;\n}\ntext|note:hover text|note-body {\n    display: block;\n    left:1em;\n    max-width: 80%;\n    position: absolute;\n    background: #ffffaa;\n}\nsvg|title, svg|desc {\n    display: none;\n}\nvideo {\n    width: 100%;\n    height: 100%\n}\n\n/* below set up the cursor */\ncursor|cursor {\n    display: inline;\n    width: 0px;\n    height: 1em;\n    /* making the position relative enables the avatar to use\n       the cursor as reference for its absolute position */\n    position: relative;\n    z-index: 1;\n}\ncursor|cursor > span {\n    display: inline;\n    position: absolute;\n    top: 5%; /* push down the caret; 0px can do the job, 5% looks better, 10% is a bit over */\n    height: 1em;\n    border-left: 2px solid black;\n    outline: none;\n}\n\ncursor|cursor > div {\n    padding: 3px;\n    box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);\n    border: none !important;\n    border-radius: 5px;\n    opacity: 0.3;\n}\n\ncursor|cursor > div > img {\n    border-radius: 5px;\n}\n\ncursor|cursor > div.active {\n    opacity: 0.8;\n}\n\ncursor|cursor > div:after {\n    content: ' ';\n    position: absolute;\n    width: 0px;\n    height: 0px;\n    border-style: solid;\n    border-width: 8.7px 5px 0 5px;\n    border-color: black transparent transparent transparent;\n\n    top: 100%;\n    left: 43%;\n}\n\n\n.editInfoMarker {\n    position: absolute;\n    width: 10px;\n    height: 100%;\n    left: -20px;\n    opacity: 0.8;\n    top: 0;\n    border-radius: 5px;\n    background-color: transparent;\n    box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);\n}\n.editInfoMarker:hover {\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);\n}\n\n.editInfoHandle {\n    position: absolute;\n    background-color: black;\n    padding: 5px;\n    border-radius: 5px;\n    opacity: 0.8;\n    box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);\n    bottom: 100%;\n    margin-bottom: 10px;\n    z-index: 3;\n    left: -25px;\n}\n.editInfoHandle:after {\n    content: ' ';\n    position: absolute;\n    width: 0px;\n    height: 0px;\n    border-style: solid;\n    border-width: 8.7px 5px 0 5px;\n    border-color: black transparent transparent transparent;\n\n    top: 100%;\n    left: 5px;\n}\n.editInfo {\n    font-family: sans-serif;\n    font-weight: normal;\n    font-style: normal;\n    text-decoration: none;\n    color: white;\n    width: 100%;\n    height: 12pt;\n}\n.editInfoColor {\n    float: left;\n    width: 10pt;\n    height: 10pt;\n    border: 1px solid white;\n}\n.editInfoAuthor {\n    float: left;\n    margin-left: 5pt;\n    font-size: 10pt;\n    text-align: left;\n    height: 12pt;\n    line-height: 12pt;\n}\n.editInfoTime {\n    float: right;\n    margin-left: 30pt;\n    font-size: 8pt;\n    font-style: italic;\n    color: yellow;\n    height: 12pt;\n    line-height: 12pt;\n}\n\n.annotationWrapper {\n    display: inline;\n    position: relative;\n}\n\n.annotationRemoveButton:before {\n    content: '';\n    color: white;\n    padding: 5px;\n    line-height: 1em;\n}\n\n.annotationRemoveButton {\n    width: 20px;\n    height: 20px;\n    border-radius: 10px;\n    background-color: black;\n    box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);\n    position: absolute;\n    top: -10px;\n    left: -10px;\n    z-index: 3;\n    text-align: center;\n    font-family: sans-serif;\n    font-style: normal;\n    font-weight: normal;\n    text-decoration: none;\n    font-size: 15px;\n}\n.annotationRemoveButton:hover {\n    cursor: pointer;\n    box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);\n}\n\n.annotationNote {\n    width: 4cm;\n    position: absolute;\n    display: inline;\n    z-index: 10;\n}\n.annotationNote > office|annotation {\n    display: block;\n}\n\n.annotationConnector {\n    position: absolute;\n    display: inline;\n    z-index: 2;\n    border-top: 1px dashed brown;\n}\n.annotationConnector.angular {\n    -moz-transform-origin: left top;\n    -webkit-transform-origin: left top;\n    -ms-transform-origin: left top;\n    transform-origin: left top;\n}\n.annotationConnector.horizontal {\n    left: 0;\n}\n.annotationConnector.horizontal:before {\n    content: '';\n    display: inline;\n    position: absolute;\n    width: 0px;\n    height: 0px;\n    border-style: solid;\n    border-width: 8.7px 5px 0 5px;\n    border-color: brown transparent transparent transparent;\n    top: -1px;\n    left: -5px;\n}\n\noffice|annotation {\n    width: 100%;\n    height: 100%;\n    display: none;\n    background: rgb(198, 238, 184);\n    background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);\n    background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);\n    background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);\n    background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);\n    background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);\n    box-shadow: 0 3px 4px -3px #ccc;\n}\n\noffice|annotation > dc|creator {\n    display: block;\n    font-size: 10pt;\n    font-weight: normal;\n    font-style: normal;\n    font-family: sans-serif;\n    color: white;\n    background-color: brown;\n    padding: 4px;\n}\noffice|annotation > dc|date {\n    display: block;\n    font-size: 10pt;\n    font-weight: normal;\n    font-style: normal;\n    font-family: sans-serif;\n    border: 4px solid transparent;\n}\noffice|annotation > text|list {\n    display: block;\n    padding: 5px;\n}\n\n/* This is very temporary CSS. This must go once\n * we start bundling webodf-default ODF styles for annotations.\n */\noffice|annotation text|p {\n    font-size: 10pt;\n    color: black;\n    font-weight: normal;\n    font-style: normal;\n    text-decoration: none;\n    font-family: sans-serif;\n}\n\ndc|*::selection {\n    background: transparent;\n}\ndc|*::-moz-selection {\n    background: transparent;\n}\n\n#annotationsPane {\n    background-color: #EAEAEA;\n    width: 4cm;\n    height: 100%;\n    display: none;\n    position: absolute;\n    outline: 1px solid #ccc;\n}\n\n.annotationHighlight {\n    background-color: yellow;\n    position: relative;\n}\n";